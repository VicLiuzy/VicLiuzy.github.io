<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>What happened</title>
  
  <subtitle>hello world</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2021-08-28T02:29:56.399Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Vic Liu</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å†™åœ¨100å¤©ğŸ’Œ</title>
    <link href="http://yoursite.com/2021/08/28/%E5%86%99%E5%9C%A8100%E5%A4%A9/"/>
    <id>http://yoursite.com/2021/08/28/å†™åœ¨100å¤©/</id>
    <published>2021-08-28T15:03:00.000Z</published>
    <updated>2021-08-28T02:29:56.399Z</updated>
    
    <content type="html"><![CDATA[<p>äº²çˆ±çš„<strong>ç¯</strong> â¤ï¸ï¼Œ</p><p>æ—¶é—´è¿‡å¾—çœŸå¿«ï¼Œæ˜å¤©å°±æ˜¯æˆ‘ä»¬åœ¨ä¸€èµ·çš„ç¬¬100å¤©å•¦ï¼<br>æˆ‘ä»¬ä¹Ÿä»åˆå¤èµ°åˆ°åˆç§‹ï¼Œå…±åŒåº¦è¿‡äº†ä¸€ä¸ªç¾å¥½çš„å¤å¤©ã€‚<br>è¿™ä¸ªå¤å¤©çš„ç”œï¼Œå€¼å¾—æˆ‘ä»¬æ°¸è¿œè®°åœ¨å¿ƒé‡Œã€‚</p><p>ç¯ç¯ï¼Œæ”¶åˆ°ä½ çš„å›ä¿¡æˆ‘å¥½å¼€å¿ƒï¼Œæ²¡æƒ³åˆ°é€šä¿¡çš„æ„Ÿè§‰æ˜¯è¿™ä¹ˆå¥‡å¦™ã€‚<br>åœ¨å³æ—¶é€šè®¯å¦‚æ­¤å‘è¾¾çš„å¹´ä»£é‡Œï¼Œæˆ‘ä»¬èƒ½å¤Ÿæˆä¸ºâ€œç¬”å‹â€ï¼Œä¹Ÿæ˜¯ä¸€ç§ç‹¬ç‰¹çš„ä½“éªŒå‘¢ï¼<br>ä½ è¯´å¾ˆå–œæ¬¢å’Œæˆ‘ä¸€èµ·åŒ…é¥ºå­ï¼Œæˆ‘ä¹Ÿæ˜¯çš„ï¼<br>è€Œä¸”æ²¡æƒ³åˆ°æ—¶éš”ä¸€å‘¨ï¼Œæˆ‘ä»¬åˆæœ‰æœºä¼šåœ¨ä¸€èµ·åŒ…é¥ºå­ã€‚<br>è¿™ä¸¤æ¬¡æˆ‘éƒ½åƒçš„å¥½æ’‘ï¼Œå› ä¸ºå®åœ¨æ˜¯å¤ªå¥½åƒäº†ï¼Œæˆ‘è§‰å¾—åªè¦æ˜¯ç¯ç¯åšçš„éƒ½ä¼šå¾ˆå¥½åƒï¼Œå½“ç„¶é˜¿å§¨æ‹Œçš„é¦…å„¿ä¹ŸåŠŸä¸å¯æ²¡å“ˆå“ˆã€‚</p><p>è§ä¸åˆ°ä½ çš„æ—¥å­ï¼Œæ€»æ˜¯å¾ˆæƒ³ä½ ï¼Œ<br>â€œæƒ³å¿µä½ çš„ç¬‘,æƒ³å¿µä½ çš„å¤–å¥—,æƒ³å¿µä½ ç™½è‰²è¢œå­,å’Œä½ èº«ä¸Šçš„å‘³é“â€ã€‚<br>ä¸Šç­çš„æ—¶å€™ç”šè‡³ä¼šæƒ³ä½ æƒ³åˆ°å‚»ç¬‘ï¼Œä¸è¿‡æ”¾å¿ƒï¼Œä¸ä¼šå½±å“å·¥ä½œè¿›åº¦çš„ï¼Œå˜»å˜»&#x1F61C;ã€‚<br>å³å°†åˆ°æ¥çš„ä¹æœˆï¼Œä½ ä¹Ÿå³å°†å¼€å§‹æ˜å¹´ç¼–åˆ¶è€ƒè¯•çš„å¤‡è€ƒã€‚<br>è™½ç„¶è§é¢å¯èƒ½ä¼šå‡å°‘ï¼Œä½†æˆ‘çš„æ€å¿µå’Œçˆ±æ„å°†ä¼šæ›´æµ“ã€‚<br>ç¯ç¯ï¼Œæˆ‘å¯¹ä½ æœ‰ä¿¡å¿ƒï¼Œæˆ‘ç›¸ä¿¡è¿™åªæ˜¯å½©è™¹ä¹‹å‰çš„å°é£é›¨è€Œå·²ï¼Œä½ ä¸€å®šå¯ä»¥ä¸Šå²¸çš„ï¼Œä½ ä¹Ÿè¦ç›¸ä¿¡è‡ªå·±ï¼<br>ä½ è¦è®°å¾—æˆ‘æ˜¯ä½ çš„ä¾é ï¼Œæ˜¯ä½ åšå®çš„åç›¾ã€‚<br>å½“ä½ çš„è‚©è†€ç´¯äº†ï¼Œå°±æ¢æˆ‘æ¥æ‰›ä¸€ä¼šå„¿å§ï¼Œè¿™æ¡è·¯æ€»ä¼šèµ°åˆ°å¤´çš„ã€‚</p><p>è™½ç„¶ä¹‹å‰é‚£æ ·æ•´å¤©è…»åœ¨ä¸€èµ·çš„æœºä¼šå¯èƒ½å°‘äº†ï¼Œ<br>ä½†æ˜¯å½“ä½ å­¦ä¹ ç´¯äº†çš„æ—¶å€™ï¼Œæˆ‘å¯ä»¥é™ªä½ åƒé¡¿é¥­çŠ’åŠ³ä¸€ä¸‹è‡ªå·±ï¼›<br>å¯’å†·çš„å†¬å¤©ï¼Œæˆ‘å¯ä»¥æ™šä¸Šæ¥ä½ ä¸€èµ·æ”¾å­¦å›å®¶ï¼›<br>è¿˜å¯ä»¥äº’ç›¸ç›´æ’­ä¸€èµ·å­¦ä¹ ã€‚<br>è¿™ä½•å°ä¸ä¹Ÿæ˜¯ä¸€ç§æµªæ¼«ï¼<br>ç¯ç¯ï¼Œæˆ‘ä¹Ÿç»å†è¿‡è€ƒç ”ï¼Œè™½ç„¶æ²¡æœ‰è€ƒç¼–çš„ç«äº‰æ¿€çƒˆï¼Œä½†æ˜¯å¤‡è€ƒä¹Ÿæ˜¯ä¸€æ ·å……å®çš„ã€‚<br>æˆ‘è§‰å¾—å¤‡è€ƒçš„è¿‡ç¨‹ä¹Ÿæ˜¯ä¸€ç§ç§¯æçš„ä½“éªŒï¼Œé‚£ç§æ¯å¤©æ„Ÿè§‰åˆ°è‡ªå·±è¿›æ­¥ï¼Œæ—¶åˆ»æ„Ÿè§‰åˆ°çŸ¥è¯†åœ¨å‘èº«ä½“ä¸­çŒè¾“çš„çŠ¶æ€ï¼Œä¹Ÿæ˜¯ååˆ†éš¾å¿˜çš„ã€‚<br>æ‰€ä»¥ï¼Œå¿˜æ‰ç„¦è™‘å§ï¼ŒèƒŒæ°´ä¸€æˆ˜ï¼Œäº«å—è¿™ä¸ªè¿‡ç¨‹ï¼Œè®©åé¢çš„200å¤©ï¼Œä¹Ÿæˆä¸ºä½ å’Œæˆ‘çš„ç¾å¥½å›å¿†ã€‚</p><p>é¢åŒ…ä¼šæœ‰çš„,ç‰›å¥¶ä¼šæœ‰çš„,ä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥çš„ï¼Œç¯ç¯ï¼ŒæœŸå¾…æˆ‘ä»¬ä¸‹ä¸€ä¸ªï¼Œä¸‹ä¸‹ä¸€ä¸ªâ€¦ä»¥åŠæ›´å¤šçš„100å¤©ï¼&#x1F970;</p><p>æ°¸è¿œçˆ±ä½ çš„<br><strong>å®—</strong> â¤ï¸</p><p>2021.08.28</p><hr><blockquote><p>é™„ï¼š<a href="https://vicliuzy.github.io/Love/" target="_blank" rel="noopener">Our Love Story</a></p></blockquote><p><img src="/img/we.jpg" width="960" height="540"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;äº²çˆ±çš„&lt;strong&gt;ç¯&lt;/strong&gt; â¤ï¸ï¼Œ&lt;/p&gt;
&lt;p&gt;æ—¶é—´è¿‡å¾—çœŸå¿«ï¼Œæ˜å¤©å°±æ˜¯æˆ‘ä»¬åœ¨ä¸€èµ·çš„ç¬¬100å¤©å•¦ï¼&lt;br&gt;æˆ‘ä»¬ä¹Ÿä»åˆå¤èµ°åˆ°åˆç§‹ï¼Œå…±åŒåº¦è¿‡äº†ä¸€ä¸ªç¾å¥½çš„å¤å¤©ã€‚&lt;br&gt;è¿™ä¸ªå¤å¤©çš„ç”œï¼Œå€¼å¾—æˆ‘ä»¬æ°¸è¿œè®°åœ¨å¿ƒé‡Œã€‚&lt;/p&gt;
&lt;p&gt;ç¯ç¯ï¼Œæ”¶åˆ°ä½ çš„å›ä¿¡æˆ‘å¥½å¼€å¿ƒï¼Œæ²¡æƒ³åˆ°é€šä¿¡çš„æ„Ÿè§‰
      
    
    </summary>
    
      <category term="æƒ…ä¹¦" scheme="http://yoursite.com/categories/%E6%83%85%E4%B9%A6/"/>
    
    
      <category term="æƒ…ä¹¦" scheme="http://yoursite.com/tags/%E6%83%85%E4%B9%A6/"/>
    
  </entry>
  
  <entry>
    <title>å›é¡¾å•ä¾‹æ¨¡å¼</title>
    <link href="http://yoursite.com/2020/09/12/%E5%9B%9E%E9%A1%BE%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
    <id>http://yoursite.com/2020/09/12/å›é¡¾å•ä¾‹æ¨¡å¼/</id>
    <published>2020-09-12T10:30:00.000Z</published>
    <updated>2020-09-12T05:57:02.036Z</updated>
    
    <content type="html"><![CDATA[<p>C++å²—ä½é¢è¯•ä¸­ï¼Œé¢è¯•å®˜å¸¸å¸¸ä¼šé—®é“ï¼Œä½ å¸¸ç”¨å“ªäº›è®¾è®¡æ¨¡å¼ã€‚æˆ‘é€šå¸¸ä¼šå›ç­”ï¼šå•ä¾‹æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ã€å·¥å‚æ¨¡å¼ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼ç­‰ã€‚<br>å…¶ä¸­å•ä¾‹æ¨¡å¼å®ç°æ–¹æ³•æ¯”è¾ƒå›ºå®šï¼Œé¢è¯•å®˜æœ‰æ—¶ä¼šè®©æˆ‘æ‰‹å†™å•ä¾‹æ¨¡å¼ã€‚ä¸ºäº†åœ¨é¢è¯•ä¸­èƒ½å¤Ÿå‡†ç¡®æ— è¯¯çš„å†™å‡ºå•ä¾‹æ¨¡å¼ï¼Œæœ¬æ–‡å¯¹å•ä¾‹æ¨¡å¼çš„C++å®ç°è¿›è¡Œå›é¡¾ä¸æ€»ç»“ã€‚  </p><h2 id="å•ä¾‹æ¨¡å¼çš„å®šä¹‰"><a href="#å•ä¾‹æ¨¡å¼çš„å®šä¹‰" class="headerlink" title="å•ä¾‹æ¨¡å¼çš„å®šä¹‰"></a>å•ä¾‹æ¨¡å¼çš„å®šä¹‰</h2><p>è®©ç±»è´Ÿè´£ä¿å­˜å…¶è‡ªå·±çš„å®ä¾‹ï¼Œæä¾›ä¸€ä¸ªæ–¹æ³•ï¼ˆå…¨å±€è®¿é—®ç‚¹ï¼‰è·å–è¯¥å®ä¾‹ï¼Œå¹¶ä¸”ä¸èƒ½ä»å¤–éƒ¨åˆ›å»ºè¯¥ç±»çš„å…¶ä»–å®ä¾‹ï¼Œç¡®ä¿è¯¥ç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚</p><ul><li>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œä½¿ç”¨å…¨å±€é™æ€å˜é‡ä¸å¯ä»¥å—ï¼Ÿ<br>å…¨å±€å˜é‡æ— æ³•ä¿è¯åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå› æ­¤å•ä¾‹æ¨¡å¼æœ‰å…¶å­˜åœ¨çš„å¿…è¦ã€‚</li></ul><h2 id="å•ä¾‹æ¨¡å¼çš„å®ç°æ–¹å¼"><a href="#å•ä¾‹æ¨¡å¼çš„å®ç°æ–¹å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼çš„å®ç°æ–¹å¼"></a>å•ä¾‹æ¨¡å¼çš„å®ç°æ–¹å¼</h2><p>å•ä¾‹æ¨¡å¼é€šå¸¸æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼Œåˆ†ä¸º<code>â€œæ‡’æ±‰å¼å®ç°â€</code>ä¸<code>â€œé¥¿æ±‰å¼å®ç°â€</code>ã€‚å®ƒä»¬çš„åŒºåˆ«åœ¨äºåˆ›å»ºå®ä¾‹çš„æ—¶æœºã€‚  </p><ul><li>æ‡’æ±‰å¼å®ç°ï¼šåªæœ‰éœ€è¦è·å–å®ä¾‹æ—¶æ‰åˆ›å»ºå®ä¾‹ã€‚é€‚ç”¨äºä¸ç¡®å®šæ˜¯å¦éœ€è¦è®¿é—®å®ä¾‹çš„æƒ…å½¢ï¼Œä¸”å®ä¾‹è®¿é—®éå¸¸å°‘ã€‚</li><li>é¥¿æ±‰å¼å®ç°ï¼šç¨‹åºè¿è¡Œåç«‹å³åˆ›å»ºå®ä¾‹ã€‚é€‚ç”¨äºéœ€è¦é¢‘ç¹è®¿é—®<code>getInst</code>çš„æƒ…å½¢ã€‚ç›¸å½“äºç”¨ç©ºé—´æ¢æ—¶é—´ã€‚</li></ul><h2 id="é¥¿æ±‰æ¨¡å¼çš„å•ä¾‹æ¨¡å¼"><a href="#é¥¿æ±‰æ¨¡å¼çš„å•ä¾‹æ¨¡å¼" class="headerlink" title="é¥¿æ±‰æ¨¡å¼çš„å•ä¾‹æ¨¡å¼"></a>é¥¿æ±‰æ¨¡å¼çš„å•ä¾‹æ¨¡å¼</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> Singleton* <span class="title">getInst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> &amp;m_inst;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Singleton();</span><br><span class="line">    Singleton(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">static</span> Singleton m_inst;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Singleton Singleton::m_inst;</span><br></pre></td></tr></table></figure><h2 id="æ‡’æ±‰æ¨¡å¼çš„å•ä¾‹æ¨¡å¼"><a href="#æ‡’æ±‰æ¨¡å¼çš„å•ä¾‹æ¨¡å¼" class="headerlink" title="æ‡’æ±‰æ¨¡å¼çš„å•ä¾‹æ¨¡å¼"></a>æ‡’æ±‰æ¨¡å¼çš„å•ä¾‹æ¨¡å¼</h2><h3 id="éçº¿ç¨‹å®‰å…¨å®ç°"><a href="#éçº¿ç¨‹å®‰å…¨å®ç°" class="headerlink" title="éçº¿ç¨‹å®‰å…¨å®ç°"></a>éçº¿ç¨‹å®‰å…¨å®ç°</h3><p>è¿™æ˜¯ã€Šè®¾è®¡æ¨¡å¼ã€‹ä¸€ä¹¦ä¸­çš„å®ç°æ–¹å¼ï¼Œæ˜¯ä¸€ç§çº¿ç¨‹ä¸å®‰å…¨çš„å®ç°æ–¹å¼ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> Singleton* <span class="title">getInst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!m_inst) &#123;</span><br><span class="line">            m_inst = <span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> m_inst;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Singleton();</span><br><span class="line">    Singleton(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸€ä¸ªç”¨äºé‡Šæ”¾å®ä¾‹çš„å†…éƒ¨ç±»</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Garbo</span> &#123;</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        Garbo() &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        ~Garbo() &#123;</span><br><span class="line">            <span class="keyword">if</span> (m_inst) &#123;</span><br><span class="line">                <span class="keyword">delete</span> m_inst;</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">static</span> Singleton *m_inst;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> Singleton *Singleton::m_inst = <span class="literal">nullptr</span>;</span><br><span class="line"><span class="keyword">static</span> Singleton::Garbo Singleton::m_grabo;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç çš„Garboç±»ä½¿ä»£ç ååˆ†è‡ƒè‚¿ï¼Œè€ƒè™‘ç”¨æ™ºèƒ½æŒ‡é’ˆæ›¿ä»£ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> Singleton* <span class="title">getInst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!m_inst) &#123;</span><br><span class="line">            m_inst = make_shared&lt;Singleton&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> m_inst.get();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Singleton();</span><br><span class="line">    Singleton(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">shared_ptr</span>&lt;Singleton&gt; m_inst;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">shared_ptr</span>&lt;Singleton&gt; Singleton::m_inst;</span><br></pre></td></tr></table></figure><h3 id="åŒé‡æ£€æŸ¥å®ç°"><a href="#åŒé‡æ£€æŸ¥å®ç°" class="headerlink" title="åŒé‡æ£€æŸ¥å®ç°"></a>åŒé‡æ£€æŸ¥å®ç°</h3><p>ä¸Šè¿°å®ç°ä¸­ï¼Œæ²¡æœ‰è€ƒè™‘å¤šçº¿ç¨‹è®¿é—®çš„æƒ…å½¢ã€‚<br>ä¸‹é¢å…ˆå®ç°ä¸€ä¸ªè™½ç„¶åŠ é”ä¿æŠ¤ï¼Œä½†æ˜¯æ•ˆç‡æä½çš„ç‰ˆæœ¬ã€‚<br>è¯¥ç‰ˆæœ¬ä¸­æ¯æ¬¡è°ƒç”¨<code>getInst</code>éƒ½è¦è®¿é—®äº’æ–¥é”ã€‚  </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> Singleton* <span class="title">getInst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        lock_guard(m_mutexInst);</span><br><span class="line">        <span class="keyword">if</span> (!m_inst) &#123;</span><br><span class="line">            m_inst = make_shared&lt;Singleton&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> m_inst.get();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Singleton();</span><br><span class="line">    Singleton(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">shared_ptr</span>&lt;Singleton&gt; m_inst;</span><br><span class="line">    <span class="keyword">static</span> mutex m_mutexInst;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">shared_ptr</span>&lt;Singleton&gt; Singleton::m_inst;</span><br><span class="line"><span class="keyword">static</span> mutex Singleton::m_mutexInst;</span><br></pre></td></tr></table></figure><p>å¦‚æœå…ˆè¿›è¡Œå®ä¾‹åˆ¤æ–­ï¼Œå†è¿›å…¥äº’æ–¥é”ï¼Œæ˜¯å¦å¯è¡Œå‘¢ï¼Ÿ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> Singleton* <span class="title">getInst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!m_inst) &#123;</span><br><span class="line">            lock_guard(m_mutexInst);</span><br><span class="line">            m_inst = make_shared&lt;Singleton&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> m_inst.get();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Singleton();</span><br><span class="line">    Singleton(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">shared_ptr</span>&lt;Singleton&gt; m_inst;</span><br><span class="line">    <span class="keyword">static</span> mutex m_mutexInst;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">shared_ptr</span>&lt;Singleton&gt; Singleton::m_inst;</span><br><span class="line"><span class="keyword">static</span> mutex Singleton::m_mutexInst;</span><br></pre></td></tr></table></figure><p>æ€è€ƒä¸€ä¸‹ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥<code>if</code>è¯­å¥çš„æƒ…å†µï¼Œä¼šå‘ç°å®ä¾‹è¢«åˆ›å»ºäº†ä¸¤æ¬¡ï¼Œæ­¤æ—¶å¼•èµ·äº†å†…å­˜æ³„æ¼ï¼Œå› æ­¤è¯¥å®ç°æ˜¯é”™è¯¯çš„ã€‚</p><p>ä¸‹é¢æ˜¯åŒé‡æ£€æŸ¥çš„å®ç°ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> Singleton* <span class="title">getInst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!m_inst) &#123;</span><br><span class="line">            lock_guard(m_mutexInst);</span><br><span class="line">            <span class="keyword">if</span> (!m_inst) &#123;</span><br><span class="line">                m_inst = make_shared&lt;Singleton&gt;();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> m_inst.get();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Singleton();</span><br><span class="line">    Singleton(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">shared_ptr</span>&lt;Singleton&gt; m_inst;</span><br><span class="line">    <span class="keyword">static</span> mutex m_mutexInst;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">shared_ptr</span>&lt;Singleton&gt; Singleton::m_inst;</span><br><span class="line"><span class="keyword">static</span> mutex Singleton::m_mutexInst;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºè¿™ä¸ªå®ç°éå¸¸è‡ƒè‚¿ï¼Œè€Œä¸”å®ƒä¹Ÿå¹¶éå®Œç¾ã€‚<br>æ ¹æ®ã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»â€“é“¾æ¥ã€è£…è½½ä¸åº“ã€‹ä¸€ä¹¦ï¼Œp29ä¸Šçš„æè¿°ï¼ŒCPUçš„ä¹±åºæ‰§è¡Œä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ã€‚<br>ä¸»è¦æ˜¯ç”±äºnewçš„ä¸‰ä¸ªé˜¶æ®µä¹Ÿå¹¶éæ˜¯åŸå­çš„ï¼š  </p><ol><li>ç”³è¯·å†…å­˜  </li><li>åœ¨è¯¥å†…å­˜ä¸Šè°ƒç”¨æ„é€ å‡½æ•°</li><li>å°†å†…å­˜åœ°å€åå›</li></ol><p>é—®é¢˜åœ¨äºäºŒä¸‰æ­¥æ˜¯å¯ä»¥é¢ å€’çš„ã€‚ä¼šå‡ºç°ä»¥ä¸‹æƒ…å†µï¼š<br>çº¿ç¨‹Aä¸­çš„<code>m_inst = new Singleton()</code>å·²æ‰§è¡Œç¬¬ä¸‰æ­¥ï¼Œå´æœªæ‰§è¡Œç¬¬äºŒæ­¥ï¼Œæ­¤æ—¶è°ƒåº¦åˆ°çº¿ç¨‹Bï¼Œåˆ¤æ–­<code>m_inst</code>ä¸ºéç©ºï¼Œå¹¶è¿”å›è¯¥æŒ‡é’ˆï¼Œæ­¤æ—¶<code>m_inst</code>ä¸Šçš„æ“ä½œå¯èƒ½å¼•èµ·å´©æºƒé—®é¢˜ã€‚</p><h3 id="å±€éƒ¨é™æ€å¯¹è±¡å®ç°"><a href="#å±€éƒ¨é™æ€å¯¹è±¡å®ç°" class="headerlink" title="å±€éƒ¨é™æ€å¯¹è±¡å®ç°"></a>å±€éƒ¨é™æ€å¯¹è±¡å®ç°</h3><p>ä¸‹é¢æ˜¯è¢«ç§°ä¸º<code>Meyers&#39; Singleton</code>çš„å•ä¾‹å®ç°ï¼Œä½¿ç”¨ä¸€ä¸ªå±€éƒ¨çš„staticå˜é‡ä¿å­˜å•ä¾‹å®ä¾‹ã€‚  </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">Singleton&amp; <span class="title">getInst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> Singleton inst;</span><br><span class="line">        <span class="keyword">return</span> inst;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Singleton();</span><br><span class="line">    Singleton(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¯¥å®ç°æ˜¯ç”±è‘—åçš„å†™å‡ºã€ŠEffective C++ã€‹ç³»åˆ—ä¹¦ç±çš„ä½œè€…Meyersæå‡ºçš„ã€‚æ‰€ç”¨åˆ°çš„ç‰¹æ€§æ˜¯åœ¨<code>C++11</code>æ ‡å‡†ä¸­çš„<code>Magic Static</code>ç‰¹æ€§ï¼š</p><blockquote><p>If control enters the declaration concurrently while the variable is being initialized, the concurrent execution shall wait for completion of the initialization.<br>å¦‚æœå½“å˜é‡åœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå¹¶å‘åŒæ—¶è¿›å…¥å£°æ˜è¯­å¥ï¼Œå¹¶å‘çº¿ç¨‹å°†ä¼šé˜»å¡ç­‰å¾…åˆå§‹åŒ–ç»“æŸã€‚  </p></blockquote><p>è¿™æ ·ä¿è¯äº†å¹¶å‘çº¿ç¨‹åœ¨è·å–é™æ€å±€éƒ¨å˜é‡çš„æ—¶å€™ä¸€å®šæ˜¯åˆå§‹åŒ–è¿‡çš„ï¼Œæ‰€ä»¥å…·æœ‰çº¿ç¨‹å®‰å…¨æ€§ã€‚  </p><p>C++é™æ€å˜é‡çš„ç”Ÿå­˜æœŸ æ˜¯ä»å£°æ˜åˆ°ç¨‹åºç»“æŸï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§æ‡’æ±‰å¼ã€‚  </p><p>è¿™æ˜¯æœ€æ¨èçš„ä¸€ç§å•ä¾‹å®ç°æ–¹å¼ï¼š</p><ol><li>é€šè¿‡å±€éƒ¨é™æ€å˜é‡çš„ç‰¹æ€§ä¿è¯äº†çº¿ç¨‹å®‰å…¨ (C++11, GCC &gt; 4.3, VS2015æ”¯æŒè¯¥ç‰¹æ€§);</li><li>ä¸éœ€è¦ä½¿ç”¨å…±äº«æŒ‡é’ˆï¼Œä»£ç ç®€æ´ï¼›</li><li>æ³¨æ„åœ¨ä½¿ç”¨çš„æ—¶å€™éœ€è¦å£°æ˜å•ä¾‹çš„å¼•ç”¨ Single&amp; æ‰èƒ½è·å–å¯¹è±¡ã€‚</li></ol><p>å¦‚æœæƒ³åœ¨<code>C++11</code>æ ‡å‡†ä¹‹å‰ä½¿ç”¨å±€éƒ¨é™æ€å˜é‡æ–¹å¼çš„å•ä¾‹æ¨¡å¼ï¼Œå¯ä»¥æ€ä¹ˆåšå‘¢ï¼Ÿææ€•å¿…é¡»è¦åŠ é”ä¿æŠ¤é™æ€å˜é‡çš„åˆå§‹åŒ–äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">Singleton&amp; <span class="title">getInst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mutex.lock()</span><br><span class="line">        <span class="keyword">static</span> Singleton inst;</span><br><span class="line">        mutex.unlock();</span><br><span class="line">        <span class="keyword">return</span> inst;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Singleton();</span><br><span class="line">    Singleton(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// ä¸è¦åœ¨æ„è¿™äº›ç»†èŠ‚</span></span><br><span class="line">    <span class="keyword">static</span> mutex m_mutexInst;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> mutex Singleton::m_mutexInst;</span><br></pre></td></tr></table></figure><p>å‚è€ƒæ–‡çŒ®ï¼š</p><p><a href="https://www.cnblogs.com/sunchaothu/p/10389842.html" target="_blank" rel="noopener">C++ å•ä¾‹æ¨¡å¼æ€»ç»“ä¸å‰–æ</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;C++å²—ä½é¢è¯•ä¸­ï¼Œé¢è¯•å®˜å¸¸å¸¸ä¼šé—®é“ï¼Œä½ å¸¸ç”¨å“ªäº›è®¾è®¡æ¨¡å¼ã€‚æˆ‘é€šå¸¸ä¼šå›ç­”ï¼šå•ä¾‹æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ã€å·¥å‚æ¨¡å¼ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼ç­‰ã€‚&lt;br&gt;å…¶ä¸­å•ä¾‹æ¨¡å¼å®ç°æ–¹æ³•æ¯”è¾ƒå›ºå®šï¼Œé¢è¯•å®˜æœ‰æ—¶ä¼šè®©æˆ‘æ‰‹å†™å•ä¾‹æ¨¡å¼ã€‚ä¸ºäº†åœ¨é¢è¯•ä¸­èƒ½å¤Ÿå‡†ç¡®æ— è¯¯çš„å†™å‡ºå•ä¾‹æ¨¡å¼ï¼Œæœ¬æ–‡å¯¹å•ä¾‹æ¨¡å¼çš„C++å®ç°è¿›è¡Œå›é¡¾ä¸æ€»ç»“ã€‚  &lt;/
      
    
    </summary>
    
      <category term="çŸ¥è¯†" scheme="http://yoursite.com/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="é¢è¯•" scheme="http://yoursite.com/tags/%E9%9D%A2%E8%AF%95/"/>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://yoursite.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>éé€’å½’æ–¹å¼éå†äºŒå‰æ ‘</title>
    <link href="http://yoursite.com/2020/09/05/%E9%9D%9E%E9%80%92%E5%BD%92%E6%96%B9%E5%BC%8F%E9%81%8D%E5%8E%86%E4%BA%8C%E5%8F%89%E6%A0%91/"/>
    <id>http://yoursite.com/2020/09/05/éé€’å½’æ–¹å¼éå†äºŒå‰æ ‘/</id>
    <published>2020-09-05T10:14:00.000Z</published>
    <updated>2020-09-05T04:15:35.669Z</updated>
    
    <content type="html"><![CDATA[<p>éé€’å½’éå†äºŒå‰æ ‘ï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯å€ŸåŠ©æ ˆå®ç°äºŒå‰æ ‘çš„éå†ã€‚æœ¬æ–‡å›é¡¾leetcodeä¸Šç»™å‡ºçš„å·§å¦™çš„ä¸€ç§ç›¸åŒç®—æ³•è§£å†³å…ˆåºã€ä¸­åºã€ååºçš„è§£æ³•ã€‚</p><h2 id="åŸºç¡€å…ˆåºéå†"><a href="#åŸºç¡€å…ˆåºéå†" class="headerlink" title="åŸºç¡€å…ˆåºéå†"></a>åŸºç¡€å…ˆåºéå†</h2><p>å…ˆåºéå†äºŒå‰æ ‘çš„é¡ºåºä¸ºâ€œçˆ¶èŠ‚ç‚¹-å·¦å­©å­-å³å­©å­â€ï¼Œå…ˆç»™å‡ºäºŒå‰æ ‘çš„æ•°æ®ç»“æ„å£°æ˜ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Definition for a binary tree node.</span></span><br><span class="line"> <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> &#123;</span></span><br><span class="line">     <span class="keyword">int</span> val;</span><br><span class="line">     TreeNode *left;</span><br><span class="line">     TreeNode *right;</span><br><span class="line">     TreeNode(<span class="keyword">int</span> x) : val(x), left(<span class="literal">NULL</span>), right(<span class="literal">NULL</span>) &#123;&#125;</span><br><span class="line"> &#125;;</span><br></pre></td></tr></table></figure><p>é€’å½’æ–¹å¼å…ˆåºéå†äºŒå‰æ ‘ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; preorderTraversal(TreeNode* root) &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; rlt;</span><br><span class="line">        </span><br><span class="line">        recursion(root, rlt);</span><br><span class="line">        <span class="keyword">return</span> rlt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">recursion</span><span class="params">(TreeNode* root, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; rlt)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rlt.push_back(root-&gt;val);</span><br><span class="line">        recursion(root-&gt;left, rlt);</span><br><span class="line">        recursion(root-&gt;right, rlt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ ˆæ¥è¿­ä»£éå†äºŒå‰æ ‘ï¼Œå…¶åŸºæœ¬æ€æƒ³ä¸ºï¼Œæ¯æ¬¡è¿­ä»£ï¼Œæ ˆé¡¶å…ƒç´ å‡ºæ ˆï¼Œå¹¶è¿›è¡Œéå†ï¼Œç„¶åä¾æ¬¡å°†å…¶å³å­©å­ã€å·¦å­©å­å…¥æ ˆã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; preorderTraversal(TreeNode* root) &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; rlt;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">            <span class="keyword">return</span> rlt;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">stack</span>&lt;TreeNode*&gt; assist;</span><br><span class="line">        assist.push(root);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!assist.empty()) &#123;</span><br><span class="line">            TreeNode* curNode = assist.top();</span><br><span class="line">            assist.pop();</span><br><span class="line">            rlt.push_back(curNode-&gt;val);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (curNode-&gt;right) &#123;</span><br><span class="line">                assist.push(curNode-&gt;right);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (curNode-&gt;left) &#123;</span><br><span class="line">                assist.push(curNode-&gt;left);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> rlt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="åˆ†æå¦‚ä½•å®ç°ç»Ÿä¸€çš„å…ˆä¸­åéå†ç®—æ³•"><a href="#åˆ†æå¦‚ä½•å®ç°ç»Ÿä¸€çš„å…ˆä¸­åéå†ç®—æ³•" class="headerlink" title="åˆ†æå¦‚ä½•å®ç°ç»Ÿä¸€çš„å…ˆä¸­åéå†ç®—æ³•"></a>åˆ†æå¦‚ä½•å®ç°ç»Ÿä¸€çš„å…ˆä¸­åéå†ç®—æ³•</h2><p>ä»”ç»†è€ƒè™‘å…ˆåºã€ä¸­åºã€åç»­éå†çš„åŒºåˆ«ï¼Œå®ƒä»¬çš„åŒºåˆ«ä»…ä»…åœ¨äºä½•æ—¶è·å–å…ƒç´ ã€‚<br>æˆ‘ä»¬ç”¨è¿­ä»£å»æ¨¡æ‹Ÿé€’å½’ï¼Œæ¥å®ç°äºŒå‰æ ‘çš„éå†ã€‚<br>ç”¨æ ˆéå†äºŒå‰æ ‘çš„æ•´ä½“é¡ºåºæ˜¯ç¡®å®šçš„ï¼Œæˆ‘ä»¬å…ˆè®¿é—®å·¦å­æ ‘ï¼Œåè®¿é—®å³å­æ ‘ï¼Œå› æ­¤å³å­æ ‘å…ˆå…¥æ ˆï¼Œå·¦å­æ ‘åå…¥æ ˆï¼Œå¦‚æœä¸è®¿é—®èŠ‚ç‚¹çš„è¯ï¼Œæœ€ç®€çš„éå†æ–¹å¼åº”è¯¥æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Traversal</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">stack</span>&lt;TreeNode*&gt; assist;</span><br><span class="line">        assist.push(root);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!assist.empty()) &#123;</span><br><span class="line">            TreeNode* curNode = assist.top();</span><br><span class="line">            assist.pop();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (curNode-&gt;right) &#123;</span><br><span class="line">                assist.push(curNode-&gt;right);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (curNode-&gt;left) &#123;</span><br><span class="line">                assist.push(curNode-&gt;left);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç›¸å½“äºå¦‚ä¸‹é€’å½’ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Traversal</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Traversal(root-&gt;left);</span><br><span class="line">        Traversal(root-&gt;right);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹åˆ°è¯¥ç®—æ³•ä¸­ï¼Œåªè¦ç¡®å®šä½•æ—¶è·å–å…ƒç´ ï¼Œå°±å¯ä»¥æ”¹é€ ä¸ºå…ˆåºã€ä¸­åºã€ååºéå†ã€‚</p><ul><li>å¯¹äºå…ˆåºéå†è€Œè¨€ï¼Œå…ˆå¤„ç†çˆ¶èŠ‚ç‚¹ï¼Œå†å¤„ç†å·¦å­æ ‘å’Œå³å­æ ‘ï¼Œå…¶é¡ºåºä¸º<code>çˆ¶èŠ‚ç‚¹-å·¦å­æ ‘-å³å­æ ‘</code>ã€‚</li><li>å¯¹äºä¸­åºéå†è€Œè¨€ï¼Œå¤„ç†çˆ¶èŠ‚ç‚¹æ—¶ï¼Œæ„å‘³ç€å·¦å­æ ‘å·²å…¨éƒ¨å¤„ç†å®Œæ¯•ï¼Œä½†å³å­æ ‘å°šæœªå¤„ç†ï¼Œå…¶é¡ºåºä¸º<code>å·¦å­æ ‘-çˆ¶èŠ‚ç‚¹-å³å­æ ‘</code>ã€‚</li><li>å¯¹äºååºéå†è€Œè¨€ï¼Œå¤„ç†çˆ¶èŠ‚ç‚¹æ—¶ï¼Œæ„å‘³ç€å·¦å³å­æ ‘éƒ½å·²å…¨éƒ¨å¤„ç†å®Œæ¯•ï¼Œå…¶é¡ºåºä¸º<code>å·¦å­æ ‘-å³å­æ ‘-çˆ¶èŠ‚ç‚¹</code>ã€‚</li></ul><p>ç”¨æ ˆæ¥å¤„ç†éå†äºŒå‰æ ‘é—®é¢˜æ—¶ï¼Œæ ˆé¡¶å…ƒç´ å…ˆå¤„ç†ï¼Œæ ˆåº•å…ƒç´ åå¤„ç†ï¼Œå› æ­¤ä¸‰ç§éå†æ–¹å¼å¿…é¡»ä¿è¯æ ˆå†…å…ƒç´ æœ‰å¦‚ä¸‹é¡ºåºï¼š</p><ul><li>å…ˆåºï¼Œçˆ¶èŠ‚ç‚¹åœ¨æ ˆé¡¶ï¼Œç„¶åæ˜¯å·¦å­©å­ã€å³å­©å­ã€‚</li><li>ä¸­åºï¼Œå·¦å­©å­åœ¨æ ˆé¡¶ï¼Œç„¶åæ˜¯çˆ¶èŠ‚ç‚¹ã€å³å­©å­ã€‚</li><li>ååºï¼Œå·¦å­©å­åœ¨æ ˆé¡¶ï¼Œç„¶åæ˜¯å³å­©å­ã€çˆ¶èŠ‚ç‚¹ã€‚</li></ul><p>åŸºäºä»¥ä¸Šæ€è·¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç©ºèŠ‚ç‚¹ä½œä¸ºçˆ¶èŠ‚ç‚¹çš„æ ‡è®°ï¼Œå®ç°äº†ä¸‰ç§éå†ç®—æ³•ã€‚<br>æ¯éå†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè°ƒæ•´æ ˆé¡¶å…ƒç´ çš„ä½ç½®ï¼Œä½¿å…¶å§‹ç»ˆä¿æŒä¸Šè¿°é¡ºåºï¼Œå¹¶åœ¨çˆ¶èŠ‚ç‚¹ä¸Šä¸€å±‚æ·»åŠ ç©ºèŠ‚ç‚¹è¿›è¡Œæ ‡è®°ã€‚<br>å½“æ ˆé¡¶å…ƒç´ ä¸ºç©ºèŠ‚ç‚¹æ—¶ï¼Œæ„å‘³ç€æ¬¡æ ˆé¡¶å…ƒç´ ä¸ºéœ€è¦è®¿é—®çš„èŠ‚ç‚¹ã€‚</p><h2 id="æ”¹è¿›åçš„å…ˆåºéå†"><a href="#æ”¹è¿›åçš„å…ˆåºéå†" class="headerlink" title="æ”¹è¿›åçš„å…ˆåºéå†"></a>æ”¹è¿›åçš„å…ˆåºéå†</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; preorderTraversal(TreeNode* root) &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; rlt;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">            <span class="keyword">return</span> rlt;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">stack</span>&lt;TreeNode*&gt; assist;</span><br><span class="line">        assist.push(root);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!assist.empty()) &#123;</span><br><span class="line">            TreeNode* curNode = assist.top();</span><br><span class="line">            assist.pop();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (curNode) &#123;</span><br><span class="line">                <span class="comment">// ä¿è¯çˆ¶èŠ‚ç‚¹åœ¨æ ˆé¡¶ï¼Œç„¶åæ˜¯å·¦å­©å­ã€å³å­©å­</span></span><br><span class="line">                <span class="keyword">if</span> (curNode-&gt;right) &#123;</span><br><span class="line">                    assist.push(curNode-&gt;right);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (curNode-&gt;left) &#123;</span><br><span class="line">                    assist.push(curNode-&gt;left);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                assist.push(curNode);</span><br><span class="line">                assist.push(<span class="literal">nullptr</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                rlt.push_back(assist.top()-&gt;val);</span><br><span class="line">                assist.pop();</span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rlt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="æ”¹è¿›åçš„ä¸­åºéå†"><a href="#æ”¹è¿›åçš„ä¸­åºéå†" class="headerlink" title="æ”¹è¿›åçš„ä¸­åºéå†"></a>æ”¹è¿›åçš„ä¸­åºéå†</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; inorderTraversal(TreeNode* root) &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; rlt;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">            <span class="keyword">return</span> rlt;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">stack</span>&lt;TreeNode*&gt; assist;</span><br><span class="line">        assist.push(root);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!assist.empty()) &#123;</span><br><span class="line">            TreeNode* curNode = assist.top();</span><br><span class="line">            assist.pop();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (curNode) &#123;</span><br><span class="line">                <span class="comment">// ä¿è¯å·¦å­©å­åœ¨æ ˆé¡¶ï¼Œç„¶åæ˜¯çˆ¶èŠ‚ç‚¹ã€å³å­©å­</span></span><br><span class="line">                <span class="keyword">if</span> (curNode-&gt;right) &#123;</span><br><span class="line">                    assist.push(curNode-&gt;right);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                assist.push(curNode);</span><br><span class="line">                assist.push(<span class="literal">nullptr</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (curNode-&gt;left) &#123;</span><br><span class="line">                    assist.push(curNode-&gt;left);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                rlt.push_back(assist.top()-&gt;val);</span><br><span class="line">                assist.pop();</span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rlt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="æ”¹è¿›åçš„ååºéå†"><a href="#æ”¹è¿›åçš„ååºéå†" class="headerlink" title="æ”¹è¿›åçš„ååºéå†"></a>æ”¹è¿›åçš„ååºéå†</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; postorderTraversal(TreeNode* root) &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; rlt;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">            <span class="keyword">return</span> rlt;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">stack</span>&lt;TreeNode*&gt; assist;</span><br><span class="line">        assist.push(root);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!assist.empty()) &#123;</span><br><span class="line">            TreeNode* curNode = assist.top();</span><br><span class="line">            assist.pop();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (curNode) &#123;</span><br><span class="line">                <span class="comment">// ä¿è¯å·¦å­©å­åœ¨æ ˆé¡¶ï¼Œç„¶åæ˜¯å³å­©å­ã€çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">                assist.push(curNode);</span><br><span class="line">                assist.push(<span class="literal">nullptr</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (curNode-&gt;right) &#123;</span><br><span class="line">                    assist.push(curNode-&gt;right);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (curNode-&gt;left) &#123;</span><br><span class="line">                    assist.push(curNode-&gt;left);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                rlt.push_back(assist.top()-&gt;val);</span><br><span class="line">                assist.pop();</span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rlt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;éé€’å½’éå†äºŒå‰æ ‘ï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯å€ŸåŠ©æ ˆå®ç°äºŒå‰æ ‘çš„éå†ã€‚æœ¬æ–‡å›é¡¾leetcodeä¸Šç»™å‡ºçš„å·§å¦™çš„ä¸€ç§ç›¸åŒç®—æ³•è§£å†³å…ˆåºã€ä¸­åºã€ååºçš„è§£æ³•ã€‚&lt;/p&gt;
&lt;h2 id=&quot;åŸºç¡€å…ˆåºéå†&quot;&gt;&lt;a href=&quot;#åŸºç¡€å…ˆåºéå†&quot; class=&quot;headerlink&quot; title=&quot;åŸºç¡€å…ˆåºéå†
      
    
    </summary>
    
      <category term="çŸ¥è¯†" scheme="http://yoursite.com/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="ç®—æ³•ä¸æ•°æ®ç»“æ„" scheme="http://yoursite.com/tags/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="é¢è¯•" scheme="http://yoursite.com/tags/%E9%9D%A2%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>å¼€å¯Hikey 970å¼€å‘æ¿USB AUDIOåŠŸèƒ½</title>
    <link href="http://yoursite.com/2020/05/10/%E8%AE%B0Android%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD%E4%B8%8E%E7%BC%96%E8%AF%91/"/>
    <id>http://yoursite.com/2020/05/10/è®°Androidæºç ä¸‹è½½ä¸ç¼–è¯‘/</id>
    <published>2020-05-10T15:26:07.000Z</published>
    <updated>2020-05-17T09:10:04.361Z</updated>
    
    <content type="html"><![CDATA[<p>4æœˆ30æ—¥ï¼Œé¢†å¯¼çªç„¶äº¤ç»™æˆ‘ä¸€ä¸ªä»»åŠ¡ï¼Œåœ¨Hikey970å¼€å‘æ¿ä¸Šæ­å»ºå½•éŸ³ç¯å¢ƒã€‚æˆ‘åªæƒ³è¯´å¦è¯·é«˜æ˜å§ã€‚æˆ‘å®åœ¨â€¦â€¦æˆ‘ä¹Ÿä¸æ˜¯è°¦è™šï¼Œæˆ‘ä¸€ä¸ªä¸Šå±‚åº”ç”¨å¼€å‘æ€ä¹ˆçªç„¶åšèµ·åµŒå…¥å¼æ¥äº†å‘¢ï¼Ÿä½†æ˜¯ï¼Œé¢†å¯¼è®²â€œå·²ç»ç ”ç©¶å†³å®šäº†â€ï¼Œåæ¥æˆ‘å°±å¿µäº†ä¸¤é¦–è¯—ï¼Œå«â€œè‹Ÿåˆ©å›½å®¶ç”Ÿæ­»ä»¥ï¼Œå²‚å› ç¥¸ç¦é¿è¶‹ä¹‹â€ã€‚  </p><h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><p>é¢†å¯¼è¿˜åœ¨è·Ÿæˆ‘è®¨è®ºä¹°ä»€ä¹ˆæ ·çš„éº¦å…‹é£çš„æ—¶å€™ï¼Œæˆ‘çªç„¶åœ¨è®ºå›ä¸­çœ‹åˆ°ï¼Œ<a href="http://smartfire.cn/thread-1177-1-2.html" target="_blank" rel="noopener">Hikey970å¼€å‘æ¿é»˜è®¤ä¸æ”¯æŒ<code>USB AUDIO</code></a>ï¼Œéœ€è¦ä¿®æ”¹å†…æ ¸é…ç½®å¼€å¯ã€‚å¥½å˜›ï¼Œè¿˜ä¹°ä¸ªå•¥éº¦å…‹é£ï¼Œå…ˆæŠŠéŸ³é¢‘è¾“å…¥è°ƒé€šå†è¯´å§ã€‚  </p><p>æ ¹æ®<a href="https://blog.csdn.net/u010164190/article/details/90699235?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=USB%20AUDIO&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~sobaiduweb~default-8-90699235" target="_blank" rel="noopener">Android usb audioå½•éŸ³</a>è¿™ç¯‡åšæ–‡çš„ä»‹ç»ï¼Œæ‰“å¼€<code>USB AUDIO</code>é…ç½®è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“çš„ï¼Œåªéœ€è¦ä¿®æ”¹<code>/kernel-4.9/sound/usb/Kconfig</code>æ–‡ä»¶ä¸­çš„<code>SND_USB_AUDIO</code>å—å³å¯ã€‚  </p><h2 id="ä¸‹è½½AOSPæºç "><a href="#ä¸‹è½½AOSPæºç " class="headerlink" title="ä¸‹è½½AOSPæºç "></a>ä¸‹è½½AOSPæºç </h2><p>è¿˜å¥½æˆ‘ä¸æ˜¯ä»é›¶å¼€å§‹ï¼Œå‰äººå·²ç»æ€»ç»“äº†<a href="http://smartfire.cn/thread-1208-1-1.html" target="_blank" rel="noopener">æºç ç¼–è¯‘AOSPè¯¦ç»†æ­¥éª¤</a>ã€‚  </p><h3 id="ç”¨repoä¸‹è½½AOSPæºç "><a href="#ç”¨repoä¸‹è½½AOSPæºç " class="headerlink" title="ç”¨repoä¸‹è½½AOSPæºç "></a>ç”¨repoä¸‹è½½AOSPæºç </h3><h4 id="é¦–å…ˆéœ€è¦å®‰è£…repo"><a href="#é¦–å…ˆéœ€è¦å®‰è£…repo" class="headerlink" title="é¦–å…ˆéœ€è¦å®‰è£…repo"></a>é¦–å…ˆéœ€è¦å®‰è£…repo</h4><p>æˆ‘ä½¿ç”¨WSLç”¨<code>apt</code>å‘½ä»¤å®‰è£…ï¼ŒæŠ¥é”™ã€‚<br>æœ€åä½¿ç”¨åšå®¢<a href="https://segmentfault.com/a/1190000015279330" target="_blank" rel="noopener">windowsç¯å¢ƒä¸‹repoä¸‹è½½Androidæºä»£ç </a>ä¸­æ¨èçš„äººä¿®æ”¹å¥½çš„repoå®¢æˆ·ç«¯ï¼Œ<a href="https://codeload.github.com/esrlabs/git-repo/zip/stable" target="_blank" rel="noopener">ç‚¹æ­¤ä¸‹è½½</a>ã€‚  </p><h4 id="åˆå§‹åŒ–repoä»“åº“"><a href="#åˆå§‹åŒ–repoä»“åº“" class="headerlink" title="åˆå§‹åŒ–repoä»“åº“"></a>åˆå§‹åŒ–repoä»“åº“</h4><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œä»¥æ¸…åå¤§å­¦AOSPé•œåƒä»“åº“åˆå§‹åŒ–repoï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo init -u https://aosp.tuna.tsinghua.edu.cn/platform/manifest -b android-9.0.0_r8 --no-repo-verify --repo-branch=stable</span><br></pre></td></tr></table></figure><h4 id="å¼€å§‹ä¸‹è½½æºç "><a href="#å¼€å§‹ä¸‹è½½æºç " class="headerlink" title="å¼€å§‹ä¸‹è½½æºç "></a>å¼€å§‹ä¸‹è½½æºç </h4><p>è®ºå›ä¸­ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œrepoä»“åº“åŒæ­¥ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo sync -j4</span><br></pre></td></tr></table></figure><p><code>-j4</code>çš„å«ä¹‰ä¸ºä½¿ç”¨å››çº¿ç¨‹è¿›è¡Œä»“åº“åŒæ­¥ã€‚<br>ä½†ç”±äºAOSPæºç è¿‡å¤šï¼Œå¸¸å¸¸ç”±äºç½‘ç»œåŸå› å¯¼è‡´åŒæ­¥ä¸­æ–­ï¼ŒæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error: error: Exited sync due to fetch errors</span><br></pre></td></tr></table></figure><p>å› æ­¤éœ€è¦åŠ ä¸Šå¼ºåˆ¶åŒæ­¥çš„é€‰é¡¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo sync -j4 -f --force-sync</span><br></pre></td></tr></table></figure><h3 id="ä¸‹è½½è¿‡ç¨‹ä¸­é‡åˆ°çš„å‘"><a href="#ä¸‹è½½è¿‡ç¨‹ä¸­é‡åˆ°çš„å‘" class="headerlink" title="ä¸‹è½½è¿‡ç¨‹ä¸­é‡åˆ°çš„å‘"></a>ä¸‹è½½è¿‡ç¨‹ä¸­é‡åˆ°çš„å‘</h3><h4 id="aux-hæ–‡ä»¶æ— æ³•åˆ›å»º"><a href="#aux-hæ–‡ä»¶æ— æ³•åˆ›å»º" class="headerlink" title="aux.hæ–‡ä»¶æ— æ³•åˆ›å»º"></a><code>aux.h</code>æ–‡ä»¶æ— æ³•åˆ›å»º</h4><p>å¼€å§‹æˆ‘æ˜¯åœ¨PowerShellç¯å¢ƒè¿›è¡Œçš„æºç ä¸‹è½½ï¼Œä½†æ¯å½“ä¸‹è½½åˆ°<code>aux.h</code>æ–‡ä»¶æ—¶ï¼Œå°±ä¼šæŠ¥é”™æ–‡ä»¶æ— æ³•è¢«åˆ›å»ºã€‚ç»æŸ¥èµ„æ–™ï¼Œå‘ç°<code>aux</code>æ˜¯Windowså¹³å°çš„ä¿ç•™æ–‡ä»¶åï¼Œæ— æ³•è¢«ç”¨æˆ·ä½¿ç”¨ã€‚ä¸ä¿¡ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª<code>aux.txt</code>è¯•è¯•ã€‚  </p><p>å…¶å®é™¤auxä¹‹å¤–ï¼ŒWindowsè¿˜æœ‰è®¸å¤šé¢„ç•™æ–‡ä»¶åä¸èƒ½ç”¨ï¼Œ<a href="https://www.howtogeek.com/fyi/windows-10-still-wont-let-you-use-these-file-names-reserved-in-1974/" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>åšäº†å¾ˆå¥½çš„æ€»ç»“ã€‚</p><p>å…·ä½“å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CON, PRN, AUX, NUL, COM1, COM2, COM3, COM4, COM5, COM6, COM7, COM8, COM9, LPT1, LPT2, LPT3, LPT4, LPT5, LPT6, LPT7, LPT8, and LPT9</span><br></pre></td></tr></table></figure><p>åœ¨WSLç¯å¢ƒè¿›è¡Œ<code>repo sync</code>ï¼Œå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚  </p><h4 id="å¤§å°å†™ä¸æ•æ„Ÿå¯¼è‡´çš„æ–‡ä»¶ä¸¢å¤±"><a href="#å¤§å°å†™ä¸æ•æ„Ÿå¯¼è‡´çš„æ–‡ä»¶ä¸¢å¤±" class="headerlink" title="å¤§å°å†™ä¸æ•æ„Ÿå¯¼è‡´çš„æ–‡ä»¶ä¸¢å¤±"></a>å¤§å°å†™ä¸æ•æ„Ÿå¯¼è‡´çš„æ–‡ä»¶ä¸¢å¤±</h4><p>AOSPæºç ä¸­ï¼Œæœ‰è®¸å¤šæºæ–‡ä»¶æ˜¯é™¤å¤§å°å†™å¤–ç›¸åŒçš„ï¼Œè¿™æ ·åœ¨Windowsç³»ç»Ÿcloneä»“åº“æ—¶å¯èƒ½å¯¼è‡´å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶è¢«å½“ä½œé‡åæ–‡ä»¶ä¸¢å¤±ï¼Œæˆ–è€…åœ¨ç¼–è¯‘æ—¶ä¼šå¯¼è‡´é”™è¯¯åŒ…å«å¤´æ–‡ä»¶ <em>ï¼ˆå‘çˆ¹çš„Windowsï¼‰</em>ã€‚</p><p>å¯é€šè¿‡å¦‚ä¸‹pythonè„šæœ¬æ‰¹é‡è®¾ç½®ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å¤¹çš„æ–‡ä»¶å¤§å°å†™æ•æ„Ÿï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">path = <span class="string">r'F:\\git_repo\\repo-tsinghua-linux\\tools'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> folderName, subfolders, fileNames <span class="keyword">in</span> os.walk(path):</span><br><span class="line">    os.system(<span class="string">'fsutil.exe file SetCaseSensitiveInfo '</span> + folderName + <span class="string">' enable'</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Success!"</span>)</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯åœ¨WSLä¸‹ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è®¾ç½®æˆ–è·å–ç›®å½•æ˜¯å¦å¤§å°å†™æ•æ„Ÿï¼ˆéœ€è¦<code>apt install attr</code>ï¼‰ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> è®¾ç½®</span><br><span class="line">setfattr -n system.wsl_case_sensitive -v 1 "/mnt/f/git_repo/repo-tsinghua-linux/kernel/linux/net/netfilter"</span><br><span class="line"><span class="meta">#</span> è·å–</span><br><span class="line">getfattr -n system.wsl_case_sensitive "/mnt/f/git_repo/repo-tsinghua-linux/kernel/linux/net/netfilter"</span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡ä¸Šè¿°æ–¹å¼å…ˆåˆ›å»ºä¸€ä¸ªå¤§å°å†™æ•æ„Ÿçš„ç›®å½•ï¼Œç„¶åå°†ä»£ç ä»“åº“è§£å‹åˆ°è¯¥ç›®å½•ä¸‹ï¼Œåˆ™æ–°ç”Ÿæˆçš„ç›®å½•éƒ½æ˜¯å¤§å°å†™æ•æ„Ÿçš„äº†ã€‚  </p><h2 id="ä¸‹è½½å¹¶ç¼–è¯‘Hikey-970å†…æ ¸æºç "><a href="#ä¸‹è½½å¹¶ç¼–è¯‘Hikey-970å†…æ ¸æºç " class="headerlink" title="ä¸‹è½½å¹¶ç¼–è¯‘Hikey 970å†…æ ¸æºç "></a>ä¸‹è½½å¹¶ç¼–è¯‘Hikey 970å†…æ ¸æºç </h2><h3 id="æœ¬åœ°clone"><a href="#æœ¬åœ°clone" class="headerlink" title="æœ¬åœ°clone"></a>æœ¬åœ°clone</h3><p>æ ¹æ®è®ºå›çš„å»ºè®®ï¼ŒåŸç”Ÿçš„kernelä¸èƒ½bootè¿™ä¸ªç‰ˆæœ¬çš„AOSPï¼Œä¼šå¯¼è‡´å„ç§é—®é¢˜ï¼Œéœ€è¦é‡æ–°clone linaroå®˜æ–¹é’ˆå¯¹hikey970çš„kernelæºç ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/96boards-hikey/linux.git -b hikey970-v4.9 linux</span><br></pre></td></tr></table></figure><p>ä½†å›½å†…çš„ç½‘ç»œç¯å¢ƒï¼Œclone githubä»“åº“åªæœ‰20KBpsçš„é€Ÿåº¦ï¼Œä¸‹è½½è¿™ä¸‰å››ä¸ªGBçš„ä»“åº“è¦åˆ°çŒ´å¹´é©¬æœˆã€‚</p><p>äºæ˜¯é¦–å…ˆå°è¯•æŒ‚ä»£ç†ï¼Œæˆ‘çš„è®¡ç®—æœºä¸Šéƒ¨ç½²æœ‰V2rayçš„socks5ä»£ç†ï¼Œä»£ç†ç«¯å£å·ä¸º10808ï¼Œäºæ˜¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œgitå…¨å±€ä»£ç†è®¾ç½®ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> å¼€å¯å…¨å±€ä»£ç†</span><br><span class="line">git config --global http.proxy 'socks5://127.0.0.1:10808'</span><br><span class="line">git config --global https.proxy 'socks5://127.0.0.1:10808'</span><br><span class="line"><span class="meta">#</span> å…³é—­å…¨å±€ä»£ç†</span><br><span class="line">git config --global --unset http.proxy</span><br><span class="line">git config --global --unset https.proxy</span><br></pre></td></tr></table></figure><p>ä½†è®¾ç½®ä»£ç†åï¼Œåƒå†…æ ¸æºç è¿™ä¹ˆå¤§çš„ä»“åº“ï¼Œè¿˜æ˜¯ä¼šå¤±è´¥ã€‚  </p><h3 id="VPS-clone"><a href="#VPS-clone" class="headerlink" title="VPS clone"></a>VPS clone</h3><p>åœ¨ç»å†æ— æ•°æ¬¡çš„å¤±è´¥åï¼Œæˆ‘ç›´æ¥ä½¿ç”¨VPS cloneæºç ï¼Œç„¶åç”¨FTPåè®®å°†ä»“åº“æ‰“åŒ…ä¼ é€åˆ°äº†æœ¬åœ°ã€‚</p><h3 id="ä¿®æ”¹USB-AUDIOé…ç½®"><a href="#ä¿®æ”¹USB-AUDIOé…ç½®" class="headerlink" title="ä¿®æ”¹USB AUDIOé…ç½®"></a>ä¿®æ”¹USB AUDIOé…ç½®</h3><p>æ•´ä¸ªä»»åŠ¡å°±æ˜¯å›´ç»•è¿™ä¸€æ­¥è¿›è¡Œçš„ï¼Œå‰æ–‡è¯´è¿‡ï¼Œæ‰“å¼€USB AUDIOé…ç½®çš„æ–¹æ³•ä¸ºï¼Œåªéœ€è¦ä¿®æ”¹<code>/kernel-4.9/sound/usb/Kconfig</code>æ–‡ä»¶ä¸­çš„<code>SND_USB_AUDIO</code>å—ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">config SND_USB_AUDIO</span><br><span class="line">tristate &quot;USB Audio/MIDI driver&quot;</span><br><span class="line">select SND_HWDEP</span><br><span class="line">select SND_RAWMIDI</span><br><span class="line">select SND_PCM</span><br><span class="line">select BITREVERSE</span><br><span class="line"># æ–°å¢ä¸‹é¢è¿™è¡Œ</span><br><span class="line">default y</span><br><span class="line"># æ–°å¢ä¸Šé¢è¿™è¡Œ</span><br><span class="line">help</span><br><span class="line">  Say Y here to include support for USB audio and USB MIDI</span><br><span class="line">  devices.</span><br><span class="line"></span><br><span class="line">  To compile this driver as a module, choose M here: the module</span><br><span class="line">  will be called snd-usb-audio.</span><br></pre></td></tr></table></figure><h3 id="å†…æ ¸ç¼–è¯‘"><a href="#å†…æ ¸ç¼–è¯‘" class="headerlink" title="å†…æ ¸ç¼–è¯‘"></a>å†…æ ¸ç¼–è¯‘</h3><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œç¼–è¯‘ï¼Œæ³¨æ„éœ€è¦ç›®å½•å¤§å°å†™æ•æ„Ÿã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd $AOSP_ROOT/kernel/linux</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> ç¯å¢ƒå˜é‡</span><br><span class="line">export ARCH=arm64</span><br><span class="line">export CROSS_COMPILE=$AOSP_ROOT/prebuilts/gcc/linux-x86/aarch64/aarch64-linux-android-4.9/bin/aarch64-linux-android-</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> ç¼–è¯‘Image</span><br><span class="line">make hikey970_defconfig &amp;&amp; make -j4 Image.gz modules</span><br><span class="line"><span class="meta">#</span> ç”Ÿæˆkirin970-hikey970.dtb</span><br><span class="line">make hisilicon/kirin970-hikey970.dtb</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„ç›®æ ‡ä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span>AOSP_ROOT/kernel/linux/arch/arm64/boot/dts/hisilicon/kirin970-hikey970.dts</span><br><span class="line"><span class="meta">$</span>AOSP_ROOT/kernel/linux/arch/arm64/boot/Image</span><br></pre></td></tr></table></figure><h2 id="ç”Ÿæˆç³»ç»Ÿé•œåƒ"><a href="#ç”Ÿæˆç³»ç»Ÿé•œåƒ" class="headerlink" title="ç”Ÿæˆç³»ç»Ÿé•œåƒ"></a>ç”Ÿæˆç³»ç»Ÿé•œåƒ</h2><p>å…¶å®ï¼Œæœ¬æ¬¡ä»»åŠ¡å¹¶ä¸éœ€è¦å®Œæ•´çš„ç¼–è¯‘æ•´ä¸ªAOSPï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<a href="http://hihope.org/hihope/downLoadCenter/testDownFile?filename=20190403/hikey970_android_8_images.rar" target="_blank" rel="noopener">96boardså®˜æ–¹æä¾›çš„AOSPç³»ç»Ÿé•œåƒ</a>ï¼Œåªæ˜¯æ›¿æ¢å…¶ä¸­çš„å†…æ ¸å³å¯ã€‚</p><h3 id="AOSP-bootloaderç¼–è¯‘"><a href="#AOSP-bootloaderç¼–è¯‘" class="headerlink" title="AOSP/bootloaderç¼–è¯‘"></a>AOSP/bootloaderç¼–è¯‘</h3><p>æˆ‘ä»¬è·³è¿‡äº†AOSPç¼–è¯‘è¿™ä¸€æ­¥ï¼Œå®å±æ— å¥ˆï¼Œ120GBçš„ç¡¬ç›˜éƒ½æ²¾æ»¡äº†ï¼Œå®åœ¨æ”¾ä¸ä¸‹é‚£ä¹ˆå¤šç›®æ ‡æ–‡ä»¶ã€‚</p><p>åŒæ ·ï¼Œ<code>bootloader</code>è·å–ä¹Ÿè·³è¿‡ï¼Œç›´æ¥ç”¨å®˜æ–¹é•œåƒã€‚</p><p>AOSPç¼–è¯‘ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶ä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> å³ä½¿æ˜¯ç¼–è¯‘ç”Ÿæˆçš„boot.imgï¼Œä¹Ÿéœ€è¦æ‰‹åŠ¨æ›¿æ¢å…¶å†…æ ¸</span><br><span class="line"><span class="meta">$</span>AOSP_ROOT/out/target/product/hikey970/boot.img </span><br><span class="line"><span class="meta">$</span>AOSP_ROOT/out/target/product/hikey970/system.img</span><br><span class="line"><span class="meta">$</span>AOSP_ROOT/out/target/product/hikey970/cache.img</span><br><span class="line"><span class="meta">$</span>AOSP_ROOT/out/target/product/hikey970/userdata.img</span><br><span class="line"><span class="meta">$</span>AOSP_ROOT/out/target/product/hikey970/dt.img</span><br></pre></td></tr></table></figure><p>bootloaderç¼–è¯‘çš„äº§ç‰©ä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span>AOSP_ROOT/bootloader/l-loader/ptable-aosp-64g.img</span><br><span class="line"><span class="meta">$</span>AOSP_ROOT/bootloader/tools-images-hikey970/sec_xloader.img</span><br><span class="line"><span class="meta">$</span>AOSP_ROOT/bootloader/l-loader/l-loader.bin</span><br><span class="line"><span class="meta">$</span>AOSP_ROOT/bootloader/l-loader/fip.bin</span><br></pre></td></tr></table></figure><p>è€Œæˆ‘ä»¬ä¸‹è½½çš„å®˜æ–¹é•œåƒç›®å½•ä¸‹çš„æ–‡ä»¶å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">hikey970</span><br><span class="line">    â”œâ”€â”€ buildinfo.txt</span><br><span class="line">    â”œâ”€â”€ image</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ Hikey970_download_images.xml</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ boot.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ boot_ramdisk.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ cache.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ dt.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ fip.bin</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ installed-files.txt</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ kernel.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ l-loader.bin</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ lpm3.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ prm_ptable.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ ptable_for_fastboot.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ ramdisk.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ sec_usb_xloader.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ sec_usb_xloader2.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ sec_xloader.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ system.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ update_Hikey970.bat</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ userdata.img</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ uefi</span><br><span class="line">    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ fip.bin</span><br><span class="line">    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ l-loader.bin</span><br><span class="line">    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ lpm3.img</span><br><span class="line">    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ prm_ptable.img</span><br><span class="line">    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ ptable_for_fastboot.img</span><br><span class="line">    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ sec_usb_xloader.img</span><br><span class="line">    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ sec_usb_xloader2.img</span><br><span class="line">    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ sec_xloader.img</span><br><span class="line">    â”‚Â Â  â”‚Â Â  â””â”€â”€ update_Hikey970.bat</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæ‰€æœ‰ç›®æ ‡æ–‡ä»¶éƒ½æ˜¯å­˜åœ¨çš„ã€‚</p><h3 id="é‡æ–°æ‰“åŒ…boot-img"><a href="#é‡æ–°æ‰“åŒ…boot-img" class="headerlink" title="é‡æ–°æ‰“åŒ…boot.img"></a>é‡æ–°æ‰“åŒ…<code>boot.img</code></h3><h4 id="è§£åŒ…boot-img"><a href="#è§£åŒ…boot-img" class="headerlink" title="è§£åŒ…boot.img"></a>è§£åŒ…<code>boot.img</code></h4><p>åœ¨<code>$AOSP_ROOT/system/core/mkbootimg</code>ç›®å½•ä¸‹ï¼Œæœ‰ç€<code>unpack_bootimg</code>å¯æ‰§è¡Œç¨‹åºï¼Œå¯ä»¥åœ¨WSLä¸­è¿è¡Œï¼Œå®ƒå¯ä»¥å°†<code>boot.img</code>è§£åŒ…ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unpackbootimg  -i  ./boot.img  -o ./output</span><br></pre></td></tr></table></figure><p>åˆ™ä¼šç”Ÿæˆoutputç›®å½•ï¼Œç›®å½•ä¸‹æœ‰<code>boot</code>ã€<code>ramdisk</code>ã€<code>second</code>ä¸‰ä¸ªæ–‡ä»¶ã€‚å…¶ä¸­ï¼Œ<code>boot</code>å°±æ˜¯æˆ‘ä»¬è¦æ›¿æ¢çš„å†…æ ¸ï¼Œè€Œ<code>ramdisk</code>åŒ…å«äº†Andoroidç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿä¿¡æ¯ï¼Œè¿™é‡Œä¸å±•å¼€äº†ã€‚</p><h4 id="ç”Ÿæˆæ–°boot"><a href="#ç”Ÿæˆæ–°boot" class="headerlink" title="ç”Ÿæˆæ–°boot"></a>ç”Ÿæˆæ–°boot</h4><p>å…¶å®å°±æ˜¯å°†å†…æ ¸ç¼–è¯‘çš„ä¸¤ä¸ªäº§ç‰©åˆå¹¶ä¸ºä¸€ä¸ªï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat $AOSP_ROOT/kernel/linux/arch/arm64/boot/Image $AOSP_ROOT/kernel/linux/arch/arm64/boot/dts/hisilicon/kirin970-hikey970.dtb &gt; $AOSP_ROOT/Image-dtb</span><br></pre></td></tr></table></figure><h4 id="æ‰“åŒ…boot-img"><a href="#æ‰“åŒ…boot-img" class="headerlink" title="æ‰“åŒ…boot.img"></a>æ‰“åŒ…<code>boot.img</code></h4><p>å°†åˆšåˆšç”Ÿæˆçš„<code>Image-dtb</code>ä¹Ÿæ‹·è´åˆ°<code>output</code>ç›®å½•ä¸‹ï¼Œç„¶åæ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkbootimg --kernel ./output/Image-dtb --ramdisk ./output/ramdisk --cmdline "androidboot.hardware=hikey970 firmware_class.path=/system/etc/firmware loglevel=15 buildvariant=userdebug androidboot.selinux=permissive clk_ignore_unused=true initrd=0xBE19D000,0x16677F earlycon=pl011,0xfff32000,115200 console=ttyAMA6 androidboot.serialno=54DA9CD5022525E4 clk_ignore_unused=true" -o boot.img</span><br></pre></td></tr></table></figure><p>åˆ™ç”Ÿæˆäº†å…¨æ–°çš„<code>boot.img</code>ã€‚</p><h2 id="çƒ§å†™"><a href="#çƒ§å†™" class="headerlink" title="çƒ§å†™"></a>çƒ§å†™</h2><p>Windowsç¯å¢ƒä¸‹ï¼Œæ‰§è¡Œ<code>update_Hikey970.bat</code>å³å¯ã€‚</p><h2 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h2><p>ä»¥<code>cat /proc/asound/cards</code>å‘½ä»¤æŸ¥çœ‹è®¾å¤‡ï¼Œæœç„¶æœ‰äº†USB AUDIOè®¾å¤‡ï¼ŒæˆåŠŸ~</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;4æœˆ30æ—¥ï¼Œé¢†å¯¼çªç„¶äº¤ç»™æˆ‘ä¸€ä¸ªä»»åŠ¡ï¼Œåœ¨Hikey970å¼€å‘æ¿ä¸Šæ­å»ºå½•éŸ³ç¯å¢ƒã€‚æˆ‘åªæƒ³è¯´å¦è¯·é«˜æ˜å§ã€‚æˆ‘å®åœ¨â€¦â€¦æˆ‘ä¹Ÿä¸æ˜¯è°¦è™šï¼Œæˆ‘ä¸€ä¸ªä¸Šå±‚åº”ç”¨å¼€å‘æ€ä¹ˆçªç„¶åšèµ·åµŒå…¥å¼æ¥äº†å‘¢ï¼Ÿä½†æ˜¯ï¼Œé¢†å¯¼è®²â€œå·²ç»ç ”ç©¶å†³å®šäº†â€ï¼Œåæ¥æˆ‘å°±å¿µäº†ä¸¤é¦–è¯—ï¼Œå«â€œè‹Ÿåˆ©å›½å®¶ç”Ÿæ­»ä»¥ï¼Œå²‚å› ç¥¸ç¦é¿è¶‹ä¹‹â€ã€‚  &lt;/p&gt;
&lt;h2
      
    
    </summary>
    
      <category term="ç¬”è®°" scheme="http://yoursite.com/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="æ„å»º" scheme="http://yoursite.com/tags/%E6%9E%84%E5%BB%BA/"/>
    
      <category term="æ“ä½œç³»ç»Ÿ" scheme="http://yoursite.com/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>åˆè‚¥è§…é£Ÿ</title>
    <link href="http://yoursite.com/2020/05/10/%E5%90%88%E8%82%A5%E8%A7%85%E9%A3%9F/"/>
    <id>http://yoursite.com/2020/05/10/åˆè‚¥è§…é£Ÿ/</id>
    <published>2020-05-10T11:03:07.000Z</published>
    <updated>2020-05-10T06:50:29.891Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å…¬å¸è®ºå›çœ‹åˆ°çš„ç¾é£Ÿæ”»ç•¥ï¼Œæœæ–­æŠ„è¿‡æ¥å¤‡å¿˜  </p><h2 id="å°åƒ"><a href="#å°åƒ" class="headerlink" title="å°åƒ"></a>å°åƒ</h2><h3 id="å®˜äº­è·¯å°åƒè¡—"><a href="#å®˜äº­è·¯å°åƒè¡—" class="headerlink" title="å®˜äº­è·¯å°åƒè¡—"></a>å®˜äº­è·¯å°åƒè¡—</h3><ul><li>èƒ–å­è‚¥è‚ ï¼Œåº—é¢å«ç”Ÿä¸€èˆ¬ï¼Œä½†å‘³é“ä¸ä¸€èˆ¬  </li><li>è€åŒ—äº¬é¸¡è‚‰å·  </li><li>å°æ¨ç”Ÿç…  </li><li>æ¡‚èŠ±æ±¤åœ†  </li><li>çœ¼é•œé“æ¿çƒ§çš„çƒ¤é±¿é±¼ï¼ˆä¸çŸ¥é“ç°åœ¨è¿˜æœ‰æ²¡ï¼‰  </li></ul><h3 id="å˜å˜é¸­ä¸‹å·´"><a href="#å˜å˜é¸­ä¸‹å·´" class="headerlink" title="å˜å˜é¸­ä¸‹å·´"></a>å˜å˜é¸­ä¸‹å·´</h3><p>ä½ç½®ï¼šæ·®æ²³è·¯æ­¥è¡Œè¡—ï¼Œé•¿æ±Ÿå‰§é™¢æ—è¾¹å··å­å¾€é‡Œèµ°  </p><p>é€‚åˆçˆ±åƒè¾£çš„ç­’å­ä»¬ï¼Œä»–ä»¬å®¶ä¸è¾£éƒ½æœ‰ç‚¹è¾£ï¼Œä¸è¿‡çœŸçš„å¾ˆé¦™<br><em>P.S.çœ‹æ¥ä¸æˆ‘æ— ç¼˜äº†</em></p><h3 id="é±¼ç…²"><a href="#é±¼ç…²" class="headerlink" title="é±¼ç…²"></a>é±¼ç…²</h3><p>ä½ç½®ï¼šä¹Ÿæ˜¯åœ¨é•¿æ±Ÿå‰§é™¢å··å­é‡Œï¼Œå··å­é‡Œæœ‰ä¸¤å®¶éƒ½å¯ä»¥å»  </p><p>ç°åœ¨ä¸æ¸…æ¥šåˆ°åº•å¼€äº†å¤šå°‘åˆ†åº—ä½†æœ€çˆ±åƒçš„è¿˜æ˜¯è¿™å®¶è€åº—ï¼Œé±¼è‚‰åšçš„å¾ˆé²œå«©å…¥å‘³ï¼Œä½†å…¶å®ƒç‚’èœæ°´å¹³çœŸçš„ä¸æ•¢æ­ç»´ï¼Œå»åƒåƒé±¼é€›é€›è¡—å°±å¥½å•¦  </p><hr><h2 id="å¹¿ä¸œèœã€ç²¥å“"><a href="#å¹¿ä¸œèœã€ç²¥å“" class="headerlink" title="å¹¿ä¸œèœã€ç²¥å“"></a>å¹¿ä¸œèœã€ç²¥å“</h2><h3 id="ç…²ç‹é¤å…"><a href="#ç…²ç‹é¤å…" class="headerlink" title="ç…²ç‹é¤å…"></a>ç…²ç‹é¤å…</h3><p>ä½ç½®ï¼šé»„å±±è·¯ç‚®å…µå­¦é™¢é™„è¿‘  </p><p>ä¸»æ‰“ç²¤èœï¼Œ<strong>çŒªè‚šé¸¡</strong>ä¸é”™ï¼Œé‡Œé¢å„ç§å°ç‚¹å¿ƒä¹Ÿå¯ä»¥éšä¾¿ç‚¹  </p><h3 id="ç…²å®«"><a href="#ç…²å®«" class="headerlink" title="ç…²å®«"></a>ç…²å®«</h3><p>ä½ç½®ï¼šä¸‡è±¡åŸå•†åœºé‡Œé¢  </p><p><strong>çŒªè‚šé¸¡</strong>å¾ˆä¸é”™ï¼Œå¯ä»¥è¯•è¯•   </p><h3 id="ç²¥å…¬é¦†"><a href="#ç²¥å…¬é¦†" class="headerlink" title="ç²¥å…¬é¦†"></a>ç²¥å…¬é¦†</h3><p>ä½ç½®ï¼šåœ¨å®å›½è·¯ä¸Š  </p><p>çˆ±å–ç²¥å¯ä»¥è¯•ä¸‹ï¼Œè™½æ¯”ä¸ä¸Šå»å¹¿å·å½“åœ°å–çš„è¿‡ç˜¾ï¼Œä½†åœ¨åˆè‚¥ä¹Ÿç®—åšçš„ç”¨å¿ƒçš„ä¸€å®¶æ½®æ±•ç²¥äº†   </p><hr><h2 id="æ—¥æ–™ã€çƒ¤è‚‰ã€ä¸²ä¸²"><a href="#æ—¥æ–™ã€çƒ¤è‚‰ã€ä¸²ä¸²" class="headerlink" title="æ—¥æ–™ã€çƒ¤è‚‰ã€ä¸²ä¸²"></a>æ—¥æ–™ã€çƒ¤è‚‰ã€ä¸²ä¸²</h2><h3 id="ä¹…æ—¦æ—¥æ–™"><a href="#ä¹…æ—¦æ—¥æ–™" class="headerlink" title="ä¹…æ—¦æ—¥æ–™"></a>ä¹…æ—¦æ—¥æ–™</h3><p>ä½ç½®ï¼šå¤©é¹…æ¹–é“¶æ³°åŸ  </p><p>æ—¥æ–™é‡Œå‘³é“ä¸é”™é‡Œé¢æ€§ä»·æ¯”é«˜çš„ï¼Œæ¨è<strong>æµ·é²œç‰å­çƒ§</strong>ã€<strong>å„ç§å¯¿å¸å·</strong>ã€<strong>é¹…è‚æ‰‹æ¡</strong>ç­‰ï¼Œçƒ¤è‚‰æ„Ÿè§‰ä¸€èˆ¬ï¼Œæ…ç‚¹ã€‚äººå‡100å·¦å³  </p><h3 id="é“çƒ§è‚‰é…’åœº"><a href="#é“çƒ§è‚‰é…’åœº" class="headerlink" title="é“çƒ§è‚‰é…’åœº"></a>é“çƒ§è‚‰é…’åœº</h3><p>ä½ç½®ï¼šé»„å±±è·¯1912  </p><p>çƒ¤è‚‰ä¸€çº§æ£’ï¼Œé€‚åˆå¶å°”å»è§£é¦‹ï¼Œç¯å¢ƒä¹Ÿä¸é”™ï¼Œéœ€è¦æå‰é¢„çº¦ï¼ŒåŒ…å¢ç´§å¼ ï¼Œé‡Œé¢è‚‰æ ¹æ®é’±åŒ…éšä¾¿ç‚¹ï¼Œäººå‡200å·¦å³ï¼Œé€‚åˆé‡å¤§çºªå¿µæ—¥åº†ç¥  </p><h3 id="å»¶æ—­çƒ§çƒ¤ä¸²åŸ"><a href="#å»¶æ—­çƒ§çƒ¤ä¸²åŸ" class="headerlink" title="å»¶æ—­çƒ§çƒ¤ä¸²åŸ"></a>å»¶æ—­çƒ§çƒ¤ä¸²åŸ</h3><p>ä½ç½®ï¼šå®å›½è·¯  </p><p>ç”µçƒ¤ä¸²ï¼Œé…å¥½æ–™è‡ªå·±æ”¾ä¸Šå»è½¬å°±è¡Œï¼Œå¤§ä¼—ç‚¹è¯„å¯ä»¥æå‰é¢„çº¦ï¼Œç»å¸¸æ’é˜Ÿï¼Œç§‘å­¦å¤§é“ä¹Ÿæœ‰å®¶åˆ†åº—ä½†æ„Ÿè§‰æ²¡å®å›½è·¯ç‚¹å‘³é“æ­£ï¼Œäººå‡80å·¦å³ï¼Œå¸¸å¹´æœ‰118åŒäººå›¢è´­å¥—é¤å’Œ208å››äººå›¢è´­å¥—é¤ï¼Œä¹ŸåŸºæœ¬å¤Ÿåƒäº†  </p><h3 id="è€ä¸²ä¸²ä¸²ç«é”…"><a href="#è€ä¸²ä¸²ä¸²ç«é”…" class="headerlink" title="è€ä¸²ä¸²ä¸²ç«é”…"></a>è€ä¸²ä¸²ä¸²ç«é”…</h3><p>ä½ç½®ï¼š 1912<br>åˆè‚¥å¾ˆå¤šåˆ†åº—äº†ï¼Œæœ€çˆ±åƒçš„è¿˜æ˜¯1912é‚£å®¶ï¼ŒåŒæ ·æ˜¯äººå¤šï¼Œæ’é˜Ÿï¼Œäººå‡ä¸ƒå…«å  </p><hr><h2 id="æµ·é²œ"><a href="#æµ·é²œ" class="headerlink" title="æµ·é²œ"></a>æµ·é²œ</h2><h3 id="é—½å—æµ·é²œé¢é¦†"><a href="#é—½å—æµ·é²œé¢é¦†" class="headerlink" title="é—½å—æµ·é²œé¢é¦†"></a>é—½å—æµ·é²œé¢é¦†</h3><p>ä½ç½®ï¼šå¸‚ä¸‰ä¸­æ—è¾¹ï¼Œè‹å·è·¯ä¸ä¹‰ä»“å··äº¤å£  </p><p>æµ·é²œé¢åå‡ å—é’±ä¸€ç¢—ï¼Œæ±¤å¾ˆé²œï¼Œå•ç‚¹å¤§è™¾ã€è›å­ä¹Ÿå¾ˆè‚¥ç¾æ–°é²œï¼Œç”œä¸ä¸çš„é‚£ç§ï¼Œäººå‡äºŒä¸‰å</p><h3 id="ç¦æ˜Ÿå®¶æµ·é²œé¤å…"><a href="#ç¦æ˜Ÿå®¶æµ·é²œé¤å…" class="headerlink" title="ç¦æ˜Ÿå®¶æµ·é²œé¤å…"></a>ç¦æ˜Ÿå®¶æµ·é²œé¤å…</h3><p>ä½ç½®ï¼šé’é˜³è·¯</p><p>è€æ¿æ˜¯æµ™æ±Ÿä¸€ä¸ªå°æ¸”æ‘çš„ï¼Œè‡ªå®¶æ¸”èˆ¹æ‰“æä¸Šå²¸é€Ÿå†»åæ¯å¤©é€åˆ°åˆè‚¥ï¼Œä»ä¸€ä¸ªå¾®å•†å°ä¸»åˆ°ç°åœ¨å·²ç»å¼€äº†ä¸¤å®¶åˆ†åº—ï¼Œé£ŸæçœŸçš„å¾ˆæ–°é²œï¼Œæ¨è<strong>æ¤’ç›è±†è…é±¼</strong>ã€<strong>æµ·é²œç‚’ç²‰</strong>ï¼ˆæå‰ç‚¹ï¼Œè¦ç‚’è¿‘åŠä¸ªå¤šå°æ—¶ï¼‰ã€<strong>å¹²è´å†¬ç“œ</strong>ã€<strong>çˆ†ç‚’ç« é±¼</strong>ã€<strong>é¸¦ç‰‡é±¼å¤´</strong>ç­‰ï¼Œäººå‡ç¨é«˜ï¼Œå¤§æ¦‚130å·¦å³</p><hr><h2 id="å¾½èœ"><a href="#å¾½èœ" class="headerlink" title="å¾½èœ"></a>å¾½èœ</h2><h3 id="åˆ€æ¿é¦™"><a href="#åˆ€æ¿é¦™" class="headerlink" title="åˆ€æ¿é¦™"></a>åˆ€æ¿é¦™</h3><p>ä½ç½®ï¼šå‡¤å‡°åŸé‡‘ç‰›è·¯é™„è¿‘  </p><p>æ¨è<strong>æ¯›å³°ç”Ÿç„–é¸¡</strong>ã€<strong>çš–å—å±±çŒªè‚‰ç„–é¢</strong>ã€<strong>çŸ³è€³ç‚’åœŸé¸¡è›‹</strong>ç­‰ï¼Œé‡Œé¢èœåŸºæœ¬éƒ½åƒè¿‡ï¼Œè¿˜æ²¡è¸©è¿‡é›·ï¼Œå»æ™šäº†ç»å¸¸æœ‰èœå“å”®ç½„</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨å…¬å¸è®ºå›çœ‹åˆ°çš„ç¾é£Ÿæ”»ç•¥ï¼Œæœæ–­æŠ„è¿‡æ¥å¤‡å¿˜  &lt;/p&gt;
&lt;h2 id=&quot;å°åƒ&quot;&gt;&lt;a href=&quot;#å°åƒ&quot; class=&quot;headerlink&quot; title=&quot;å°åƒ&quot;&gt;&lt;/a&gt;å°åƒ&lt;/h2&gt;&lt;h3 id=&quot;å®˜äº­è·¯å°åƒè¡—&quot;&gt;&lt;a href=&quot;#å®˜äº­è·¯å°åƒè¡—&quot; class=&quot;he
      
    
    </summary>
    
      <category term="æ‚è°ˆ" scheme="http://yoursite.com/categories/%E6%9D%82%E8%B0%88/"/>
    
    
      <category term="ç”Ÿæ´»" scheme="http://yoursite.com/tags/%E7%94%9F%E6%B4%BB/"/>
    
      <category term="ç¾é£Ÿ" scheme="http://yoursite.com/tags/%E7%BE%8E%E9%A3%9F/"/>
    
  </entry>
  
  <entry>
    <title>Hello World, Gradle</title>
    <link href="http://yoursite.com/2018/11/15/Gradle%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2018/11/15/Gradleä½¿ç”¨/</id>
    <published>2018-11-14T22:00:00.000Z</published>
    <updated>2020-05-10T07:06:47.169Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‰è¨€ï¼šä¸ºäº†è·‘é€šgradleï¼Œå·®ç‚¹æ²¡è´¹æ­»åŠ²ï¼Œæœ¬æ–‡è®°å½•é…ç½®gradleè¿‡ç¨‹ä¸­è¸©è¿‡çš„å‘</p></blockquote><h2 id="gradleæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦é…ç½®gradle"><a href="#gradleæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦é…ç½®gradle" class="headerlink" title="gradleæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦é…ç½®gradle"></a>gradleæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦é…ç½®gradle</h2><p>Gradleæ˜¯ä¸€ä¸ªåŸºäºJVMçš„æ„å»ºå·¥å…·ï¼Œæ˜¯ä¸€æ¬¾é€šç”¨çµæ´»çš„æ„å»ºå·¥å…·ï¼Œæ”¯æŒmavenï¼ŒIvyä»“åº“ï¼Œæ”¯æŒä¼ é€’æ€§ä¾èµ–ç®¡ç†ï¼Œè€Œä¸éœ€è¦è¿œç¨‹ä»“åº“æˆ–è€…æ˜¯pom.xmlå’Œivy.xmlé…ç½®æ–‡ä»¶ï¼ŒåŸºäºGroovyï¼Œbuildè„šæœ¬ä½¿ç”¨Groovyç¼–å†™ã€‚</p><p>ä»¥ä¸Šå†…å®¹æ¥è‡ªç™¾åº¦ç™¾ç§‘ï¼Œå¯¹äºæˆ‘æ¥è¯´ï¼Œå°†ç¼–è¯‘å¥½çš„soæ–‡ä»¶ä¸javaä»£ç æ‰“åŒ…æˆapkæ–‡ä»¶å¿…é¡»ä½¿ç”¨gradleï¼Œå¯¹æ­¤æˆ‘æš‚æ—¶åªçŸ¥é“è¿™ä¹ˆå¤šã€‚</p><h2 id="gradleå®‰è£…"><a href="#gradleå®‰è£…" class="headerlink" title="gradleå®‰è£…"></a>gradleå®‰è£…</h2><p>ä¸‹è½½ï¼Œè§£å‹ï¼Œé…ç½®ç¯å¢ƒå˜é‡ï¼Œæ— éœ€å¤šè¨€ã€‚<br>å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯<code>GRADLE_USER_HOME</code>è¿™ä¸ªç¯å¢ƒå˜é‡å¯ä»¥ä¿®æ”¹ç¼“å­˜æ–‡ä»¶çš„ä½ç½®ï¼Œç¼“å­˜æ–‡ä»¶è¿˜æ˜¯å¾ˆé‡è¦çš„ï¼Œæˆ‘è¢«å®ƒå‘æƒ¨äº†ã€‚<br>è¿˜æœ‰ä¸€äº›åˆ«çš„æ–¹æ³•å¯ä»¥ä¿®æ”¹ç¼“å­˜æ–‡ä»¶ä½ç½®ï¼Œè¯¦è§ï¼š<a href="https://blog.csdn.net/yanzi1225627/article/details/52024632" target="_blank" rel="noopener">https://blog.csdn.net/yanzi1225627/article/details/52024632</a> ã€‚</p><h2 id="ä¸‹è½½ä¾èµ–é¡¹"><a href="#ä¸‹è½½ä¾èµ–é¡¹" class="headerlink" title="ä¸‹è½½ä¾èµ–é¡¹"></a>ä¸‹è½½ä¾èµ–é¡¹</h2><p>å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨gradleæ„å»ºé¡¹ç›®ï¼Œéœ€è¦ä¸‹è½½å¾ˆå¤šä¾èµ–é¡¹ã€‚åœ¨æ‰§è¡Œè¿™ä¸€æ­¥ä¹‹å‰ï¼Œé¦–å…ˆè¦ä¿®æ”¹é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹<code>local.properties</code>ä¸<code>build.gradle</code>ä¸¤ä¸ªæ–‡ä»¶ã€‚</p><h3 id="local-properties-â€“-æœ¬åœ°ndkä½ç½®"><a href="#local-properties-â€“-æœ¬åœ°ndkä½ç½®" class="headerlink" title="local.properties â€“ æœ¬åœ°ndkä½ç½®"></a>local.properties â€“ æœ¬åœ°ndkä½ç½®</h3><p>å°†<code>ndk.dir</code>ä¿®æ”¹ä¸ºæœ¬åœ°ndkå­˜æ”¾çš„ä½ç½®ï¼Œå°†<code>sdk.dir</code>ä¿®æ”¹ä¸ºandroid-sdkå­˜æ”¾çš„ä½ç½®ã€‚</p><h3 id="build-gradle-â€“-gradleä»“åº“"><a href="#build-gradle-â€“-gradleä»“åº“" class="headerlink" title="build.gradle â€“ gradleä»“åº“"></a>build.gradle â€“ gradleä»“åº“</h3><p>å¦‚æœä¸ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ï¼Œç½‘ä¸Šè¯´ä¸‹è½½é€Ÿåº¦å¾ˆæ…¢ï¼Œæˆ‘è‡ªå·±çš„ä½“éªŒæ˜¯ç›´æ¥æŠ¥é”™ï¼Œæ— æ³•ä¸‹è½½ã€‚<br>å°†gradleä»“åº“ä¿®æ”¹ä¸ºå›½å†…çš„é˜¿é‡Œäº‘åœ°å€ï¼Œä¸‹è½½é€Ÿåº¦å—–å—–çš„ï¼Œä¸‹é¢ä¸ºæˆ‘çš„build.gradleæ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Top-level build file where you can add configuration options common to all sub-projects/modules.</span></span><br><span class="line"></span><br><span class="line">buildscript &#123;</span><br><span class="line"></span><br><span class="line">repositories &#123;</span><br><span class="line">        def REPOSITORY_URL = <span class="string">'http://maven.aliyun.com/nexus/content/groups/public/'</span></span><br><span class="line">        all &#123; ArtifactRepository repo -&gt;</span><br><span class="line">            <span class="keyword">if</span>(repo <span class="keyword">instanceof</span> MavenArtifactRepository)&#123;</span><br><span class="line">                def url = repo.url.toString()</span><br><span class="line">                <span class="keyword">if</span> (url.startsWith(<span class="string">'https://repo1.maven.org/maven2'</span>) || url.startsWith(<span class="string">'https://jcenter.bintray.com/'</span>)) &#123;</span><br><span class="line">                    remove repo</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        maven &#123;</span><br><span class="line">            url REPOSITORY_URL</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//google()</span></span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath <span class="string">'com.android.tools.build:gradle:2.1.2'</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// <span class="doctag">NOTE:</span> Do not place your application dependencies here; they belong</span></span><br><span class="line">        <span class="comment">// in the individual module build.gradle files</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">allprojects &#123;</span><br><span class="line">repositories &#123;</span><br><span class="line">        def REPOSITORY_URL = <span class="string">'http://maven.aliyun.com/nexus/content/groups/public/'</span></span><br><span class="line">        all &#123; ArtifactRepository repo -&gt;</span><br><span class="line">            <span class="keyword">if</span>(repo <span class="keyword">instanceof</span> MavenArtifactRepository)&#123;</span><br><span class="line">                def url = repo.url.toString()</span><br><span class="line">                <span class="keyword">if</span> (url.startsWith(<span class="string">'https://repo1.maven.org/maven2'</span>) || url.startsWith(<span class="string">'https://jcenter.bintray.com/'</span>)) &#123;</span><br><span class="line">                    remove repo</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        maven &#123;</span><br><span class="line">            url REPOSITORY_URL</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//google()</span></span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">task <span class="title">clean</span><span class="params">(type: Delete)</span> </span>&#123;</span><br><span class="line">    delete rootProject.buildDir</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸‹è½½æ—¶å‡ºç°<code>Could not create plugin of type &#39;AppPlugin&#39;</code>é”™è¯¯ï¼Œå¯ä»¥å…ˆæŠŠgradleç¼“å­˜ç›®å½•æ¸…ç©ºï¼Œæˆ‘è¢«è¿™ä¸ªé—®é¢˜æ•´äº†ä¸¤å¤©ã€‚</p><h3 id="gradleä½¿ç”¨ä»£ç†"><a href="#gradleä½¿ç”¨ä»£ç†" class="headerlink" title="gradleä½¿ç”¨ä»£ç†"></a>gradleä½¿ç”¨ä»£ç†</h3><p>å¦‚æœä½ ä¸æƒ³ç”¨å›½å†…çš„é•œåƒåœ°å€ï¼Œå¯ä»¥ç¿»å¢™èµ°ä»£ç†ï¼Œæ–¹æ³•ä¸ºä¿®æ”¹<code>gradle.properties</code>æ–‡ä»¶ï¼Œæ·»åŠ ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.gradle.jvmargs=-DsocksProxyHost=127.0.0.1 -DsocksProxyPort=1080</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;å‰è¨€ï¼šä¸ºäº†è·‘é€šgradleï¼Œå·®ç‚¹æ²¡è´¹æ­»åŠ²ï¼Œæœ¬æ–‡è®°å½•é…ç½®gradleè¿‡ç¨‹ä¸­è¸©è¿‡çš„å‘&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;gradleæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦é…ç½®gradle&quot;&gt;&lt;a href=&quot;#gradleæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦é…ç½®gradle&quot;
      
    
    </summary>
    
      <category term="ç¬”è®°" scheme="http://yoursite.com/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="æ„å»º" scheme="http://yoursite.com/tags/%E6%9E%84%E5%BB%BA/"/>
    
  </entry>
  
  <entry>
    <title>IPåœ°å€ä¸macåœ°å€è·å–å°ç»“</title>
    <link href="http://yoursite.com/2018/11/11/QNX%E5%B9%B3%E5%8F%B0%E8%8E%B7%E5%8F%96ip%E4%B8%8Emac/"/>
    <id>http://yoursite.com/2018/11/11/QNXå¹³å°è·å–ipä¸mac/</id>
    <published>2018-11-10T19:00:00.000Z</published>
    <updated>2020-05-10T07:08:08.051Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Linuxå¹³å°è·å–IPåœ°å€"><a href="#Linuxå¹³å°è·å–IPåœ°å€" class="headerlink" title="Linuxå¹³å°è·å–IPåœ°å€"></a>Linuxå¹³å°è·å–IPåœ°å€</h2><p>é¦–å…ˆæ˜¯ä½¿ç”¨<code>ioctl</code>è·å–IPåœ°å€çš„æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š  </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;net/if.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getIPAddr</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; ipAddrs)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> fd;</span><br><span class="line"><span class="keyword">int</span> interfaceNum = <span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ifreq</span> <span class="title">buf</span>[16];</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ifconf</span> <span class="title">ifc</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ifreq</span> <span class="title">ifrcopy</span>;</span></span><br><span class="line"><span class="keyword">char</span> ip[<span class="number">32</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((fd = socket(AF_INET, SOCK_DGRAM, <span class="number">0</span>)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">perror(<span class="string">"socket"</span>);</span><br><span class="line">close(fd);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ifc.ifc_len = <span class="keyword">sizeof</span>(buf);</span><br><span class="line">ifc.ifc_req = buf;</span><br><span class="line"><span class="keyword">if</span> (!ioctl(fd, SIOCGIFCONF, (<span class="keyword">char</span> *)&amp;ifc)) &#123;</span><br><span class="line">interfaceNum = ifc.ifc_len / <span class="keyword">sizeof</span>(struct ifreq);</span><br><span class="line"><span class="keyword">while</span> (interfaceNum-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">ifrcopy = buf[interfaceNum];</span><br><span class="line"><span class="keyword">if</span> (ioctl(fd, SIOCGIFFLAGS, &amp;ifrcopy)) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"ioctl: %s [%s:%d]\n"</span>, strerror(errno), __FILE__, __LINE__);</span><br><span class="line">close(fd);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get the IP of this interface</span></span><br><span class="line"><span class="keyword">if</span> (!ioctl(fd, SIOCGIFADDR, (<span class="keyword">char</span> *)&amp;buf[interfaceNum])) &#123;</span><br><span class="line"><span class="built_in">snprintf</span>(ip, <span class="keyword">sizeof</span>(ip), <span class="string">"%s"</span>, (<span class="keyword">char</span> *)inet_ntoa(((struct sockaddr_in *)&amp;(buf[interfaceNum].ifr_addr))-&gt;sin_addr));</span><br><span class="line">ipAddrs.push_back(<span class="built_in">string</span>(ip));</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"ioctl: %s [%s:%d]\n"</span>, strerror(errno), __FILE__, __LINE__);</span><br><span class="line">close(fd);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"ioctl: %s [%s:%d]\n"</span>, strerror(errno), __FILE__, __LINE__);</span><br><span class="line">close(fd);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">close(fd);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; iplist;</span><br><span class="line">getIPAddr(iplist);</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"get "</span> &lt;&lt; iplist.size() &lt;&lt; <span class="string">" ip."</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ipnum = iplist.size();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ipnum; i++) &#123;</span><br><span class="line"><span class="built_in">string</span> ip = iplist[i];</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"ip"</span> &lt;&lt; i &lt;&lt; <span class="string">": "</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s\n"</span>, ip.c_str());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç é€šè¿‡<code>ioctl</code>è·å¾—æœ¬æœºçš„ipï¼Œæ ¸å¿ƒä»£ç ä¸ºï¼š  </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fd = socket(AF_INET, SOCK_DGRAM, <span class="number">0</span>);</span><br><span class="line">ioctl(fd, SIOCGIFADDR, (<span class="keyword">char</span> *)&amp;buf[interfaceNum]);</span><br></pre></td></tr></table></figure><p>å½“<code>ioctl</code>ç¬¬äºŒä¸ªå‚æ•°ä¸º<code>SIOCGIFADDR</code>ï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯ipåœ°å€ã€‚  </p><h2 id="Linuxè·å¾—macåœ°å€"><a href="#Linuxè·å¾—macåœ°å€" class="headerlink" title="Linuxè·å¾—macåœ°å€"></a>Linuxè·å¾—macåœ°å€</h2><p>ä¸‹é¢æ˜¯ä¸€ç§æœ€å¸¸ç”¨çš„ä½¿ç”¨<code>ioctl</code>è·å–macåœ°å€çš„æ–¹æ³•ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>   <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>   <span class="meta-string">&lt;sys/ioctl.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>   <span class="meta-string">&lt;sys/socket.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>   <span class="meta-string">&lt;netinet/in.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>   <span class="meta-string">&lt;net/if.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>   <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123; </span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ifreq</span> <span class="title">m_ifreq</span>;</span> </span><br><span class="line">    <span class="keyword">int</span> sock; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(argc!=<span class="number">2</span>) &#123; </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Usage: ethname\n "</span>); </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">if</span>((sock = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>)) &lt; <span class="number">0</span>) &#123; </span><br><span class="line">        perror(<span class="string">"socket"</span>); </span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>; </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="built_in">strcpy</span>(m_ifreq.ifr_name,argv[<span class="number">1</span>]); </span><br><span class="line">    <span class="keyword">if</span>(ioctl(sock, SIOCGIFHWADDR, &amp;m_ifreq) &lt; <span class="number">0</span>) &#123; </span><br><span class="line">        perror(<span class="string">"ioctl"</span>); </span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="built_in">printf</span>( <span class="string">"%02x:%02x:%02x:%02x:%02x:%02x\n"</span>, </span><br><span class="line">            (<span class="keyword">unsigned</span> <span class="keyword">char</span>)m_ifreq.ifr_hwaddr.sa_data[<span class="number">0</span>], </span><br><span class="line">            (<span class="keyword">unsigned</span> <span class="keyword">char</span>)m_ifreq.ifr_hwaddr.sa_data[<span class="number">1</span>], </span><br><span class="line">            (<span class="keyword">unsigned</span> <span class="keyword">char</span>)m_ifreq.ifr_hwaddr.sa_data[<span class="number">2</span>], </span><br><span class="line">            (<span class="keyword">unsigned</span> <span class="keyword">char</span>)m_ifreq.ifr_hwaddr.sa_data[<span class="number">3</span>], </span><br><span class="line">            (<span class="keyword">unsigned</span> <span class="keyword">char</span>)m_ifreq.ifr_hwaddr.sa_data[<span class="number">4</span>], </span><br><span class="line">            (<span class="keyword">unsigned</span> <span class="keyword">char</span>)m_ifreq.ifr_hwaddr.sa_data[<span class="number">5</span>]); </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·å¾—macåœ°å€çš„æ ¸å¿ƒä»£ç ä¸ºï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sock=socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">ioctl(sock, SIOCGIFHWADDR, &amp;m_ifreq);</span><br></pre></td></tr></table></figure><p>è·å–åˆ°çš„macåœ°å€æ”¾åœ¨ç»“æ„ä½“<code>m_ifreq.ifr_hwaddr.sa_data</code>ä¸­ã€‚</p><h2 id="QNXå¹³å°è·å–macçš„æ–¹æ³•"><a href="#QNXå¹³å°è·å–macçš„æ–¹æ³•" class="headerlink" title="QNXå¹³å°è·å–macçš„æ–¹æ³•"></a>QNXå¹³å°è·å–macçš„æ–¹æ³•</h2><p>åœ¨QNXå¹³å°ä¸­ï¼Œ<code>net/if.h</code>ä¸linuxä¸‹ä¸åŒï¼Œ<code>ifreq</code>ç»“æ„ä½“çš„å®šä¹‰ä¸­ä¸å­˜åœ¨<code>ifr_hwaddr</code>çš„æˆå‘˜ï¼Œæˆ‘ä¼°è®¡<code>ioctl</code>çš„å®ç°æ–¹å¼ä¹Ÿä¸åŒï¼Œå› æ­¤ä¸Šè¿°æ–¹æ³•ä¸èƒ½ä½¿ç”¨ã€‚</p><p>è¿™æ—¶åº”è¯¥è½¬è€Œä½¿ç”¨<code>ifaddrs.h</code>ä¸­çš„æ–¹æ³•ï¼š<code>getifaddrs</code>ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ifaddrs.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __linux__</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netpacket/packet.h&gt;</span></span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;net/ethernet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;net/if_dl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">listmacaddrs</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ifaddrs</span> *<span class="title">ifap</span>, *<span class="title">ifaptr</span>;</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> *ptr;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (getifaddrs(&amp;ifap) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span>(ifaptr = ifap; ifaptr != <span class="literal">NULL</span>; ifaptr = (ifaptr)-&gt;ifa_next) &#123;</span><br><span class="line">            <span class="meta">#<span class="meta-keyword">ifdef</span> __linux__</span></span><br><span class="line">                <span class="keyword">char</span> macp[INET6_ADDRSTRLEN];</span><br><span class="line">                <span class="keyword">if</span> (((ifaptr)-&gt;ifa_addr)-&gt;sa_family == AF_PACKET) &#123;</span><br><span class="line">                    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_ll</span> *<span class="title">s</span> = (<span class="title">struct</span> <span class="title">sockaddr_ll</span>*)(<span class="title">ifaptr</span>-&gt;<span class="title">ifa_addr</span>);</span></span><br><span class="line">                    <span class="keyword">int</span> i;</span><br><span class="line">                    <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">                        len += <span class="built_in">sprintf</span>(macp+len, <span class="string">"%02X%s"</span>, s-&gt;sll_addr[i], i &lt; <span class="number">5</span> ? <span class="string">":"</span>:<span class="string">""</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"%s: %s\n"</span>, (ifaptr)-&gt;ifa_name, macp);</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">            <span class="keyword">if</span> (((ifaptr)-&gt;ifa_addr)-&gt;sa_family == AF_LINK) &#123;</span><br><span class="line">                ptr = (<span class="keyword">unsigned</span> <span class="keyword">char</span> *)LLADDR((struct sockaddr_dl *)(ifaptr)-&gt;ifa_addr);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%s: %02x:%02x:%02x:%02x:%02x:%02x\n"</span>,</span><br><span class="line">                                    (ifaptr)-&gt;ifa_name,</span><br><span class="line">                                    *ptr, *(ptr+<span class="number">1</span>), *(ptr+<span class="number">2</span>), *(ptr+<span class="number">3</span>), *(ptr+<span class="number">4</span>), *(ptr+<span class="number">5</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">        &#125;</span><br><span class="line">        freeifaddrs(ifap);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>getifaddrs(&amp;ifap)</code>å°†macåœ°å€ä¸ipåœ°å€åŒæ—¶æ”¾åˆ°<code>ifap</code>ç»“æ„ä½“ä¸­ï¼Œè¯¥ç»“æ„ä½“çš„ç±»å‹ä¸º<code>ifaddrs</code>ã€‚</p><p>å…¶æ ¸å¿ƒä»£ç ä¸ºï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ifaddrs</span> *<span class="title">ifap</span>,  *<span class="title">ifaptr</span>;</span></span><br><span class="line">getifaddrs(&amp;ifap);</span><br><span class="line"><span class="keyword">for</span>(ifaptr = ifap; ifaptr != <span class="literal">NULL</span>; ifaptr = (ifaptr)-&gt;ifa_next) &#123;</span><br><span class="line">ptr = (<span class="keyword">unsigned</span> <span class="keyword">char</span> *)LLADDR((struct sockaddr_dl *)(ifaptr)-&gt;ifa_addr);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s: %02x:%02x:%02x:%02x:%02x:%02x\n"</span>, (ifaptr)-&gt;ifa_name, *ptr, *(ptr+<span class="number">1</span>), *(ptr+<span class="number">2</span>), *(ptr+<span class="number">3</span>), *(ptr+<span class="number">4</span>), *(ptr+<span class="number">5</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>ifaddrs::ifa_name</code>ä¸ºç½‘å¡åï¼Œ<code>ifaddrs::ifa_addr</code>ä¸­å­˜æ”¾macåœ°å€ã€‚</p><p>é€šè¿‡<code>getnameinfo</code>å¯è·å¾—ipåœ°å€ï¼Œipåœ°å€åœ¨<code>host</code>ä¸­ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s = getnameinfo(ifa-&gt;ifa_addr, (family == AF_INET)?<span class="keyword">sizeof</span>(struct sockaddr_in):<span class="keyword">sizeof</span>(struct sockaddr_in6), host, NI_MAXHOST, <span class="literal">NULL</span>, <span class="number">0</span>, NUMERICHOST);</span><br></pre></td></tr></table></figure><p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ifaddrs.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ifaddrs</span> *<span class="title">ifaddr</span>, *<span class="title">ifa</span>;</span></span><br><span class="line">    <span class="keyword">int</span> family, s;</span><br><span class="line">    <span class="keyword">char</span> host[NI_MAXHOST];</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (getifaddrs(&amp;ifaddr) == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">"getifaddrs"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/* Walk through linked list, maintaining head pointer so we</span></span><br><span class="line"><span class="comment">     *               can free list later */</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> (ifa = ifaddr; ifa != <span class="literal">NULL</span>; ifa = ifa-&gt;ifa_next) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ifa-&gt;ifa_addr == <span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"> </span><br><span class="line">        family = ifa-&gt;ifa_addr-&gt;sa_family;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">/* Display interface name and family (including symbolic</span></span><br><span class="line"><span class="comment">         *                   form of the latter for the common families) */</span></span><br><span class="line"> </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%s  address family: %d%s\n"</span>,</span><br><span class="line">                ifa-&gt;ifa_name, family,</span><br><span class="line">                (family == AF_PACKET) ? <span class="string">" (AF_PACKET)"</span> :</span><br><span class="line">                (family == AF_INET) ?   <span class="string">" (AF_INET)"</span> :</span><br><span class="line">                (family == AF_INET6) ?  <span class="string">" (AF_INET6)"</span> : <span class="string">""</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">/* For an AF_INET* interface address, display the address */</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (family == AF_INET || family == AF_INET6) &#123;</span><br><span class="line">            s = getnameinfo(ifa-&gt;ifa_addr,</span><br><span class="line">                    (family == AF_INET) ? <span class="keyword">sizeof</span>(struct sockaddr_in) :</span><br><span class="line">                    <span class="keyword">sizeof</span>(struct sockaddr_in6),</span><br><span class="line">                    host, NI_MAXHOST, <span class="literal">NULL</span>, <span class="number">0</span>, NI_NUMERICHOST);</span><br><span class="line">            <span class="keyword">if</span> (s != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"getnameinfo() failed: %s\n"</span>, gai_strerror(s));</span><br><span class="line">                <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"\taddress: &lt;%s&gt;\n"</span>, host);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    freeifaddrs(ifaddr);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¿…é¡»è¦æ³¨æ„çš„æ˜¯<code>getifaddrs</code>çš„è°ƒç”¨å¿…é¡»ä¸<code>freeifaddrs</code>æˆå¯¹å‡ºç°ï¼Œå¦‚æœä¸è¿›è¡Œå†…å­˜é‡Šæ”¾ï¼Œä¼šé€ æˆå†…å­˜æ³„æ¼</strong></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><em>Linxuçš„struct ifaddrsä¸getifaddrs()å‡½æ•°ï¼š<a href="https://blog.csdn.net/g457499940/article/details/13630549" target="_blank" rel="noopener">https://blog.csdn.net/g457499940/article/details/13630549</a></em><br><em>æ€ä¹ˆå¾—åˆ°å¸¦æœ‰getifaddrsçš„macåœ°å€ï¼Ÿï¼š<a href="https://cloud.tencent.com/developer/ask/148099" target="_blank" rel="noopener">https://cloud.tencent.com/developer/ask/148099</a></em><br><em>Linuxä¸‹çš„ioctl()å‡½æ•°è¯¦è§£ï¼š<a href="https://www.cnblogs.com/tdyizhen1314/p/4896689.html" target="_blank" rel="noopener">https://www.cnblogs.com/tdyizhen1314/p/4896689.html</a></em></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Linuxå¹³å°è·å–IPåœ°å€&quot;&gt;&lt;a href=&quot;#Linuxå¹³å°è·å–IPåœ°å€&quot; class=&quot;headerlink&quot; title=&quot;Linuxå¹³å°è·å–IPåœ°å€&quot;&gt;&lt;/a&gt;Linuxå¹³å°è·å–IPåœ°å€&lt;/h2&gt;&lt;p&gt;é¦–å…ˆæ˜¯ä½¿ç”¨&lt;code&gt;ioctl&lt;/code&gt;è·å–I
      
    
    </summary>
    
      <category term="ç¬”è®°" scheme="http://yoursite.com/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
      <category term="QNX" scheme="http://yoursite.com/tags/QNX/"/>
    
      <category term="ç½‘ç»œ" scheme="http://yoursite.com/tags/%E7%BD%91%E7%BB%9C/"/>
    
  </entry>
  
  <entry>
    <title>å†…å­˜æ³„éœ²æ£€æµ‹--mtraceçš„ä½¿ç”¨</title>
    <link href="http://yoursite.com/2018/09/30/%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E6%A3%80%E6%B5%8B/"/>
    <id>http://yoursite.com/2018/09/30/å†…å­˜æ³„éœ²æ£€æµ‹/</id>
    <published>2018-09-30T15:00:00.000Z</published>
    <updated>2020-05-10T07:10:31.138Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»£ç é…ç½®"><a href="#ä»£ç é…ç½®" class="headerlink" title="ä»£ç é…ç½®"></a>ä»£ç é…ç½®</h2><p>é¦–å…ˆæ£€æµ‹å•ä¸€æ–‡ä»¶çš„å†…å­˜æ³„æ¼ã€‚</p><p>æœ‰ä»¥ä¸‹ç¨‹åºï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;mcheck.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    setenv(<span class="string">"MALLOC_TRACE"</span>, <span class="string">"mem.log"</span>, <span class="number">1</span>);</span><br><span class="line">    mtrace();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">0</span> != cnt--) &#123;</span><br><span class="line">    <span class="keyword">int</span> *p = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="number">2</span> * <span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">        usleep(<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"over\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­<code>mtrace()</code>ä¾èµ–äºå¤´æ–‡ä»¶<code>mcheck.h</code>ï¼Œå…¶åªèƒ½æ£€æµ‹ä½¿ç”¨glibcçš„å†…å­˜åˆ†é…å‡½æ•°åˆ†é…çš„å†…å­˜ï¼Œä¹Ÿå°±æ˜¯<code>malloc()</code>ç­‰å†…å­˜åˆ†é…å‡½æ•°ï¼Œè€Œä¸æ”¯æŒC++ä¸­çš„<code>new</code>æ“ä½œç¬¦ã€‚<br><code>usleep()</code>ä¾èµ–å¤´æ–‡ä»¶<code>unistd.h</code>ï¼Œå…¶ä¼‘çœ 1usã€‚</p><p>éœ€è¦<code>export MALLOC_TRACE=mem.log</code>æ¥æŒ‡å®šå·¥ä½œè·¯å¾„ï¼Œä»è€ŒæŒ‡å®šç”Ÿæˆçš„logã€‚<br>æˆ–è€…è°ƒç”¨<code>setenv(&quot;MALLOC_TRACE&quot;, &quot;mem.log&quot;, 1);</code>ã€‚ä¾èµ–äºå¤´æ–‡ä»¶<code>stdlib.h</code>ã€‚</p><p>ä½¿ç”¨å¦‚ä¸‹makeæ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œé‡ç‚¹åœ¨äºå¿…é¡»åŠ <code>-g</code>ï¼Œç¼–è¯‘ä¼˜åŒ–é€‰é¡¹å¿…é¡»ä¸º<code>-O0</code>ï¼ˆæˆ–è€…é»˜è®¤ï¼‰ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">test : test.o</span><br><span class="line">gcc -o <span class="variable">$@</span> <span class="variable">$^</span></span><br><span class="line"></span><br><span class="line">test.o : test.cpp</span><br><span class="line">gcc -c -O0 <span class="variable">$^</span> -g</span><br></pre></td></tr></table></figure></p><h2 id="æŸ¥çœ‹log"><a href="#æŸ¥çœ‹log" class="headerlink" title="æŸ¥çœ‹log"></a>æŸ¥çœ‹log</h2><p>ä»£ç è¿è¡Œåç”Ÿæˆlogï¼Œä½¿ç”¨å‘½ä»¤<code>mtrace progname logname</code>è¿›è¡ŒlogæŸ¥çœ‹ã€‚<br>å…¶ä¸­<code>progname</code>ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶åï¼Œ<code>logname</code>ä¸ºlogçš„æ–‡ä»¶åã€‚<br>å¦‚æœæ²¡æœ‰å†…å­˜æ³„æ¼ä¼šæŠ¥<code>No memory leaks.</code>ã€‚è€Œä¸Šè¿°ç¨‹åºçš„è¾“å‡ºç»“æœä¸ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Memory not freed:</span><br><span class="line">-----------------</span><br><span class="line">           Address     Size     Caller</span><br><span class="line">0x00000000023be6a0      0x8  at /home/zyliu12/Documents/memoryleak/onefile/test.cpp:12</span><br><span class="line">0x00000000023be6c0      0x8  at /home/zyliu12/Documents/memoryleak/onefile/test.cpp:12</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p><p>ä»è€Œå°†æ‰€æœ‰å·²<code>malloc</code>è€Œæœª<code>free</code>çš„å†…å­˜çš„<code>malloc</code>å¤„æ‰“å°å‡ºæ¥ã€‚</p><h2 id="ç¼–è¯‘ç”Ÿæˆåº“æ–‡ä»¶"><a href="#ç¼–è¯‘ç”Ÿæˆåº“æ–‡ä»¶" class="headerlink" title="ç¼–è¯‘ç”Ÿæˆåº“æ–‡ä»¶"></a>ç¼–è¯‘ç”Ÿæˆåº“æ–‡ä»¶</h2><p>é¦–å…ˆå°†å†…å­˜æ³„éœ²çš„å‡½æ•°è½¬ç§»åˆ°å¦ä¸€ä¸ªæ–‡ä»¶<code>fun.cpp</code>ä¸­ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"fun.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">memleak</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">0</span> != cnt--) &#123;</span><br><span class="line">    <span class="keyword">int</span> *p = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="number">2</span> * <span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">        usleep(<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> *p2 = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="number">40</span> * <span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨<code>main.cpp</code>ä¸­è°ƒç”¨è¯¥å‡½æ•°ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;mcheck.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"fun.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    setenv(<span class="string">"MALLOC_TRACE"</span>, <span class="string">"taoge.log"</span>, <span class="number">1</span>);</span><br><span class="line">    mtrace();</span><br><span class="line">    memleak();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"over\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™æ ·<code>mtrace()</code>ä¸å†…å­˜æ³„æ¼çš„å‡½æ•°ä¸åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹èƒ½å¦æ£€æµ‹å‡ºå†…å­˜æ³„æ¼çš„ä½ç½®ã€‚</p><p>ä¸€æ­¥ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶çš„makefileä¸ºï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">TARGET := test</span><br><span class="line">SRC_CXX := fun.cpp main.cpp</span><br><span class="line"></span><br><span class="line">all : clean <span class="variable">$(TARGET)</span></span><br><span class="line"></span><br><span class="line">clean :</span><br><span class="line">-@rm -rf *.o *.gch <span class="variable">$(TARGET)</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(TARGET)</span> : <span class="variable">$(SRC_CXX)</span></span><br><span class="line">gcc -o <span class="variable">$@</span> <span class="variable">$^</span> -g</span><br></pre></td></tr></table></figure><p>è¿è¡Œ<code>test</code>å¹¶ä½¿ç”¨å‘½ä»¤<code>mtrace test taoge.log</code>çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Memory not freed:</span><br><span class="line">-----------------</span><br><span class="line">           Address     Size     Caller</span><br><span class="line">0x000000000098e6a0      0x8  at /home/zyliu12/Documents/memoryleak/staticlib/fun.cpp:9</span><br><span class="line">...</span><br><span class="line">0x000000000098f320     0xa0  at /home/zyliu12/Documents/memoryleak/staticlib/fun.cpp:12</span><br></pre></td></tr></table></figure></p><p>æ­¤æ—¶èƒ½å¤Ÿæ­£å¸¸åˆ¤æ–­å†…å­˜æ³„éœ²ã€‚</p><p>ä½¿ç”¨ä»¥ä¸‹makeæ–‡ä»¶å…ˆå°†<code>fun.cpp</code>ç”Ÿæˆä¸ºåŠ¨æ€åº“soæ–‡ä»¶ã€‚</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">TARGET := test</span><br><span class="line">SRC_CXX := main.cpp</span><br><span class="line">SHARED := libfun.so</span><br><span class="line"></span><br><span class="line">all : clean <span class="variable">$(SHARED)</span> <span class="variable">$(TARGET)</span></span><br><span class="line"></span><br><span class="line">clean :</span><br><span class="line">-@rm -rf *.o *.gch <span class="variable">$(TARGET)</span> <span class="variable">$(SHARED)</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(SHARED)</span> : fun.cpp</span><br><span class="line">gcc -g <span class="variable">$^</span> -fPIC -shared -Wl,-soname,<span class="variable">$(SHARED)</span> -o <span class="variable">$(SHARED)</span> -lc</span><br><span class="line"></span><br><span class="line"><span class="variable">$(TARGET)</span> : <span class="variable">$(SRC_CXX)</span></span><br><span class="line">gcc -o <span class="variable">$@</span> <span class="variable">$^</span> -g -L. -lfun</span><br></pre></td></tr></table></figure><p>åœ¨æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ä¹‹å‰ï¼Œéœ€è¦å…ˆè®¾ç½®å·¥ä½œè·¯å¾„ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=<span class="variable">$&#123;pwd&#125;</span>:<span class="variable">$&#123;LD_LIBRARY_PATH&#125;</span></span><br></pre></td></tr></table></figure><p>è¿è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ç”Ÿæˆlogï¼Œä½¿ç”¨å‘½ä»¤<code>mtrace test taoge.log</code>çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000b466a0    0x400  at 0x7fd589037185</span><br><span class="line">...</span><br><span class="line">0x0000000000b47690      0x8  at 0x7fd58939377a</span><br><span class="line">0x0000000000b476b0      0x8  at 0x7fd58939377a</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°åªæœ‰åœ°å€è€Œæ²¡æœ‰ä»£ç è¡Œå·ã€‚</p><h2 id="å®šä½å†…å­˜æ³„æ¼è¡Œå·"><a href="#å®šä½å†…å­˜æ³„æ¼è¡Œå·" class="headerlink" title="å®šä½å†…å­˜æ³„æ¼è¡Œå·"></a>å®šä½å†…å­˜æ³„æ¼è¡Œå·</h2><p>ä¸»è¦æ˜¯é€šè¿‡<code>addr2line</code>ç”±åœ°å€å®šä½åˆ°è¡Œå·ã€‚</p><p>ä¸ºäº†å¾—åˆ°åŠ è½½åº“çš„åœ°å€ï¼Œé¦–å…ˆåœ¨ä»£ç ä¸­æ·»åŠ ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"pid=%d\n"</span>, getpid());</span><br></pre></td></tr></table></figure></p><p>è¿™è¡Œä»£ç å¯ç”¨äºè·å¾—ç¨‹åºçš„pidã€‚åœ¨è·å¾—ç¨‹åºpidä¹‹åï¼Œå‡è®¾pidä¸º7954ï¼Œè¿›å…¥<code>/proc</code>ç›®å½•ï¼Œæ‰§è¡ŒæŒ‡ä»¤<code>cat 7954/maps</code>ã€‚å…¶è¾“å‡ºå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">00400000-00401000 r-xp 00000000 08:01 404531                             /home/zyliu12/Documents/memoryleak/staticlib/test</span><br><span class="line">00600000-00601000 r--p 00000000 08:01 404531                             /home/zyliu12/Documents/memoryleak/staticlib/test</span><br><span class="line">00601000-00602000 rw-p 00001000 08:01 404531                             /home/zyliu12/Documents/memoryleak/staticlib/test</span><br><span class="line">017b2000-017d3000 rw-p 00000000 00:00 0                                  [heap]</span><br><span class="line">7fb30a05e000-7fb30a21e000 r-xp 00000000 08:01 660718                     /lib/x86_64-linux-gnu/libc-2.23.so</span><br><span class="line">7fb30a21e000-7fb30a41d000 ---p 001c0000 08:01 660718                     /lib/x86_64-linux-gnu/libc-2.23.so</span><br><span class="line">7fb30a41d000-7fb30a421000 r--p 001bf000 08:01 660718                     /lib/x86_64-linux-gnu/libc-2.23.so</span><br><span class="line">7fb30a421000-7fb30a423000 rw-p 001c3000 08:01 660718                     /lib/x86_64-linux-gnu/libc-2.23.so</span><br><span class="line">7fb30a423000-7fb30a427000 rw-p 00000000 00:00 0 </span><br><span class="line">7fb30a427000-7fb30a428000 r-xp 00000000 08:01 404409                     /home/zyliu12/Documents/memoryleak/staticlib/libfun.so</span><br><span class="line">7fb30a428000-7fb30a627000 ---p 00001000 08:01 404409                     /home/zyliu12/Documents/memoryleak/staticlib/libfun.so</span><br><span class="line">7fb30a627000-7fb30a628000 r--p 00000000 08:01 404409                     /home/zyliu12/Documents/memoryleak/staticlib/libfun.so</span><br><span class="line">7fb30a628000-7fb30a629000 rw-p 00001000 08:01 404409                     /home/zyliu12/Documents/memoryleak/staticlib/libfun.so</span><br><span class="line">7fb30a629000-7fb30a64f000 r-xp 00000000 08:01 660690                     /lib/x86_64-linux-gnu/ld-2.23.so</span><br><span class="line">7fb30a833000-7fb30a836000 rw-p 00000000 00:00 0 </span><br><span class="line">7fb30a84c000-7fb30a84e000 rw-p 00000000 00:00 0 </span><br><span class="line">7fb30a84e000-7fb30a84f000 r--p 00025000 08:01 660690                     /lib/x86_64-linux-gnu/ld-2.23.so</span><br><span class="line">7fb30a84f000-7fb30a850000 rw-p 00026000 08:01 660690                     /lib/x86_64-linux-gnu/ld-2.23.so</span><br><span class="line">7fb30a850000-7fb30a851000 rw-p 00000000 00:00 0 </span><br><span class="line">7ffd7c1e6000-7ffd7c207000 rw-p 00000000 00:00 0                          [stack]</span><br><span class="line">7ffd7c23b000-7ffd7c23d000 r--p 00000000 00:00 0                          [vvar]</span><br><span class="line">7ffd7c23d000-7ffd7c23f000 r-xp 00000000 00:00 0                          [vdso]</span><br><span class="line">ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°<code>libfun.so</code>çš„åŠ è½½åœ°å€ä»¥<code>7fb30a427000</code>å¼€å§‹ã€‚<br>å†æ¬¡æŸ¥çœ‹<code>mtrace test taoge.log</code>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x00000000017b26a0      0x8  at 0x7fb30a42771e</span><br></pre></td></tr></table></figure></p><p><code>0x7fb30a42771e - 0x7fb30a427000</code>å¯å¾—<code>0x00000000071e</code>ï¼Œè¿™å°±æ˜¯å‡ºé”™ä»£ç åœ¨<code>libfun.so</code>ä¸­çš„ç›¸å¯¹ä½ç½®ã€‚<br>æ‰§è¡ŒæŒ‡ä»¤<code>addr2line -e ./libfun.so 0x00000000071e</code>ï¼Œå¯å¾—å‡ºé”™ä»£ç è¡Œå·ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home/zyliu12/Documents/memoryleak/staticlib/fun.cpp:10</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ä»£ç é…ç½®&quot;&gt;&lt;a href=&quot;#ä»£ç é…ç½®&quot; class=&quot;headerlink&quot; title=&quot;ä»£ç é…ç½®&quot;&gt;&lt;/a&gt;ä»£ç é…ç½®&lt;/h2&gt;&lt;p&gt;é¦–å…ˆæ£€æµ‹å•ä¸€æ–‡ä»¶çš„å†…å­˜æ³„æ¼ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä»¥ä¸‹ç¨‹åºï¼š&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;
      
    
    </summary>
    
      <category term="ç¬”è®°" scheme="http://yoursite.com/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
      <category term="å†…å­˜æ³„éœ²" scheme="http://yoursite.com/tags/%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2/"/>
    
  </entry>
  
  <entry>
    <title>Core Fileçš„ç”Ÿæˆå’ŒæŸ¥çœ‹</title>
    <link href="http://yoursite.com/2018/09/25/Core%20File%E7%9A%84%E7%94%9F%E6%88%90%E4%B8%8E%E6%9F%A5%E7%9C%8B/"/>
    <id>http://yoursite.com/2018/09/25/Core Fileçš„ç”Ÿæˆä¸æŸ¥çœ‹/</id>
    <published>2018-09-25T15:00:00.000Z</published>
    <updated>2020-05-10T07:06:16.972Z</updated>
    
    <content type="html"><![CDATA[<h2 id="coredumpé…ç½®"><a href="#coredumpé…ç½®" class="headerlink" title="coredumpé…ç½®"></a>coredumpé…ç½®</h2><h3 id="å¼€å¯coredumpåŠŸèƒ½"><a href="#å¼€å¯coredumpåŠŸèƒ½" class="headerlink" title="å¼€å¯coredumpåŠŸèƒ½"></a>å¼€å¯coredumpåŠŸèƒ½</h3><p>è¾“å…¥å‘½ä»¤<code>ulimit</code>ï¼Œå…¶è¾“å‡ºä»£è¡¨ç”Ÿæˆçš„coreæ–‡ä»¶å¤§å°çš„é™åˆ¶ï¼Œå¦‚æœè¾“å‡ºä¸º0ï¼Œåˆ™è¯´æ˜coredumpåŠŸèƒ½æ²¡æœ‰å¼€å¯ã€‚</p><p>ä½¿ç”¨å‘½ä»¤<code>ulimit -c unlimited</code>å¼€å¯coredumpåŠŸèƒ½ï¼Œå¹¶ä¸”ä¸é™åˆ¶coreæ–‡ä»¶çš„å¤§å°ã€‚</p><p>å¦‚æœè¦é™åˆ¶coreæ–‡ä»¶çš„å¤§å°ï¼Œåˆ™å°†unlimitedæ›¿æ¢ä¸ºè¦é™åˆ¶çš„coreæ–‡ä»¶çš„å¤§å°ï¼Œå•ä½ä¸ºblockï¼ˆKBï¼‰ã€‚</p><h3 id="Coreæ–‡ä»¶çš„ä¿å­˜è·¯å¾„"><a href="#Coreæ–‡ä»¶çš„ä¿å­˜è·¯å¾„" class="headerlink" title="Coreæ–‡ä»¶çš„ä¿å­˜è·¯å¾„"></a>Coreæ–‡ä»¶çš„ä¿å­˜è·¯å¾„</h3><p>coreæ–‡ä»¶çš„ç”Ÿæˆä½ç½®ç”±<code>/proc/sys/kernel/core_pattern</code>ä¸­çš„é…ç½®å†³å®šã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå…¶å†…å®¹ä¸º<code>cor</code>ï¼Œç¨‹åºå‡ºé”™æ—¶å°†åœ¨å·¥ä½œç›®å½•ç”Ÿæˆåä¸ºcoreçš„coreæ–‡ä»¶ã€‚ï¼ˆæ­¤å¤„ä¸ç¡®å®šï¼‰<br>å¯ä»¥å°†é…ç½®æ–‡ä»¶å†…å®¹æ”¹ä¸º<code>/home/ubuntu/sdcard/CoreDump/core-%e-%p-%t</code>ï¼Œåˆ™coreæ–‡ä»¶ç”Ÿæˆåœ¨ç›®å½•/home/ubuntu/sdcard/CoreDumpï¼Œæ–‡ä»¶åçš„æ ¼å¼ä¸ºcore-å‘½ä»¤å-pid-æ—¶é—´æˆ³ã€‚</p><p>ä¿®æ”¹é…ç½®æ–‡ä»¶æ—¶ä¸èƒ½ç›´æ¥ç”¨ç¼–è¾‘å™¨ç¼–è¾‘<code>/proc/sys/kernel/core_pattern</code>ã€‚éœ€è¦å…ˆç”¨suå‘½ä»¤åˆ‡æ¢ä¸ºrootç”¨æˆ·ï¼Œç„¶åä½¿ç”¨å‘½ä»¤ç¼–è¾‘æ–‡ä»¶ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> /home/coredump/corename &gt; /proc/sys/kernel/core_pattern</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°å‘½ä»¤å°†coreæ–‡ä»¶ç”Ÿæˆåœ¨/home/coredump/ç›®å½•ä¸‹ã€‚</p><p>coreæ–‡ä»¶çš„å‘½åè§„åˆ™ï¼š<br>%p - pid<br>%u - uid<br>%g - å½“å‰gid<br>%s - å¯¼è‡´äº§ç”Ÿcoreçš„ä¿¡å·<br>%t - coreæ–‡ä»¶ç”Ÿæˆçš„unixæ—¶é—´<br>%h - ä¸»æœºå<br>%e - å‘½ä»¤å<br>è‹¥è¦å°†coreæ–‡ä»¶ç”Ÿæˆä½ç½®æ¢å¤ä¸ºé»˜è®¤ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> core &gt; /proc/sys/kernel/core_pattern</span><br></pre></td></tr></table></figure><h2 id="coreæ–‡ä»¶çš„è¯»å–"><a href="#coreæ–‡ä»¶çš„è¯»å–" class="headerlink" title="coreæ–‡ä»¶çš„è¯»å–"></a>coreæ–‡ä»¶çš„è¯»å–</h2><p>æœ‰äº†coreæ–‡ä»¶ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨GDBæ¥è¿›è¡Œè°ƒè¯•ã€‚</p><p>è°ƒè¯•æ–¹å¼ä¸ºä½¿ç”¨å‘½ä»¤ï¼š<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gdb program core</span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­programä¸ºç”Ÿæˆcoreæ–‡ä»¶çš„å¯¹åº”ç¨‹åºåï¼Œcoreä¸ºcoreæ–‡ä»¶åã€‚<br>ä¾‹å¦‚ï¼Œç°æœ‰test.cå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> *p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = *p;</span><br><span class="line">    <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> *p = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> func(p);</span><br><span class="line">&#125;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">ä½¿ç”¨gccç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶testï¼š</span><br><span class="line">```sh</span><br><span class="line">gcc â€“o test test.c â€“g</span><br></pre></td></tr></table></figure><p>è¿è¡Œtestï¼Œç”Ÿæˆcoreæ–‡ä»¶ï¼Œä»¥é»˜è®¤è®¾ç½®ä¸ºä¾‹ï¼Œåˆ™coreç”Ÿæˆåœ¨å½“å‰ç›®å½•ã€‚<br>ä½¿ç”¨å‘½ä»¤<code>gdb test core</code>ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">Core was generated by &apos;./test&apos;.</span><br><span class="line">Program terminated with signal 11, Segmentation fault.</span><br><span class="line">#0  0x080483cd in func (p=0x0) at test.c:5</span><br><span class="line">5       int y = *p;</span><br><span class="line"></span><br><span class="line">(gdb)  where</span><br><span class="line">#0  0x080483cd in func (p=0x0) at core_demo.c:5</span><br><span class="line">#1  0x080483ef in main () at core_demo.c:12</span><br><span class="line">(gdb) info frame</span><br><span class="line">Stack level 0, frame at 0xffd590a4:</span><br><span class="line"> eip = 0x80483cd in func (test.c:5); saved eip 0x80483ef</span><br><span class="line"> called by frame at 0xffd590c0</span><br><span class="line"> source language c.</span><br><span class="line"> Arglist at 0xffd5909c, args: p=0x0</span><br><span class="line"> Locals at 0xffd5909c, Previous frame&apos;s sp is 0xffd590a4</span><br><span class="line"> Saved registers:</span><br><span class="line">  ebp at 0xffd5909c, eip at 0xffd590a0</span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç¨‹åºé”™è¯¯çš„åŸå› åœ¨æœ€åä¸¤è¡Œæ˜¾ç¤ºã€‚å¯ä»¥ä½¿ç”¨whereå‘½ä»¤å†æ¬¡æ˜¾ç¤ºç¨‹åºå´©æºƒåŸå› ã€‚</p><p>å‚è€ƒèµ„æ–™ï¼š<br><a href="http://www.cnblogs.com/hazir/p/linxu_core_dump.html" target="_blank" rel="noopener">http://www.cnblogs.com/hazir/p/linxu_core_dump.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;coredumpé…ç½®&quot;&gt;&lt;a href=&quot;#coredumpé…ç½®&quot; class=&quot;headerlink&quot; title=&quot;coredumpé…ç½®&quot;&gt;&lt;/a&gt;coredumpé…ç½®&lt;/h2&gt;&lt;h3 id=&quot;å¼€å¯coredumpåŠŸèƒ½&quot;&gt;&lt;a href=&quot;#å¼€å¯coredum
      
    
    </summary>
    
      <category term="ç¬”è®°" scheme="http://yoursite.com/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="GDB" scheme="http://yoursite.com/tags/GDB/"/>
    
      <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>å¤´æ–‡ä»¶åŒ…å«ä»¥åŠåº“æ–‡ä»¶åŒ…å«</title>
    <link href="http://yoursite.com/2018/08/31/%E5%A4%B4%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%BB%A5%E5%8F%8A%E5%BA%93%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <id>http://yoursite.com/2018/08/31/å¤´æ–‡ä»¶åŒ…å«ä»¥åŠåº“æ–‡ä»¶åŒ…å«/</id>
    <published>2018-08-31T09:53:00.000Z</published>
    <updated>2020-05-10T07:13:25.810Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é˜²æ­¢é‡å¤åŒ…å«å¤´æ–‡ä»¶"><a href="#é˜²æ­¢é‡å¤åŒ…å«å¤´æ–‡ä»¶" class="headerlink" title="é˜²æ­¢é‡å¤åŒ…å«å¤´æ–‡ä»¶"></a>é˜²æ­¢é‡å¤åŒ…å«å¤´æ–‡ä»¶</h2><p>åœ¨å¤´æ–‡ä»¶ä¸­åŒ…å«å¤´æ–‡ä»¶å¸¸å¯¼è‡´é‡å¤å®šä¹‰çš„é—®é¢˜ã€‚Windowså¹³å°ä¸Šå¸¸å¸¸ä½¿ç”¨<code>#pragma once</code>çš„æ–¹å¼æ¥é˜²æ­¢é‡å¤å®šä¹‰ï¼Œä½†åœ¨è·¨å¹³å°é¡¹ç›®ä¸Šè¿™ä¹ˆåšå°±ä¸å¤ªé€‚ç”¨äº†ã€‚<br>å› æ­¤æˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨é¢„å®šä¹‰çš„æ–¹å¼æ¥é˜²æ­¢é‡å¤å®šä¹‰çš„é—®é¢˜ã€‚ä¹‹å‰æˆ‘åªæ˜¯çŸ¥é“æœ‰è¿™ä¹ˆå›äº‹ï¼Œä½†å¹¶ä¸çŸ¥é“æ˜¯å¦‚ä½•å®ç°çš„ï¼Œä¸‹é¢å¯¹å…¶è¿›è¡Œæ€»ç»“ã€‚<br>ä»¥æŸä¸ªå¤´æ–‡ä»¶<code>&quot;header.h&quot;</code>ä¸ºä¾‹ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="meta-keyword">ifndef</span> __HEADER_H__</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __HEADER_H__</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *header.h  body</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure></p><p>å¦‚æœè¯¥å¤´æ–‡ä»¶å·²è¢«åŒ…å«ï¼Œé‚£ä¹ˆå¤´æ–‡ä»¶ä¸­çš„å®šä¹‰ä¸ä¼šè¢«é‡å¤å®šä¹‰ã€‚</p><h2 id="åº“æ–‡ä»¶çš„åŒ…å«"><a href="#åº“æ–‡ä»¶çš„åŒ…å«" class="headerlink" title="åº“æ–‡ä»¶çš„åŒ…å«"></a>åº“æ–‡ä»¶çš„åŒ…å«</h2><p>åœ¨Windowsä¸­ï¼Œæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥åŒ…å«åº“æ–‡ä»¶ã€‚</p><p>ä¸€ç§æ˜¯åœ¨ä»£ç ä¸­æ·»åŠ ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib, <span class="meta-string">"libname.lib"</span>)</span></span><br></pre></td></tr></table></figure></p><p>å¦ä¸€ç§æ˜¯åœ¨<code>é¡¹ç›® - å±æ€§ - é…ç½®å±æ€§ - é“¾æ¥å™¨ - è¾“å…¥ - é™„åŠ ä¾èµ–é¡¹</code>ä¸­æ·»åŠ åº“æ–‡ä»¶ã€‚</p><p>å¦‚æœä¸Šè¿°ä¸¤ç§æ–¹å¼åªæ·»åŠ äº†æ–‡ä»¶åè€Œæ²¡æœ‰è·¯å¾„ï¼Œåˆ™éœ€è¦åœ¨<code>é¡¹ç›® - å±æ€§ - é…ç½®å±æ€§ - é“¾æ¥å™¨ - å¸¸è§„ - é™„åŠ åº“ç›®å½•</code>ä¸­æ·»åŠ åº“æ–‡ä»¶çš„è·¯å¾„ã€‚</p><p>åœ¨Linuxæ“ä½œç³»ç»Ÿä¸­ï¼Œä½¿ç”¨makefileæŒ‡å®šåŒ…å«çš„åº“æ–‡ä»¶ã€‚</p><p>æ¯”å¦‚éœ€è¦åŒ…å«GNUCåº“æ–‡ä»¶<code>librt.so</code>ï¼Œåœ¨makeæ—¶æŒ‡å®š<code>-lrt</code>å³å¯ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;é˜²æ­¢é‡å¤åŒ…å«å¤´æ–‡ä»¶&quot;&gt;&lt;a href=&quot;#é˜²æ­¢é‡å¤åŒ…å«å¤´æ–‡ä»¶&quot; class=&quot;headerlink&quot; title=&quot;é˜²æ­¢é‡å¤åŒ…å«å¤´æ–‡ä»¶&quot;&gt;&lt;/a&gt;é˜²æ­¢é‡å¤åŒ…å«å¤´æ–‡ä»¶&lt;/h2&gt;&lt;p&gt;åœ¨å¤´æ–‡ä»¶ä¸­åŒ…å«å¤´æ–‡ä»¶å¸¸å¯¼è‡´é‡å¤å®šä¹‰çš„é—®é¢˜ã€‚Windowså¹³å°ä¸Šå¸¸å¸¸ä½¿ç”¨&lt;code&gt;#
      
    
    </summary>
    
      <category term="è®°å½•" scheme="http://yoursite.com/categories/%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="C++" scheme="http://yoursite.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>ä»VSè½¬ç§»åˆ°VScodeï¼ˆç”±æœªæ‰¾åˆ°é¢„å®šä¹‰å¼•å‡ºçš„é—®é¢˜ï¼‰</title>
    <link href="http://yoursite.com/2018/08/24/%E4%BB%8EVS%E8%BD%AC%E7%A7%BB%E5%88%B0VScode%EF%BC%88%E7%94%B1%E6%9C%AA%E6%89%BE%E5%88%B0%E9%A2%84%E5%AE%9A%E4%B9%89%E5%BC%95%E5%87%BA%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%89/"/>
    <id>http://yoursite.com/2018/08/24/ä»VSè½¬ç§»åˆ°VScodeï¼ˆç”±æœªæ‰¾åˆ°é¢„å®šä¹‰å¼•å‡ºçš„é—®é¢˜ï¼‰/</id>
    <published>2018-08-23T16:40:00.000Z</published>
    <updated>2020-05-10T07:09:55.546Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä½œä¸ºä»£ç ç¼–è¾‘å™¨çš„VScode"><a href="#ä½œä¸ºä»£ç ç¼–è¾‘å™¨çš„VScode" class="headerlink" title="ä½œä¸ºä»£ç ç¼–è¾‘å™¨çš„VScode"></a>ä½œä¸ºä»£ç ç¼–è¾‘å™¨çš„VScode</h2><h3 id="é¢„å®šä¹‰"><a href="#é¢„å®šä¹‰" class="headerlink" title="é¢„å®šä¹‰"></a>é¢„å®šä¹‰</h3><p>ä»Šå¤©çœ‹åˆ°ä»£ç ä¸­æœ‰ä¸€å¤„ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">if</span> defined FF_LOG_ZZSR</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"../VACommon/log/sr_log.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">elif</span> defined FF_LOG_ZZHX</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"../VACommon/log/HX_log.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure></p><p>æœç´¢ç¼–æ•´ä¸ªå·¥ç¨‹å´æ²¡æœ‰æ‰¾åˆ°<code>FF_LOG_ZZHX</code>ï¼Œç„¶è€Œå…¶ä¸‹æ–¹çš„<code>#include</code>çš„ä»£ç å´ç”Ÿæ•ˆäº†ï¼Œå› æ­¤æ„Ÿåˆ°å¾ˆç–‘æƒ‘ã€‚</p><p>å®é™…ä¸Šæ˜¯åœ¨<code>å±æ€§ - é…ç½®å±æ€§ - C/C++ - é¢„å¤„ç†å™¨å®šä¹‰</code>ä¸­è¿›è¡Œäº†é¢„å¤„ç†å®šä¹‰ï¼Œè¿™æ ·åœ¨æ‰€æœ‰ä»£ç ä¸­éƒ½æœ‰äº†<code>FF_LOG_ZZHX</code>çš„é¢„å®šä¹‰ã€‚</p><p>å½“ä½¿ç”¨VSCodeæ‰“å¼€æºæ–‡ä»¶æ—¶ï¼Œéœ€è¦åœ¨<code>$WorkSpace$\.vscode\c_cpp_properties.json</code>ä¸­çš„<code>defines</code>é¡¹æ·»åŠ é¢„å®šä¹‰ã€‚</p><h3 id="åŒ…å«æ–‡ä»¶"><a href="#åŒ…å«æ–‡ä»¶" class="headerlink" title="åŒ…å«æ–‡ä»¶"></a>åŒ…å«æ–‡ä»¶</h3><p>åœ¨æ·»åŠ äº†é¢„å®šä¹‰ä¹‹åï¼Œå‘ç°ä»£ç ä»æœ‰é—®é¢˜ï¼Œ<code>DEBUG_TRACE_ERROR</code>ç­‰ä¾èµ–äº<code>VACommon/log/HX_log.h</code>çš„é¢„å®šä¹‰ä»ä¸èµ·ä½œç”¨ã€‚è¯•éªŒåå‘ç°è¿˜éœ€è¦æ·»åŠ åŒ…å«è·¯å¾„ã€‚æœ€ç»ˆçš„<code>c_cpp_properties.json</code>å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"configurations"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"Win32"</span>,</span><br><span class="line">            <span class="attr">"includePath"</span>: [</span><br><span class="line">                <span class="string">"$&#123;workspaceFolder&#125;/**"</span>,</span><br><span class="line">                <span class="string">"./../VACommon/**"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"defines"</span>: [</span><br><span class="line">                <span class="string">"_DEBUG"</span>,</span><br><span class="line">                <span class="string">"UNICODE"</span>,</span><br><span class="line">                <span class="string">"_UNICODE"</span>,</span><br><span class="line">                <span class="string">"ZZ_DLL_EXPORTS"</span>,</span><br><span class="line">                <span class="string">"WIN32"</span>,</span><br><span class="line">                <span class="string">"ZZ_EMNLU20_DEFINED"</span>,</span><br><span class="line">                <span class="string">"FF_LOG_ZZHX"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"intelliSenseMode"</span>: <span class="string">"msvc-x64"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"version"</span>: <span class="number">4</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¼–è¯‘é…ç½®"><a href="#ç¼–è¯‘é…ç½®" class="headerlink" title="ç¼–è¯‘é…ç½®"></a>ç¼–è¯‘é…ç½®</h2><p>æ­¤å¤–è¿˜æœ‰å¾ˆå¤šç¼–è¯‘ç›¸å…³çš„é…ç½®ï¼Œä»¥åŠmakefileçš„é…ç½®ï¼Œå°†åœ¨åé¢è¿›è¡Œè¡¥å……ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ä½œä¸ºä»£ç ç¼–è¾‘å™¨çš„VScode&quot;&gt;&lt;a href=&quot;#ä½œä¸ºä»£ç ç¼–è¾‘å™¨çš„VScode&quot; class=&quot;headerlink&quot; title=&quot;ä½œä¸ºä»£ç ç¼–è¾‘å™¨çš„VScode&quot;&gt;&lt;/a&gt;ä½œä¸ºä»£ç ç¼–è¾‘å™¨çš„VScode&lt;/h2&gt;&lt;h3 id=&quot;é¢„å®šä¹‰&quot;&gt;&lt;a href=&quot;#é¢„å®š
      
    
    </summary>
    
      <category term="è®°å½•" scheme="http://yoursite.com/categories/%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="C++" scheme="http://yoursite.com/tags/C/"/>
    
      <category term="ç¼–è¯‘" scheme="http://yoursite.com/tags/%E7%BC%96%E8%AF%91/"/>
    
      <category term="ç¼–è¾‘å™¨" scheme="http://yoursite.com/tags/%E7%BC%96%E8%BE%91%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>Makefileå­¦ä¹ ï¼ˆä¸‰ï¼‰</title>
    <link href="http://yoursite.com/2018/08/19/makefile(3)/"/>
    <id>http://yoursite.com/2018/08/19/makefile(3)/</id>
    <published>2018-08-19T15:00:00.000Z</published>
    <updated>2020-05-10T07:07:30.915Z</updated>
    
    <content type="html"><![CDATA[<h2 id="8-makeçš„è¿è¡Œ"><a href="#8-makeçš„è¿è¡Œ" class="headerlink" title="8 makeçš„è¿è¡Œ"></a>8 makeçš„è¿è¡Œ</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œæœ€ç®€å•çš„å°±æ˜¯ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸‹è¾“å…¥makeå‘½ä»¤ï¼Œmakeå‘½ä»¤ä¼šæ‰¾å½“å‰ç›®å½•çš„makefileæ¥æ‰§è¡Œï¼Œä¸€åˆ‡éƒ½æ˜¯è‡ªåŠ¨çš„ã€‚ä½†ä¹Ÿæœ‰æ—¶ä½ ä¹Ÿè®¸åªæƒ³è®©makeé‡ç¼–è¯‘æŸäº›æ–‡ä»¶ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå·¥ç¨‹ï¼Œè€Œåˆæœ‰çš„æ—¶å€™ä½ æœ‰å‡ å¥—ç¼–è¯‘è§„åˆ™ï¼Œä½ æƒ³åœ¨ä¸åŒçš„æ—¶å€™ä½¿ç”¨ä¸åŒçš„ç¼–è¯‘è§„åˆ™ï¼Œç­‰ç­‰ã€‚æœ¬ç« èŠ‚å°±æ˜¯è®²è¿°å¦‚ä½•ä½¿ç”¨makeå‘½ä»¤çš„ã€‚</p><h3 id="8-1-makeçš„é€€å‡ºç "><a href="#8-1-makeçš„é€€å‡ºç " class="headerlink" title="8.1 makeçš„é€€å‡ºç "></a>8.1 makeçš„é€€å‡ºç </h3><p>makeå‘½ä»¤æ‰§è¡Œåæœ‰ä¸‰ä¸ªé€€å‡ºç ï¼š</p><ul><li>0 â€”â€” è¡¨ç¤ºæˆåŠŸæ‰§è¡Œã€‚</li><li>1 â€”â€” å¦‚æœmakeè¿è¡Œæ—¶å‡ºç°ä»»ä½•é”™è¯¯ï¼Œå…¶è¿”å›1ã€‚</li><li>2 â€”â€” å¦‚æœä½ ä½¿ç”¨äº†makeçš„â€œ-qâ€é€‰é¡¹ï¼Œå¹¶ä¸”makeä½¿å¾—ä¸€äº›ç›®æ ‡ä¸éœ€è¦æ›´æ–°ï¼Œé‚£ä¹ˆè¿”å›2ã€‚</li></ul><h3 id="8-2-æŒ‡å®šMakefile"><a href="#8-2-æŒ‡å®šMakefile" class="headerlink" title="8.2 æŒ‡å®šMakefile"></a>8.2 æŒ‡å®šMakefile</h3><p>GNU makeæ‰¾å¯»é»˜è®¤çš„Makefileçš„è§„åˆ™æ˜¯åœ¨å½“å‰ç›®å½•ä¸‹ä¾æ¬¡æ‰¾ä¸‰ä¸ªæ–‡ä»¶â€”â€”â€œGNUmakefileâ€ã€â€œmakefileâ€å’Œâ€œMakefileâ€ã€‚å…¶æŒ‰é¡ºåºæ‰¾è¿™ä¸‰ä¸ªæ–‡ä»¶ï¼Œä¸€æ—¦æ‰¾åˆ°ï¼Œå°±å¼€å§‹è¯»å–è¿™ä¸ªæ–‡ä»¶å¹¶æ‰§è¡Œã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™makeå‘½ä»¤æŒ‡å®šä¸€ä¸ªç‰¹æ®Šåå­—çš„Makefileã€‚è¦è¾¾åˆ°è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨makeçš„<code>-f</code>æˆ–æ˜¯<code>--file</code>å‚æ•°ï¼ˆ<code>--makefile</code>å‚æ•°ä¹Ÿè¡Œï¼‰ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸ªmakefileçš„åå­—æ˜¯<code>hchen.mk</code>ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥è®©makeæ¥æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make â€“f hchen.mk</span><br></pre></td></tr></table></figure></p><p>å¦‚æœåœ¨makeçš„å‘½ä»¤è¡Œï¼Œä¸åªä¸€æ¬¡åœ°ä½¿ç”¨äº†â€œ-fâ€å‚æ•°ï¼Œé‚£ä¹ˆï¼Œæ‰€æœ‰æŒ‡å®šçš„makefileå°†ä¼šè¢«è¿åœ¨ä¸€èµ·ä¼ é€’ç»™makeæ‰§è¡Œã€‚</p><h3 id="8-3-æŒ‡å®šç›®æ ‡"><a href="#8-3-æŒ‡å®šç›®æ ‡" class="headerlink" title="8.3 æŒ‡å®šç›®æ ‡"></a>8.3 æŒ‡å®šç›®æ ‡</h3><p>åªéœ€å¢åŠ ç›®æ ‡åå­—å³å¯å°†è¿™ä¸ªç›®æ ‡æŒ‡å®šä¸ºç»ˆæç›®æ ‡ã€‚ä»€ä¹ˆä¹Ÿä¸åŠ çš„è¯makeä¼šå°†ç¬¬ä¸€ä¸ªç›®æ ‡ä½œä¸ºç»ˆæç›®æ ‡ã€‚</p><p>ä»»ä½•åœ¨makefileä¸­çš„ç›®æ ‡éƒ½å¯ä»¥è¢«æŒ‡å®šæˆç»ˆæç›®æ ‡ï¼Œä½†æ˜¯é™¤äº†ä»¥â€œ-â€æ‰“å¤´ï¼Œæˆ–æ˜¯åŒ…å«äº†â€œ=â€çš„ç›®æ ‡ï¼Œå› ä¸ºæœ‰è¿™äº›å­—ç¬¦çš„ç›®æ ‡ï¼Œä¼šè¢«è§£ææˆå‘½ä»¤è¡Œå‚æ•°æˆ–æ˜¯å˜é‡ã€‚ç”šè‡³æ²¡æœ‰è¢«æˆ‘ä»¬æ˜ç¡®å†™å‡ºæ¥çš„ç›®æ ‡ä¹Ÿå¯ä»¥æˆä¸ºmakeçš„ç»ˆæç›®æ ‡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦makeå¯ä»¥æ‰¾åˆ°å…¶éšå«è§„åˆ™æ¨å¯¼è§„åˆ™ï¼Œé‚£ä¹ˆè¿™ä¸ªéšå«ç›®æ ‡åŒæ ·å¯ä»¥è¢«æŒ‡å®šæˆç»ˆæç›®æ ‡ã€‚</p><p>æœ‰ä¸€ä¸ªmakeçš„ç¯å¢ƒå˜é‡å«<code>MAKECMDGOALS</code>ï¼Œè¿™ä¸ªå˜é‡ä¸­ä¼šå­˜æ”¾ä½ æ‰€æŒ‡å®šçš„ç»ˆæç›®æ ‡çš„åˆ—è¡¨ï¼Œå¦‚æœåœ¨å‘½ä»¤è¡Œä¸Šï¼Œä½ æ²¡æœ‰æŒ‡å®šç›®æ ‡ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªå˜é‡æ˜¯ç©ºå€¼ã€‚è¿™ä¸ªå˜é‡å¯ä»¥è®©ä½ ä½¿ç”¨åœ¨ä¸€äº›æ¯”è¾ƒç‰¹æ®Šçš„æƒ…å½¢ä¸‹ã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sources = foo.c bar.c</span><br><span class="line"><span class="keyword">ifneq</span> ( <span class="variable">$(MAKECMDGOALS)</span>,clean)</span><br><span class="line"><span class="keyword">include</span> $(sources:.c=.d)</span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure></p><p>åŸºäºä¸Šé¢çš„è¿™ä¸ªä¾‹å­ï¼Œåªè¦æˆ‘ä»¬è¾“å…¥çš„å‘½ä»¤ä¸æ˜¯<code>make clean</code>ï¼Œé‚£ä¹ˆmakefileä¼šè‡ªåŠ¨åŒ…å«<code>foo.d</code>å’Œ<code>bar.d</code>è¿™ä¸¤ä¸ªmakefileã€‚</p><p>å³ç„¶makeå¯ä»¥æŒ‡å®šæ‰€æœ‰makefileä¸­çš„ç›®æ ‡ï¼Œé‚£ä¹ˆä¹ŸåŒ…æ‹¬â€œä¼ªç›®æ ‡â€ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ç§æ€§è´¨æ¥è®©æˆ‘ä»¬çš„makefileæ ¹æ®æŒ‡å®šçš„ä¸åŒçš„ç›®æ ‡æ¥å®Œæˆä¸åŒçš„äº‹ã€‚åœ¨Unixä¸–ç•Œä¸­ï¼Œè½¯ä»¶å‘å¸ƒæ—¶ï¼Œç‰¹åˆ«æ˜¯GNUè¿™ç§å¼€æºè½¯ä»¶çš„å‘å¸ƒæ—¶ï¼Œå…¶makefileéƒ½åŒ…å«äº†ç¼–è¯‘ã€å®‰è£…ã€æ‰“åŒ…ç­‰åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥å‚ç…§è¿™ç§è§„åˆ™æ¥ä¹¦å†™æˆ‘ä»¬çš„makefileä¸­çš„ç›®æ ‡ã€‚</p><ul><li><p><code>all</code><br>è¿™ä¸ªä¼ªç›®æ ‡æ˜¯æ‰€æœ‰ç›®æ ‡çš„ç›®æ ‡ï¼Œå…¶åŠŸèƒ½ä¸€èˆ¬æ˜¯ç¼–è¯‘æ‰€æœ‰çš„ç›®æ ‡ã€‚</p></li><li><p><code>clean</code><br>è¿™ä¸ªä¼ªç›®æ ‡åŠŸèƒ½æ˜¯åˆ é™¤æ‰€æœ‰è¢«makeåˆ›å»ºçš„æ–‡ä»¶ã€‚</p></li><li><p><code>install</code><br>è¿™ä¸ªä¼ªç›®æ ‡åŠŸèƒ½æ˜¯å®‰è£…å·²ç¼–è¯‘å¥½çš„ç¨‹åºï¼Œå…¶å®å°±æ˜¯æŠŠç›®æ ‡æ‰§è¡Œæ–‡ä»¶æ‹·è´åˆ°æŒ‡å®šçš„ç›®æ ‡ä¸­å»ã€‚</p></li><li><p><code>print</code><br>è¿™ä¸ªä¼ªç›®æ ‡çš„åŠŸèƒ½æ˜¯ä¾‹å‡ºæ”¹å˜è¿‡çš„æºæ–‡ä»¶ã€‚</p></li><li><p><code>tar</code><br>è¿™ä¸ªä¼ªç›®æ ‡åŠŸèƒ½æ˜¯æŠŠæºç¨‹åºæ‰“åŒ…å¤‡ä»½ã€‚ä¹Ÿå°±æ˜¯ä¸€ä¸ªtaræ–‡ä»¶ã€‚</p></li><li><p><code>dist</code><br>è¿™ä¸ªä¼ªç›®æ ‡åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œä¸€èˆ¬æ˜¯æŠŠtaræ–‡ä»¶å‹æˆZæ–‡ä»¶ã€‚æˆ–æ˜¯gzæ–‡ä»¶ã€‚</p></li><li><p><code>TAGS</code><br>è¿™ä¸ªä¼ªç›®æ ‡åŠŸèƒ½æ˜¯æ›´æ–°æ‰€æœ‰çš„ç›®æ ‡ï¼Œä»¥å¤‡å®Œæ•´åœ°é‡ç¼–è¯‘ä½¿ç”¨ã€‚</p></li><li><p><code>check</code>å’Œ<code>test</code><br>è¿™ä¸¤ä¸ªä¼ªç›®æ ‡ä¸€èˆ¬ç”¨æ¥æµ‹è¯•makefileçš„æµç¨‹ã€‚</p></li></ul><h3 id="8-4-makeçš„å‚æ•°"><a href="#8-4-makeçš„å‚æ•°" class="headerlink" title="8.4 makeçš„å‚æ•°"></a>8.4 makeçš„å‚æ•°</h3><p>ä¸‹é¢åˆ—ä¸¾äº†æ‰€æœ‰GNU make 3.80ç‰ˆçš„å‚æ•°å®šä¹‰ã€‚å…¶å®ƒç‰ˆæœ¬å’Œäº§å•†çš„makeå¤§åŒå°å¼‚ï¼Œä¸è¿‡å…¶å®ƒäº§å•†çš„makeçš„å…·ä½“å‚æ•°è¿˜æ˜¯è¯·å‚è€ƒå„è‡ªçš„äº§å“æ–‡æ¡£ã€‚</p><ul><li><p><code>-b</code>/<code>-m</code><br>è¿™ä¸¤ä¸ªå‚æ•°çš„ä½œç”¨æ˜¯å¿½ç•¥å’Œå…¶å®ƒç‰ˆæœ¬makeçš„å…¼å®¹æ€§ã€‚</p></li><li><p><code>-B</code>/<code>--always-make</code><br>è®¤ä¸ºæ‰€æœ‰çš„ç›®æ ‡éƒ½éœ€è¦æ›´æ–°ï¼ˆé‡ç¼–è¯‘ï¼‰ã€‚</p></li><li><p><code>-C &lt;dir&gt;</code>/<code>--directory=&lt;dir&gt;</code><br>æŒ‡å®šè¯»å–makefileçš„ç›®å½•ã€‚å¦‚æœæœ‰å¤šä¸ª<code>-C</code>å‚æ•°ï¼Œmakeçš„è§£é‡Šæ˜¯åé¢çš„è·¯å¾„ä»¥å‰é¢çš„ä½œä¸ºç›¸å¯¹è·¯å¾„ï¼Œå¹¶ä»¥æœ€åçš„ç›®å½•ä½œä¸ºè¢«æŒ‡å®šç›®å½•ã€‚å¦‚ï¼š<code>make â€“C ~hchen/test â€“C prog</code>ç­‰ä»·äº<code>make â€“C ~hchen/test/prog</code>ã€‚</p></li></ul><p><code>â€”debug[=&lt;options&gt;]</code><br>è¾“å‡ºmakeçš„è°ƒè¯•ä¿¡æ¯ã€‚å®ƒæœ‰å‡ ç§ä¸åŒçš„çº§åˆ«å¯ä¾›é€‰æ‹©ï¼Œå¦‚æœæ²¡æœ‰å‚æ•°ï¼Œé‚£å°±æ˜¯è¾“å‡ºæœ€ç®€å•çš„è°ƒè¯•ä¿¡æ¯ã€‚ä¸‹é¢æ˜¯<code>&lt;options&gt;</code>çš„å–å€¼ï¼š<br>    a â€”â€” ä¹Ÿå°±æ˜¯allï¼Œè¾“å‡ºæ‰€æœ‰çš„è°ƒè¯•ä¿¡æ¯ã€‚ï¼ˆä¼šéå¸¸çš„å¤šï¼‰<br>    b â€”â€” ä¹Ÿå°±æ˜¯basicï¼Œåªè¾“å‡ºç®€å•çš„è°ƒè¯•ä¿¡æ¯ã€‚å³è¾“å‡ºä¸éœ€è¦é‡ç¼–è¯‘çš„ç›®æ ‡ã€‚<br>    v â€”â€” ä¹Ÿå°±æ˜¯verboseï¼Œåœ¨bé€‰é¡¹çš„çº§åˆ«ä¹‹ä¸Šã€‚è¾“å‡ºçš„ä¿¡æ¯åŒ…æ‹¬å“ªä¸ªmakefileè¢«è§£æï¼Œä¸éœ€è¦è¢«é‡ç¼–è¯‘çš„ä¾èµ–æ–‡ä»¶ï¼ˆæˆ–æ˜¯ä¾èµ–ç›®æ ‡ï¼‰ç­‰ã€‚<br>    i â€”â€” ä¹Ÿå°±æ˜¯implicitï¼Œè¾“å‡ºæ‰€ä»¥çš„éšå«è§„åˆ™ã€‚<br>    j â€”â€” ä¹Ÿå°±æ˜¯jobsï¼Œè¾“å‡ºæ‰§è¡Œè§„åˆ™ä¸­å‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚å‘½ä»¤çš„PIDã€è¿”å›ç ç­‰ã€‚<br>    m â€”â€” ä¹Ÿå°±æ˜¯makefileï¼Œè¾“å‡ºmakeè¯»å–makefileï¼Œæ›´æ–°makefileï¼Œæ‰§è¡Œmakefileçš„ä¿¡æ¯ã€‚</p><ul><li><p><code>-d</code><br>ç›¸å½“äº<code>--debug=a</code>ã€‚</p></li><li><p><code>-e</code>/<code>--environment-overrides</code><br>æŒ‡æ˜ç¯å¢ƒå˜é‡çš„å€¼è¦†ç›–makefileä¸­å®šä¹‰çš„å˜é‡çš„å€¼ã€‚</p></li><li><p><code>-f &lt;file&gt;</code>/<code>--file &lt;file&gt;</code>/<code>--makefile &lt;file&gt;</code><br>æŒ‡å®šéœ€è¦æ‰§è¡Œçš„makefileã€‚</p></li><li><p><code>-h</code>/<code>--help</code><br>æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€‚</p></li><li><p><code>-i</code>/<code>--ignore-errors</code><br>åœ¨æ‰§è¡Œæ—¶å¿½ç•¥æ‰€æœ‰çš„é”™è¯¯ã€‚</p></li><li><p><code>-I &lt;dir&gt;</code>/<code>--include-dir &lt;dir&gt;</code><br>æŒ‡å®šä¸€ä¸ªè¢«åŒ…å«makefileçš„æœç´¢ç›®æ ‡ã€‚å¯ä»¥ä½¿ç”¨å¤šä¸ª<code>-I</code>å‚æ•°æ¥æŒ‡å®šå¤šä¸ªç›®å½•ã€‚</p></li><li><p><code>-j [&lt;jobsnum&gt;]</code>/<code>--jobs[=&lt;jobsnum&gt;]</code><br>æŒ‡åŒæ—¶è¿è¡Œå‘½ä»¤çš„ä¸ªæ•°ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªå‚æ•°ï¼Œmakeè¿è¡Œå‘½ä»¤æ—¶èƒ½è¿è¡Œå¤šå°‘å°±è¿è¡Œå¤šå°‘ã€‚å¦‚æœæœ‰ä¸€ä¸ªä»¥ä¸Šçš„<code>-j</code>å‚æ•°ï¼Œé‚£ä¹ˆä»…æœ€åä¸€ä¸ª<code>-j</code>æ‰æ˜¯æœ‰æ•ˆçš„ã€‚ï¼ˆæ³¨æ„è¿™ä¸ªå‚æ•°åœ¨MS-DOSä¸­æ˜¯æ— ç”¨çš„ï¼‰</p></li><li><p><code>-k</code>/<code>--keep-going</code><br>å‡ºé”™ä¹Ÿä¸åœæ­¢è¿è¡Œã€‚å¦‚æœç”Ÿæˆä¸€ä¸ªç›®æ ‡å¤±è´¥äº†ï¼Œé‚£ä¹ˆä¾èµ–äºå…¶ä¸Šçš„ç›®æ ‡å°±ä¸ä¼šè¢«æ‰§è¡Œäº†ã€‚</p></li><li><p><code>-l &lt;load&gt;</code>/<code>--load-average[=&lt;load]</code>/<code>â€”max-load[=&lt;load&gt;]</code><br>æŒ‡å®šmakeè¿è¡Œå‘½ä»¤çš„è´Ÿè½½ã€‚</p></li><li><p><code>-n</code>/<code>--just-print</code>/<code>--dry-run</code>/<code>--recon</code><br>ä»…è¾“å‡ºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„å‘½ä»¤åºåˆ—ï¼Œä½†å¹¶ä¸æ‰§è¡Œã€‚</p></li><li><p><code>-o &lt;file&gt;</code>/<code>--old-file &lt;file&gt;</code>/<code>--assume-old &lt;file&gt;</code><br>ä¸é‡æ–°ç”Ÿæˆçš„æŒ‡å®šçš„<code>&lt;file&gt;</code>ï¼Œå³ä½¿è¿™ä¸ªç›®æ ‡çš„ä¾èµ–æ–‡ä»¶æ–°äºå®ƒã€‚</p></li><li><p><code>-p</code>/<code>--print-data-base</code><br>è¾“å‡ºmakefileä¸­çš„æ‰€æœ‰æ•°æ®ï¼ŒåŒ…æ‹¬æ‰€æœ‰çš„è§„åˆ™å’Œå˜é‡ã€‚è¿™ä¸ªå‚æ•°ä¼šè®©ä¸€ä¸ªç®€å•çš„makefileéƒ½ä¼šè¾“å‡ºä¸€å †ä¿¡æ¯ã€‚å¦‚æœä½ åªæ˜¯æƒ³è¾“å‡ºä¿¡æ¯è€Œä¸æƒ³æ‰§è¡Œmakefileï¼Œä½ å¯ä»¥ä½¿ç”¨<code>make -qp</code>å‘½ä»¤ã€‚å¦‚æœä½ æƒ³æŸ¥çœ‹æ‰§è¡Œmakefileå‰çš„é¢„è®¾å˜é‡å’Œè§„åˆ™ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>make â€“p â€“f /dev/null</code>ã€‚è¿™ä¸ªå‚æ•°è¾“å‡ºçš„ä¿¡æ¯ä¼šåŒ…å«ç€ä½ çš„makefileæ–‡ä»¶çš„æ–‡ä»¶åå’Œè¡Œå·ï¼Œæ‰€ä»¥ï¼Œç”¨è¿™ä¸ªå‚æ•°æ¥è°ƒè¯•ä½ çš„makefileä¼šæ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œç‰¹åˆ«æ˜¯å½“ä½ çš„ç¯å¢ƒå˜é‡å¾ˆå¤æ‚çš„æ—¶å€™ã€‚</p></li><li><p><code>-q</code>/<code>--question</code><br>ä¸è¿è¡Œå‘½ä»¤ï¼Œä¹Ÿä¸è¾“å‡ºã€‚ä»…ä»…æ˜¯æ£€æŸ¥æ‰€æŒ‡å®šçš„ç›®æ ‡æ˜¯å¦éœ€è¦æ›´æ–°ã€‚å¦‚æœæ˜¯0åˆ™è¯´æ˜è¦æ›´æ–°ï¼Œå¦‚æœæ˜¯2åˆ™è¯´æ˜æœ‰é”™è¯¯å‘ç”Ÿã€‚</p></li><li><p><code>-r</code>/<code>--no-builtin-rules</code><br>ç¦æ­¢makeä½¿ç”¨ä»»ä½•éšå«è§„åˆ™ã€‚</p></li><li><p><code>-R</code>/<code>--no-builtin-variabes</code><br>ç¦æ­¢makeä½¿ç”¨ä»»ä½•ä½œç”¨äºå˜é‡ä¸Šçš„éšå«è§„åˆ™ã€‚</p></li><li><p><code>-s</code>/<code>--silent</code>/<code>--quiet</code><br>åœ¨å‘½ä»¤è¿è¡Œæ—¶ä¸è¾“å‡ºå‘½ä»¤çš„è¾“å‡ºã€‚</p></li><li><p><code>-S</code>/<code>--no-keep-going</code>/<code>--stop</code><br>å–æ¶ˆ<code>-k</code>é€‰é¡¹çš„ä½œç”¨ã€‚å› ä¸ºæœ‰äº›æ—¶å€™ï¼Œmakeçš„é€‰é¡¹æ˜¯ä»ç¯å¢ƒå˜é‡<code>MAKEFLAGS</code>ä¸­ç»§æ‰¿ä¸‹æ¥çš„ã€‚æ‰€ä»¥ä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨è¿™ä¸ªå‚æ•°æ¥è®©ç¯å¢ƒå˜é‡ä¸­çš„<code>-k</code>é€‰é¡¹å¤±æ•ˆã€‚</p></li><li><p><code>-t</code>/<code>--touch</code><br>ç›¸å½“äºUNIXçš„touchå‘½ä»¤ï¼Œåªæ˜¯æŠŠç›®æ ‡çš„ä¿®æ”¹æ—¥æœŸå˜æˆæœ€æ–°çš„ï¼Œä¹Ÿå°±æ˜¯é˜»æ­¢ç”Ÿæˆç›®æ ‡çš„å‘½ä»¤è¿è¡Œã€‚</p></li><li><p><code>-v</code>/<code>--version</code><br>è¾“å‡ºmakeç¨‹åºçš„ç‰ˆæœ¬ã€ç‰ˆæƒç­‰å…³äºmakeçš„ä¿¡æ¯ã€‚</p></li><li><p><code>-w</code>/<code>--print-directory</code><br>è¾“å‡ºè¿è¡Œmakefileä¹‹å‰å’Œä¹‹åçš„ä¿¡æ¯ã€‚è¿™ä¸ªå‚æ•°å¯¹äºè·Ÿè¸ªåµŒå¥—å¼è°ƒç”¨makeæ—¶å¾ˆæœ‰ç”¨ã€‚</p></li><li><p><code>--no-print-directory</code><br>ç¦æ­¢<code>-w</code>é€‰é¡¹ã€‚</p></li><li><p><code>-W &lt;file&gt;</code>/<code>--what-if=&lt;file&gt;</code>/<code>--new-file=&lt;file&gt;</code>/<code>--assume-file=&lt;file&gt;</code><br>å‡å®šç›®æ ‡<code>&lt;file&gt;</code>éœ€è¦æ›´æ–°ï¼Œå¦‚æœå’Œ<code>-n</code>é€‰é¡¹ä½¿ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°ä¼šè¾“å‡ºè¯¥ç›®æ ‡æ›´æ–°æ—¶çš„è¿è¡ŒåŠ¨ä½œã€‚å¦‚æœæ²¡æœ‰<code>-n</code>é‚£ä¹ˆå°±åƒè¿è¡ŒUNIXçš„<code>touch</code>å‘½ä»¤ä¸€æ ·ï¼Œä½¿å¾—<code>&lt;file&gt;</code>çš„ä¿®æ”¹æ—¶é—´ä¸ºå½“å‰æ—¶é—´ã€‚</p></li><li><p><code>--warn-undefined-variables</code><br>åªè¦makeå‘ç°æœ‰æœªå®šä¹‰çš„å˜é‡ï¼Œé‚£ä¹ˆå°±è¾“å‡ºè­¦å‘Šä¿¡æ¯ã€‚</p></li></ul><hr><h2 id="9-éšå«è§„åˆ™"><a href="#9-éšå«è§„åˆ™" class="headerlink" title="9 éšå«è§„åˆ™"></a>9 éšå«è§„åˆ™</h2><p>åœ¨æˆ‘ä»¬ä½¿ç”¨Makefileæ—¶ï¼Œæœ‰ä¸€äº›æˆ‘ä»¬ä¼šç»å¸¸ä½¿ç”¨ï¼Œè€Œä¸”ä½¿ç”¨é¢‘ç‡éå¸¸é«˜çš„ä¸œè¥¿ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬ç¼–è¯‘C/C++çš„æºç¨‹åºä¸ºä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆUnixä¸‹æ˜¯[.o]æ–‡ä»¶ï¼ŒWindowsä¸‹æ˜¯[.obj]æ–‡ä»¶ï¼‰ã€‚æœ¬ç« è®²è¿°çš„å°±æ˜¯ä¸€äº›åœ¨Makefileä¸­çš„â€œéšå«çš„â€ï¼Œæ—©å…ˆçº¦å®šäº†çš„ï¼Œä¸éœ€è¦æˆ‘ä»¬å†å†™å‡ºæ¥çš„è§„åˆ™ã€‚</p><p>â€œéšå«è§„åˆ™â€ä¹Ÿå°±æ˜¯ä¸€ç§æƒ¯ä¾‹ï¼Œmakeä¼šæŒ‰ç…§è¿™ç§â€œæƒ¯ä¾‹â€å¿ƒç…§ä¸å–§åœ°æ¥è¿è¡Œï¼Œé‚£æ€•æˆ‘ä»¬çš„Makefileä¸­æ²¡æœ‰ä¹¦å†™è¿™æ ·çš„è§„åˆ™ã€‚ä¾‹å¦‚ï¼ŒæŠŠ[.c]æ–‡ä»¶ç¼–è¯‘æˆ[.o]æ–‡ä»¶è¿™ä¸€è§„åˆ™ï¼Œä½ æ ¹æœ¬å°±ä¸ç”¨å†™å‡ºæ¥ï¼Œmakeä¼šè‡ªåŠ¨æ¨å¯¼å‡ºè¿™ç§è§„åˆ™ï¼Œå¹¶ç”Ÿæˆæˆ‘ä»¬éœ€è¦çš„[.o]æ–‡ä»¶ã€‚</p><p>â€œéšå«è§„åˆ™â€ä¼šä½¿ç”¨ä¸€äº›æˆ‘ä»¬ç³»ç»Ÿå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜è¿™äº›ç³»ç»Ÿå˜é‡çš„å€¼æ¥å®šåˆ¶éšå«è§„åˆ™çš„è¿è¡Œæ—¶çš„å‚æ•°ã€‚å¦‚ç³»ç»Ÿå˜é‡â€œCFLAGSâ€å¯ä»¥æ§åˆ¶ç¼–è¯‘æ—¶çš„ç¼–è¯‘å™¨å‚æ•°ã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡â€œæ¨¡å¼è§„åˆ™â€çš„æ–¹å¼å†™ä¸‹è‡ªå·±çš„éšå«è§„åˆ™ã€‚ç”¨â€œåç¼€è§„åˆ™â€æ¥å®šä¹‰éšå«è§„åˆ™ä¼šæœ‰è®¸å¤šçš„é™åˆ¶ã€‚ä½¿ç”¨â€œæ¨¡å¼è§„åˆ™â€ä¼šæ›´å›å¾—æ™ºèƒ½å’Œæ¸…æ¥šï¼Œä½†â€œåç¼€è§„åˆ™â€å¯ä»¥ç”¨æ¥ä¿è¯æˆ‘ä»¬Makefileçš„å…¼å®¹æ€§ã€‚<br>æˆ‘ä»¬äº†è§£äº†â€œéšå«è§„åˆ™â€ï¼Œå¯ä»¥è®©å…¶ä¸ºæˆ‘ä»¬æ›´å¥½çš„æœåŠ¡ï¼Œä¹Ÿä¼šè®©æˆ‘ä»¬çŸ¥é“ä¸€äº›â€œçº¦å®šä¿—æˆâ€äº†çš„ä¸œè¥¿ï¼Œè€Œä¸è‡³äºä½¿å¾—æˆ‘ä»¬åœ¨è¿è¡ŒMakefileæ—¶å‡ºç°ä¸€äº›æˆ‘ä»¬è§‰å¾—è«åå…¶å¦™çš„ä¸œè¥¿ã€‚å½“ç„¶ï¼Œä»»ä½•äº‹ç‰©éƒ½æ˜¯çŸ›ç›¾çš„ï¼Œæ°´èƒ½è½½èˆŸï¼Œäº¦å¯è¦†èˆŸï¼Œæ‰€ä»¥ï¼Œæœ‰æ—¶å€™â€œéšå«è§„åˆ™â€ä¹Ÿä¼šç»™æˆ‘ä»¬é€ æˆä¸å°çš„éº»çƒ¦ã€‚åªæœ‰äº†è§£äº†å®ƒï¼Œæˆ‘ä»¬æ‰èƒ½æ›´å¥½åœ°ä½¿ç”¨å®ƒã€‚</p><h3 id="9-1-ä½¿ç”¨éšå«è§„åˆ™"><a href="#9-1-ä½¿ç”¨éšå«è§„åˆ™" class="headerlink" title="9.1 ä½¿ç”¨éšå«è§„åˆ™"></a>9.1 ä½¿ç”¨éšå«è§„åˆ™</h3><p>å¦‚æœè¦ä½¿ç”¨éšå«è§„åˆ™ç”Ÿæˆä½ éœ€è¦çš„ç›®æ ‡ï¼Œä½ æ‰€éœ€è¦åšçš„å°±æ˜¯ä¸è¦å†™å‡ºè¿™ä¸ªç›®æ ‡çš„è§„åˆ™ï¼Œè€Œæ˜¯è®©makeè‡ªåŠ¨æ¨åˆ°ç”Ÿæˆè¿™ä¸ªç›®æ ‡çš„è§„åˆ™ã€‚<br>å¦‚æœmakeå¯ä»¥è‡ªåŠ¨æ¨å¯¼ç”Ÿæˆè¿™ä¸ªç›®æ ‡çš„è§„åˆ™å’Œå‘½ä»¤ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡Œä¸ºå°±æ˜¯éšå«è§„åˆ™çš„è‡ªåŠ¨æ¨å¯¼ã€‚</p><p>ä¾‹å¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">foo : foo.o bar.o</span><br><span class="line">    cc â€“o foo foo.o bar.o <span class="variable">$(CFLAGS)</span> <span class="variable">$(LDFLAGS)</span></span><br></pre></td></tr></table></figure></p><p>ä¸€ä¸ªmakefileä¸­åªåŒ…å«ä»¥ä¸Šå†…å®¹ï¼Œå¹¶æ²¡æœ‰æŒ‡å‡º<code>foo.o</code>ä¸<code>bar.o</code>æ˜¯æ€ä¹ˆç”Ÿæˆçš„ã€‚makeçš„â€œéšå«è§„åˆ™â€åŠŸèƒ½ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬è‡ªåŠ¨å»æ¨å¯¼è¿™ä¸¤ä¸ªç›®æ ‡çš„ä¾èµ–ç›®æ ‡å’Œç”Ÿæˆå‘½ä»¤ã€‚<br>makeä¼šåœ¨è‡ªå·±çš„â€œéšå«è§„åˆ™â€åº“ä¸­å¯»æ‰¾å¯ä»¥ç”¨çš„è§„åˆ™ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œé‚£ä¹ˆå°±ä¼šä½¿ç”¨ã€‚å¦‚æœæ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆå°±ä¼šæŠ¥é”™ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œmakeè°ƒç”¨çš„éšå«è§„åˆ™æ˜¯ï¼šæŠŠ[.o]çš„ç›®æ ‡çš„ä¾èµ–æ–‡ä»¶ç½®æˆ[.c]ï¼Œå¹¶ä½¿ç”¨Cçš„ç¼–è¯‘å‘½ä»¤<code>cc â€“c $(CFLAGS) [.c]</code>æ¥ç”Ÿæˆ[.o]çš„ç›®æ ‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å®Œå…¨æ²¡æœ‰å¿…è¦å†™ä¸‹ä¸‹é¢çš„ä¸¤æ¡è§„åˆ™ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">foo.o : foo.c</span><br><span class="line">    cc â€“c foo.c <span class="variable">$(CFLAGS)</span></span><br><span class="line">bar.o : bar.c</span><br><span class="line">    cc â€“c bar.c <span class="variable">$(CFLAGS)</span></span><br></pre></td></tr></table></figure></p><p>å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬ä¸º[.o]æ–‡ä»¶ä¹¦å†™äº†è‡ªå·±çš„è§„åˆ™ï¼Œé‚£ä¹ˆmakeå°±ä¸ä¼šè‡ªåŠ¨æ¨å¯¼å¹¶è°ƒç”¨éšå«è§„åˆ™ï¼Œå®ƒä¼šæŒ‰ç…§æˆ‘ä»¬å†™å¥½çš„è§„åˆ™å¿ å®åœ°æ‰§è¡Œã€‚</p><p>åœ¨makeçš„â€œéšå«è§„åˆ™åº“â€ä¸­ï¼Œæ¯ä¸€æ¡éšå«è§„åˆ™éƒ½åœ¨åº“ä¸­æœ‰å…¶é¡ºåºï¼Œè¶Šé å‰çš„åˆ™æ˜¯è¶Šè¢«ç»å¸¸ä½¿ç”¨çš„ï¼Œæ‰€ä»¥ï¼Œè¿™ä¼šå¯¼è‡´æˆ‘ä»¬æœ‰äº›æ—¶å€™å³ä½¿æˆ‘ä»¬æ˜¾ç¤ºåœ°æŒ‡å®šäº†ç›®æ ‡ä¾èµ–ï¼Œmakeä¹Ÿä¸ä¼šç®¡ã€‚å¦‚ä¸‹é¢è¿™æ¡è§„åˆ™ï¼ˆæ²¡æœ‰å‘½ä»¤ï¼‰ï¼š</p><pre><code>foo.o : foo.p</code></pre><p>ä¾èµ–æ–‡ä»¶<code>foo.p</code>ï¼ˆPascalç¨‹åºçš„æºæ–‡ä»¶ï¼‰æœ‰å¯èƒ½å˜å¾—æ²¡æœ‰æ„ä¹‰ã€‚å¦‚æœç›®å½•ä¸‹å­˜åœ¨äº†<code>foo.c</code>æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„éšå«è§„åˆ™ä¸€æ ·ä¼šç”Ÿæ•ˆï¼Œå¹¶ä¼šé€šè¿‡<code>foo.c</code>è°ƒç”¨Cçš„ç¼–è¯‘å™¨ç”Ÿæˆfoo.oæ–‡ä»¶ã€‚å› ä¸ºï¼Œåœ¨éšå«è§„åˆ™ä¸­ï¼ŒPascalçš„è§„åˆ™å‡ºç°åœ¨Cçš„è§„åˆ™ä¹‹åï¼Œæ‰€ä»¥ï¼Œmakeæ‰¾åˆ°å¯ä»¥ç”Ÿæˆfoo.oçš„Cçš„è§„åˆ™å°±ä¸å†å¯»æ‰¾ä¸‹ä¸€æ¡è§„åˆ™äº†ã€‚å¦‚æœä½ ç¡®å®ä¸å¸Œæœ›ä»»ä½•éšå«è§„åˆ™æ¨å¯¼ï¼Œé‚£ä¹ˆï¼Œä½ å°±ä¸è¦åªå†™å‡ºâ€œä¾èµ–è§„åˆ™â€ï¼Œè€Œä¸å†™å‘½ä»¤ã€‚</p><h3 id="9-2-éšå«è§„åˆ™ä¸€è§ˆ"><a href="#9-2-éšå«è§„åˆ™ä¸€è§ˆ" class="headerlink" title="9.2 éšå«è§„åˆ™ä¸€è§ˆ"></a>9.2 éšå«è§„åˆ™ä¸€è§ˆ</h3><p>ä»¥ä¸‹ä¸ºmakeå†…å»ºçš„éšå«è§„åˆ™ï¼Œå¦‚æœæˆ‘ä»¬ä¸æ˜ç¡®åœ°å†™ä¸‹è§„åˆ™ï¼Œé‚£ä¹ˆï¼Œmakeå°±ä¼šåœ¨è¿™äº›è§„åˆ™ä¸­å¯»æ‰¾æ‰€éœ€è¦è§„åˆ™å’Œå‘½ä»¤ã€‚<br>å¯ä»¥ä½¿ç”¨makeçš„å‚æ•°<code>-r</code>æˆ–<code>--no-builtin-rules</code>é€‰é¡¹æ¥å–æ¶ˆæ‰€æœ‰çš„é¢„è®¾ç½®çš„éšå«è§„åˆ™ã€‚<br>å³ä½¿æ˜¯æˆ‘ä»¬æŒ‡å®šäº†<code>-r</code>å‚æ•°ï¼ŒæŸäº›éšå«è§„åˆ™è¿˜æ˜¯ä¼šç”Ÿæ•ˆï¼Œå› ä¸ºæœ‰è®¸å¤šçš„éšå«è§„åˆ™éƒ½æ˜¯ä½¿ç”¨äº†â€œåç¼€è§„åˆ™â€æ¥å®šä¹‰çš„ï¼Œæ‰€ä»¥ï¼Œåªè¦éšå«è§„åˆ™ä¸­æœ‰â€œåç¼€åˆ—è¡¨â€ï¼ˆä¹Ÿå°±ä¸€ç³»ç»Ÿå®šä¹‰åœ¨ç›®æ ‡.SUFFIXESçš„ä¾èµ–ç›®æ ‡ï¼‰ï¼Œé‚£ä¹ˆéšå«è§„åˆ™å°±ä¼šç”Ÿæ•ˆã€‚é»˜è®¤çš„åç¼€åˆ—è¡¨æ˜¯ï¼š.out, .a, .ln, .o, .c, .cc, .C, .p, .f, .F, .r, .y, .l, .s, .S, .mod, .sym, .def, .h, .info, .dvi, .tex, .texinfo, .texi, .txinfo, .w, .ch .web, .sh, .elc, .elã€‚</p><ol><li><p>ç¼–è¯‘Cç¨‹åºçš„éšå«è§„åˆ™ã€‚<br><code>&lt;n&gt;.o</code>çš„ç›®æ ‡çš„ä¾èµ–ç›®æ ‡ä¼šè‡ªåŠ¨æ¨å¯¼ä¸º<code>&lt;n&gt;.c</code>ï¼Œå¹¶ä¸”å…¶ç”Ÿæˆå‘½ä»¤æ˜¯<code>$(CC) â€“c $(CPPFLAGS) $(CFLAGS)</code></p></li><li><p>ç¼–è¯‘C++ç¨‹åºçš„éšå«è§„åˆ™ã€‚<br><code>&lt;n&gt;.o</code>çš„ç›®æ ‡çš„ä¾èµ–ç›®æ ‡ä¼šè‡ªåŠ¨æ¨å¯¼ä¸º<code>&lt;n&gt;.cc</code>æˆ–æ˜¯<code>&lt;n&gt;.C</code>ï¼Œå¹¶ä¸”å…¶ç”Ÿæˆå‘½ä»¤æ˜¯<code>$(CXX) â€“c $(CPPFLAGS) $(CFLAGS)</code>ã€‚ï¼ˆå»ºè®®ä½¿ç”¨<code>.cc</code>ä½œä¸ºC++æºæ–‡ä»¶çš„åç¼€ï¼Œè€Œä¸æ˜¯<code>.C</code>ï¼‰</p></li><li><p>ç¼–è¯‘Pascalç¨‹åºçš„éšå«è§„åˆ™ã€‚<br><code>&lt;n&gt;.o</code>çš„ç›®æ ‡çš„ä¾èµ–ç›®æ ‡ä¼šè‡ªåŠ¨æ¨å¯¼ä¸º<code>&lt;n&gt;.p</code>ï¼Œå¹¶ä¸”å…¶ç”Ÿæˆå‘½ä»¤æ˜¯<code>$(PC) â€“c  $(PFLAGS)</code>ã€‚</p></li><li><p>ç¼–è¯‘Fortran/Ratforç¨‹åºçš„éšå«è§„åˆ™ã€‚<br><code>&lt;n&gt;.o</code>çš„ç›®æ ‡çš„ä¾èµ–ç›®æ ‡ä¼šè‡ªåŠ¨æ¨å¯¼ä¸º<code>&lt;n&gt;.r</code>æˆ–<code>&lt;n&gt;.F</code>æˆ–<code>&lt;n&gt;.f</code>ï¼Œå¹¶ä¸”å…¶ç”Ÿæˆå‘½ä»¤æ˜¯:<br> <code>.f</code>  <code>$(FC) â€“c  $(FFLAGS)</code><br> <code>.F</code>  <code>$(FC) â€“c  $(FFLAGS) $(CPPFLAGS)</code><br> <code>.f</code>  <code>$(FC) â€“c  $(FFLAGS) $(RFLAGS)</code></p></li><li><p>é¢„å¤„ç†Fortran/Ratforç¨‹åºçš„éšå«è§„åˆ™ã€‚<br><code>&lt;n&gt;.f</code>çš„ç›®æ ‡çš„ä¾èµ–ç›®æ ‡ä¼šè‡ªåŠ¨æ¨å¯¼ä¸º<code>&lt;n&gt;.r</code>æˆ–<code>&lt;n&gt;.F</code>ã€‚è¿™ä¸ªè§„åˆ™åªæ˜¯è½¬æ¢Ratforæˆ–æœ‰é¢„å¤„ç†çš„Fortranç¨‹åºåˆ°ä¸€ä¸ªæ ‡å‡†çš„Fortranç¨‹åºã€‚å…¶ä½¿ç”¨çš„å‘½ä»¤æ˜¯ï¼š<br> <code>.F</code>  <code>$(FC) â€“F $(CPPFLAGS) $(FFLAGS)</code><br> <code>.r</code>  <code>$(FC) â€“F $(FFLAGS) $(RFLAGS)</code></p></li><li><p>ç¼–è¯‘Modula-2ç¨‹åºçš„éšå«è§„åˆ™ã€‚<br><code>&lt;n&gt;.sym</code>çš„ç›®æ ‡çš„ä¾èµ–ç›®æ ‡ä¼šè‡ªåŠ¨æ¨å¯¼ä¸º<code>&lt;n&gt;.def</code>ï¼Œå¹¶ä¸”å…¶ç”Ÿæˆå‘½ä»¤æ˜¯ï¼š<code>$(M2C) $(M2FLAGS) $(DEFFLAGS)</code>ã€‚<br><code>&lt;n.o&gt;</code>çš„ç›®æ ‡çš„ä¾èµ–ç›®æ ‡ä¼šè‡ªåŠ¨æ¨å¯¼ä¸º<code>&lt;n&gt;.mod</code>ï¼Œå¹¶ä¸”å…¶ç”Ÿæˆå‘½ä»¤æ˜¯ï¼š<code>$(M2C) $(M2FLAGS) $(MODFLAGS)</code>ã€‚</p></li><li><p>æ±‡ç¼–å’Œæ±‡ç¼–é¢„å¤„ç†çš„éšå«è§„åˆ™ã€‚<br><code>&lt;n&gt;.o</code>çš„ç›®æ ‡çš„ä¾èµ–ç›®æ ‡ä¼šè‡ªåŠ¨æ¨å¯¼ä¸º<code>&lt;n&gt;.s</code>ï¼Œé»˜è®¤ä½¿ç”¨ç¼–è¯‘å“<code>as</code>ï¼Œå¹¶ä¸”å…¶ç”Ÿæˆå‘½ä»¤æ˜¯ï¼š<code>$(AS) $(ASFLAGS)</code>ã€‚<code>&lt;n&gt;.s</code> çš„ç›®æ ‡çš„ä¾èµ–ç›®æ ‡ä¼šè‡ªåŠ¨æ¨å¯¼ä¸º<code>&lt;n&gt;.S</code>ï¼Œé»˜è®¤ä½¿ç”¨Cé¢„ç¼–è¯‘å™¨<code>cpp</code>ï¼Œå¹¶ä¸”å…¶ç”Ÿæˆå‘½ä»¤æ˜¯ï¼š<code>$(AS) $(ASFLAGS)</code>ã€‚</p></li><li><p>é“¾æ¥Objectæ–‡ä»¶çš„éšå«è§„åˆ™ã€‚<br><code>&lt;n&gt;</code>ç›®æ ‡ä¾èµ–äº<code>&lt;n&gt;.o</code>ï¼Œé€šè¿‡è¿è¡ŒCçš„ç¼–è¯‘å™¨æ¥è¿è¡Œé“¾æ¥ç¨‹åºç”Ÿæˆï¼ˆä¸€èˆ¬æ˜¯<code>ld</code>ï¼‰ï¼Œå…¶ç”Ÿæˆå‘½ä»¤æ˜¯ï¼š<code>$(CC) $(LDFLAGS) &lt;n&gt;.o $(LOADLIBES) $(LDLIBS)</code>ã€‚è¿™ä¸ªè§„åˆ™å¯¹äºåªæœ‰ä¸€ä¸ªæºæ–‡ä»¶çš„å·¥ç¨‹æœ‰æ•ˆï¼ŒåŒæ—¶ä¹Ÿå¯¹å¤šä¸ªObjectæ–‡ä»¶ï¼ˆç”±ä¸åŒçš„æºæ–‡ä»¶ç”Ÿæˆï¼‰çš„ä¹Ÿæœ‰æ•ˆã€‚ä¾‹å¦‚å¦‚ä¸‹è§„åˆ™ï¼š<code>x : y.o z.o</code>ã€‚<br>å¹¶ä¸”<code>x.c</code>ã€<code>y.c</code>å’Œ<code>z.c</code>éƒ½å­˜åœ¨æ—¶ï¼Œéšå«è§„åˆ™å°†æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cc -c x.c -o x.o</span><br><span class="line">cc -c y.c -o y.o</span><br><span class="line">cc -c z.c -o z.o</span><br><span class="line">cc x.o y.o z.o -o x</span><br><span class="line">rm -f x.o</span><br><span class="line">rm -f y.o</span><br><span class="line">rm -f z.o</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰ä¸€ä¸ªæºæ–‡ä»¶ï¼ˆå¦‚ä¸Šä¾‹ä¸­çš„x.cï¼‰å’Œä½ çš„ç›®æ ‡åå­—ï¼ˆå¦‚ä¸Šä¾‹ä¸­çš„xï¼‰ç›¸å…³è”ï¼Œé‚£ä¹ˆï¼Œä½ æœ€å¥½å†™å‡ºè‡ªå·±çš„ç”Ÿæˆè§„åˆ™ï¼Œä¸ç„¶ï¼Œéšå«è§„åˆ™ä¼šæŠ¥é”™çš„ã€‚</p></li><li><p>Yacc Cç¨‹åºæ—¶çš„éšå«è§„åˆ™ã€‚<br><code>&lt;n&gt;.c</code>çš„ä¾èµ–æ–‡ä»¶è¢«è‡ªåŠ¨æ¨å¯¼ä¸º<code>n.y</code>ï¼ˆYaccç”Ÿæˆçš„æ–‡ä»¶ï¼‰ï¼Œå…¶ç”Ÿæˆå‘½ä»¤æ˜¯ï¼š<code>$(YACC) $(YFALGS)</code>ã€‚ï¼ˆ<code>Yacc</code>æ˜¯ä¸€ä¸ªè¯­æ³•åˆ†æå™¨ï¼Œå…³äºå…¶ç»†èŠ‚è¯·æŸ¥çœ‹ç›¸å…³èµ„æ–™ï¼‰</p></li><li><p>Lex Cç¨‹åºæ—¶çš„éšå«è§„åˆ™ã€‚<br><code>&lt;n&gt;.c</code>çš„ä¾èµ–æ–‡ä»¶è¢«è‡ªåŠ¨æ¨å¯¼ä¸º<code>n.l</code>ï¼ˆLexç”Ÿæˆçš„æ–‡ä»¶ï¼‰ï¼Œå…¶ç”Ÿæˆå‘½ä»¤æ˜¯ï¼š<code>$(LEX) $(LFALGS)</code>ã€‚ï¼ˆå…³äº<code>Lex</code>çš„ç»†èŠ‚è¯·æŸ¥çœ‹ç›¸å…³èµ„æ–™ï¼‰</p></li><li><p>Lex Ratforç¨‹åºæ—¶çš„éšå«è§„åˆ™ã€‚<br><code>&lt;n&gt;.r</code>çš„ä¾èµ–æ–‡ä»¶è¢«è‡ªåŠ¨æ¨å¯¼ä¸º<code>n.l</code>ï¼ˆLexç”Ÿæˆçš„æ–‡ä»¶ï¼‰ï¼Œå…¶ç”Ÿæˆå‘½ä»¤æ˜¯ï¼š<code>$(LEX) $(LFALGS)</code>ã€‚</p></li><li><p>ä»Cç¨‹åºã€Yaccæ–‡ä»¶æˆ–Lexæ–‡ä»¶åˆ›å»ºLintåº“çš„éšå«è§„åˆ™ã€‚<br><code>&lt;n&gt;.ln</code> ï¼ˆlintç”Ÿæˆçš„æ–‡ä»¶ï¼‰çš„ä¾èµ–æ–‡ä»¶è¢«è‡ªåŠ¨æ¨å¯¼ä¸º<code>n.c</code>ï¼Œå…¶ç”Ÿæˆå‘½ä»¤æ˜¯ï¼š<code>$(LINT) $(LINTFALGS) $(CPPFLAGS) -i</code>ã€‚å¯¹äº<code>&lt;n&gt;.y</code>å’Œ<code>&lt;n&gt;.l</code>ä¹Ÿæ˜¯åŒæ ·çš„è§„åˆ™ã€‚</p></li></ol><h3 id="9-3-éšå«è§„åˆ™ä½¿ç”¨çš„å˜é‡"><a href="#9-3-éšå«è§„åˆ™ä½¿ç”¨çš„å˜é‡" class="headerlink" title="9.3 éšå«è§„åˆ™ä½¿ç”¨çš„å˜é‡"></a>9.3 éšå«è§„åˆ™ä½¿ç”¨çš„å˜é‡</h3><p>åœ¨éšå«è§„åˆ™ä¸­çš„å‘½ä»¤ä¸­ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ä½¿ç”¨äº†ä¸€äº›é¢„å…ˆè®¾ç½®çš„å˜é‡ã€‚ä½ å¯ä»¥åœ¨ä½ çš„makefileä¸­æ”¹å˜è¿™äº›å˜é‡çš„å€¼ï¼Œæˆ–æ˜¯åœ¨makeçš„å‘½ä»¤è¡Œä¸­ä¼ å…¥è¿™äº›å€¼ï¼Œæˆ–æ˜¯åœ¨ä½ çš„ç¯å¢ƒå˜é‡ä¸­è®¾ç½®è¿™äº›å€¼ï¼Œæ— è®ºæ€ä¹ˆæ ·ï¼Œåªè¦è®¾ç½®äº†è¿™äº›ç‰¹å®šçš„å˜é‡ï¼Œé‚£ä¹ˆå…¶å°±ä¼šå¯¹éšå«è§„åˆ™èµ·ä½œç”¨ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åˆ©ç”¨makeçš„â€œ-Râ€æˆ–â€œâ€“noâ€“builtin-variablesâ€å‚æ•°æ¥å–æ¶ˆä½ æ‰€å®šä¹‰çš„å˜é‡å¯¹éšå«è§„åˆ™çš„ä½œç”¨ã€‚</p><p>ä¾‹å¦‚ï¼Œç¬¬ä¸€æ¡éšå«è§„åˆ™â€”â€”ç¼–è¯‘Cç¨‹åºçš„éšå«è§„åˆ™çš„å‘½ä»¤æ˜¯<code>$(CC) â€“c $(CFLAGS) $(CPPFLAGS)</code>ã€‚Makeé»˜è®¤çš„ç¼–è¯‘å‘½ä»¤æ˜¯<code>cc</code>ï¼Œå¦‚æœä½ æŠŠå˜é‡<code>$(CC)</code>é‡å®šä¹‰æˆ<code>gcc</code>ï¼ŒæŠŠå˜é‡<code>$(CFLAGS)</code>é‡å®šä¹‰æˆ<code>-g</code>ï¼Œé‚£ä¹ˆï¼Œéšå«è§„åˆ™ä¸­çš„å‘½ä»¤å…¨éƒ¨ä¼šä»¥<code>gcc â€“c -g $(CPPFLAGS)</code>çš„æ ·å­æ¥æ‰§è¡Œäº†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æŠŠéšå«è§„åˆ™ä¸­ä½¿ç”¨çš„å˜é‡åˆ†æˆä¸¤ç§ï¼šä¸€ç§æ˜¯å‘½ä»¤ç›¸å…³çš„ï¼Œå¦‚<code>CC</code>ï¼›ä¸€ç§æ˜¯å‚æ•°ç›¸çš„å…³ï¼Œå¦‚<code>CFLAGS</code>ã€‚ä¸‹é¢æ˜¯æ‰€æœ‰éšå«è§„åˆ™ä¸­ä¼šç”¨åˆ°çš„å˜é‡ï¼š</p><h4 id="å…³äºå‘½ä»¤çš„å˜é‡"><a href="#å…³äºå‘½ä»¤çš„å˜é‡" class="headerlink" title="å…³äºå‘½ä»¤çš„å˜é‡"></a>å…³äºå‘½ä»¤çš„å˜é‡</h4><ul><li><p><code>AR</code><br>  å‡½æ•°åº“æ‰“åŒ…ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>ar</code>ã€‚ </p></li><li><p><code>AS</code><br>  æ±‡ç¼–è¯­è¨€ç¼–è¯‘ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>as</code>ã€‚</p></li><li><p><code>CC</code><br>  Cè¯­è¨€ç¼–è¯‘ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>cc</code>ã€‚</p></li><li><p><code>CXX</code><br>  C++è¯­è¨€ç¼–è¯‘ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>g++</code>ã€‚</p></li><li><p><code>CO</code><br>  ä» RCSæ–‡ä»¶ä¸­æ‰©å±•æ–‡ä»¶ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>co</code>ã€‚</p></li><li><p><code>CPP</code><br>  Cç¨‹åºçš„é¢„å¤„ç†å™¨ï¼ˆè¾“å‡ºæ˜¯æ ‡å‡†è¾“å‡ºè®¾å¤‡ï¼‰ã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>$(CC) â€“E</code>ã€‚</p></li><li><p><code>FC</code><br>  Fortran å’Œ Ratfor çš„ç¼–è¯‘å™¨å’Œé¢„å¤„ç†ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>f77</code>ã€‚</p></li><li><p><code>GET</code><br>  ä»SCCSæ–‡ä»¶ä¸­æ‰©å±•æ–‡ä»¶çš„ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>get</code>ã€‚ </p></li><li><p><code>LEX</code><br>  Lexæ–¹æ³•åˆ†æå™¨ç¨‹åºï¼ˆé’ˆå¯¹äºCæˆ–Ratforï¼‰ã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>lex</code>ã€‚</p></li><li><p><code>PC</code><br>  Pascalè¯­è¨€ç¼–è¯‘ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>pc</code>ã€‚</p></li><li><p><code>YACC</code><br>  Yaccæ–‡æ³•åˆ†æå™¨ï¼ˆé’ˆå¯¹äºCç¨‹åºï¼‰ã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>yacc</code>ã€‚</p></li><li><p><code>YACCR</code><br>  Yaccæ–‡æ³•åˆ†æå™¨ï¼ˆé’ˆå¯¹äºRatforç¨‹åºï¼‰ã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>yacc â€“r</code>ã€‚</p></li><li><p><code>MAKEINFO</code><br>  è½¬æ¢Texinfoæºæ–‡ä»¶ï¼ˆ.texiï¼‰åˆ°Infoæ–‡ä»¶ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>makeinfo</code>ã€‚</p></li><li><p><code>TEX</code><br>  ä»TeXæºæ–‡ä»¶åˆ›å»ºTeX DVIæ–‡ä»¶çš„ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>tex</code>ã€‚</p></li><li><p><code>TEXI2DVI</code><br>  ä»Texinfoæºæ–‡ä»¶åˆ›å»ºå†›TeX DVI æ–‡ä»¶çš„ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>texi2dvi</code>ã€‚</p></li><li><p><code>WEAVE</code><br>  è½¬æ¢Webåˆ°TeXçš„ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>weave</code>ã€‚</p></li><li><p><code>CWEAVE</code><br>  è½¬æ¢C Webåˆ°TeXçš„ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>cweave</code>ã€‚</p></li><li><p><code>TANGLE</code><br>  è½¬æ¢Webåˆ°Pascalè¯­è¨€çš„ç¨‹åºã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>tangle</code>ã€‚</p></li><li><p><code>CTANGLE</code><br>  è½¬æ¢C Webåˆ°Cã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>ctangle</code>ã€‚</p></li><li><p><code>RM</code><br>  åˆ é™¤æ–‡ä»¶å‘½ä»¤ã€‚é»˜è®¤å‘½ä»¤æ˜¯<code>rm â€“f</code>ã€‚</p></li></ul><h4 id="å…³äºå‚æ•°çš„å˜é‡"><a href="#å…³äºå‚æ•°çš„å˜é‡" class="headerlink" title="å…³äºå‚æ•°çš„å˜é‡"></a>å…³äºå‚æ•°çš„å˜é‡</h4><ul><li><p><code>ARFLAGS</code><br>  å‡½æ•°åº“æ‰“åŒ…ç¨‹åºARå‘½ä»¤çš„å‚æ•°ã€‚é»˜è®¤å€¼æ˜¯<code>rv</code>ã€‚</p></li><li><p><code>ASFLAGS</code><br>  æ±‡ç¼–è¯­è¨€ç¼–è¯‘å™¨å‚æ•°ã€‚ï¼ˆå½“æ˜æ˜¾åœ°è°ƒç”¨<code>.s</code>æˆ–<code>.S</code>æ–‡ä»¶æ—¶ï¼‰ã€‚ </p></li><li><p><code>CFLAGS</code><br>  Cè¯­è¨€ç¼–è¯‘å™¨å‚æ•°ã€‚</p></li><li><p><code>CXXFLAGS</code><br>  C++è¯­è¨€ç¼–è¯‘å™¨å‚æ•°ã€‚</p></li><li><p><code>COFLAGS</code><br>  RCSå‘½ä»¤å‚æ•°ã€‚ </p></li><li><p><code>CPPFLAGS</code><br>  Cé¢„å¤„ç†å™¨å‚æ•°ã€‚ï¼ˆC++å’ŒFortranç¼–è¯‘å™¨ä¹Ÿä¼šç”¨åˆ°ï¼‰ã€‚</p></li><li><p><code>FFLAGS</code><br>  Fortranè¯­è¨€ç¼–è¯‘å™¨å‚æ•°ã€‚</p></li><li><p><code>GFLAGS</code><br>  SCCS â€œgetâ€ç¨‹åºå‚æ•°ã€‚</p></li><li><p><code>LDFLAGS</code><br>  é“¾æ¥å™¨å‚æ•°ã€‚ï¼ˆå¦‚ï¼š<code>ld</code>ï¼‰</p></li><li><p><code>LFLAGS</code><br>  Lexæ–‡æ³•åˆ†æå™¨å‚æ•°ã€‚</p></li><li><p><code>PFLAGS</code><br>  Pascalè¯­è¨€ç¼–è¯‘å™¨å‚æ•°ã€‚</p></li><li><p><code>RFLAGS</code><br>  Ratfor ç¨‹åºçš„Fortranç¼–è¯‘å™¨å‚æ•°ã€‚</p></li><li><p><code>YFLAGS</code><br>  Yaccæ–‡æ³•åˆ†æå™¨å‚æ•°ã€‚</p></li></ul><h3 id="9-4-éšå«è§„åˆ™é“¾"><a href="#9-4-éšå«è§„åˆ™é“¾" class="headerlink" title="9.4 éšå«è§„åˆ™é“¾"></a>9.4 éšå«è§„åˆ™é“¾</h3><p>æœ‰äº›æ—¶å€™ï¼Œä¸€ä¸ªç›®æ ‡å¯èƒ½è¢«ä¸€ç³»åˆ—çš„éšå«è§„åˆ™æ‰€ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª[.o]çš„æ–‡ä»¶ç”Ÿæˆï¼Œå¯èƒ½ä¼šæ˜¯å…ˆè¢«Yaccçš„[.y]æ–‡ä»¶å…ˆæˆ[.c]ï¼Œç„¶åå†è¢«Cçš„ç¼–è¯‘å™¨ç”Ÿæˆã€‚æˆ‘ä»¬æŠŠè¿™ä¸€ç³»åˆ—çš„éšå«è§„åˆ™å«åšâ€œéšå«è§„åˆ™é“¾â€ã€‚</p><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¦‚æœæ–‡ä»¶[.c]å­˜åœ¨ï¼Œé‚£ä¹ˆå°±ç›´æ¥è°ƒç”¨Cçš„ç¼–è¯‘å™¨çš„éšå«è§„åˆ™ï¼Œå¦‚æœæ²¡æœ‰[.c]æ–‡ä»¶ï¼Œä½†æœ‰ä¸€ä¸ª[.y]æ–‡ä»¶ï¼Œé‚£ä¹ˆYaccçš„éšå«è§„åˆ™ä¼šè¢«è°ƒç”¨ï¼Œç”Ÿæˆ[.c]æ–‡ä»¶ï¼Œç„¶åï¼Œå†è°ƒç”¨Cç¼–è¯‘çš„éšå«è§„åˆ™æœ€ç»ˆç”±[.c]ç”Ÿæˆ[.o]æ–‡ä»¶ï¼Œè¾¾åˆ°ç›®æ ‡ã€‚</p><p>æˆ‘ä»¬æŠŠè¿™ç§[.c]çš„æ–‡ä»¶ï¼ˆæˆ–æ˜¯ç›®æ ‡ï¼‰ï¼Œå«åšä¸­é—´ç›®æ ‡ã€‚ä¸ç®¡æ€ä¹ˆæ ·ï¼Œmakeä¼šåŠªåŠ›è‡ªåŠ¨æ¨å¯¼ç”Ÿæˆç›®æ ‡çš„ä¸€åˆ‡æ–¹æ³•ï¼Œä¸ç®¡ä¸­é—´ç›®æ ‡æœ‰å¤šå°‘ï¼Œå…¶éƒ½ä¼šæ‰§ç€åœ°æŠŠæ‰€æœ‰çš„éšå«è§„åˆ™å’Œä½ ä¹¦å†™çš„è§„åˆ™å…¨éƒ¨åˆèµ·æ¥åˆ†æï¼ŒåŠªåŠ›è¾¾åˆ°ç›®æ ‡ã€‚</p><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹äºä¸­é—´ç›®æ ‡ï¼Œå®ƒå’Œä¸€èˆ¬çš„ç›®æ ‡æœ‰ä¸¤ä¸ªåœ°æ–¹æ‰€ä¸åŒï¼šç¬¬ä¸€ä¸ªä¸åŒæ˜¯é™¤éä¸­é—´çš„ç›®æ ‡ä¸å­˜åœ¨ï¼Œæ‰ä¼šå¼•å‘ä¸­é—´è§„åˆ™ã€‚ç¬¬äºŒä¸ªä¸åŒçš„æ˜¯ï¼Œåªè¦ç›®æ ‡æˆåŠŸäº§ç”Ÿï¼Œé‚£ä¹ˆï¼Œäº§ç”Ÿæœ€ç»ˆç›®æ ‡è¿‡ç¨‹ä¸­ï¼Œæ‰€äº§ç”Ÿçš„ä¸­é—´ç›®æ ‡æ–‡ä»¶ä¼šè¢«ä»¥<code>rm -f</code>åˆ é™¤ã€‚</p><p>é€šå¸¸ï¼Œä¸€ä¸ªè¢«makefileæŒ‡å®šæˆç›®æ ‡æˆ–æ˜¯ä¾èµ–ç›®æ ‡çš„æ–‡ä»¶ä¸èƒ½è¢«å½“ä½œä¸­ä»‹ã€‚ç„¶è€Œï¼Œä½ å¯ä»¥æ˜æ˜¾åœ°è¯´æ˜ä¸€ä¸ªæ–‡ä»¶æˆ–æ˜¯ç›®æ ‡æ˜¯ä¸­ä»‹ç›®æ ‡ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¼ªç›®æ ‡<code>.INTERMEDIATE</code>æ¥å¼ºåˆ¶å£°æ˜ã€‚ï¼ˆå¦‚ï¼š<code>.INTERMEDIATEï¼šmid</code>ï¼‰<br>ä½ ä¹Ÿå¯ä»¥é˜»æ­¢makeè‡ªåŠ¨åˆ é™¤ä¸­é—´ç›®æ ‡ï¼Œè¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¼ªç›®æ ‡<code>.SECONDARY</code>æ¥å¼ºåˆ¶å£°æ˜ï¼ˆå¦‚ï¼š<code>.SECONDARY : sec</code>ï¼‰ã€‚ä½ è¿˜å¯ä»¥æŠŠä½ çš„ç›®æ ‡ï¼Œä»¥æ¨¡å¼çš„æ–¹å¼æ¥æŒ‡å®šï¼ˆå¦‚ï¼š<code>%.o</code>ï¼‰æˆä¼ªç›®æ ‡<code>.PRECIOUS</code>çš„ä¾èµ–ç›®æ ‡ï¼Œä»¥ä¿å­˜è¢«éšå«è§„åˆ™æ‰€ç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶ã€‚<br>åœ¨â€œéšå«è§„åˆ™é“¾â€ä¸­ï¼Œç¦æ­¢åŒä¸€ä¸ªç›®æ ‡å‡ºç°ä¸¤æ¬¡æˆ–ä¸¤æ¬¡ä»¥ä¸Šï¼Œè¿™æ ·ä¸€æ¥ï¼Œå°±å¯é˜²æ­¢åœ¨makeè‡ªåŠ¨æ¨å¯¼æ—¶å‡ºç°æ— é™é€’å½’çš„æƒ…å†µã€‚<br>Makeä¼šä¼˜åŒ–ä¸€äº›ç‰¹æ®Šçš„éšå«è§„åˆ™ï¼Œè€Œä¸ç”Ÿæˆä¸­é—´æ–‡ä»¶ã€‚å¦‚ï¼Œä»æ–‡ä»¶<code>foo.c</code>ç”Ÿæˆç›®æ ‡ç¨‹åº<code>foo</code>ï¼ŒæŒ‰é“ç†ï¼Œmakeä¼šç¼–è¯‘ç”Ÿæˆä¸­é—´æ–‡ä»¶<code>foo.o</code>ï¼Œç„¶åé“¾æ¥æˆ<code>foo</code>ï¼Œä½†åœ¨å®é™…æƒ…å†µä¸‹ï¼Œè¿™ä¸€åŠ¨ä½œå¯ä»¥è¢«ä¸€æ¡<code>cc</code>çš„å‘½ä»¤å®Œæˆï¼ˆ<code>cc â€“o foo foo.c</code>ï¼‰ï¼Œäºæ˜¯ä¼˜åŒ–è¿‡çš„è§„åˆ™å°±ä¸ä¼šç”Ÿæˆä¸­é—´æ–‡ä»¶ã€‚</p><h3 id="9-5-å®šä¹‰æ¨¡å¼è§„åˆ™"><a href="#9-5-å®šä¹‰æ¨¡å¼è§„åˆ™" class="headerlink" title="9.5 å®šä¹‰æ¨¡å¼è§„åˆ™"></a>9.5 å®šä¹‰æ¨¡å¼è§„åˆ™</h3><p>ä½ å¯ä»¥ä½¿ç”¨æ¨¡å¼è§„åˆ™æ¥å®šä¹‰ä¸€ä¸ªéšå«è§„åˆ™ã€‚ä¸€ä¸ªæ¨¡å¼è§„åˆ™å°±å¥½åƒä¸€ä¸ªä¸€èˆ¬çš„è§„åˆ™ï¼Œåªæ˜¯åœ¨è§„åˆ™ä¸­ï¼Œç›®æ ‡çš„å®šä¹‰éœ€è¦æœ‰<code>%</code>å­—ç¬¦ã€‚<code>%</code>çš„æ„æ€æ˜¯è¡¨ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦ã€‚åœ¨ä¾èµ–ç›®æ ‡ä¸­åŒæ ·å¯ä»¥ä½¿ç”¨<code>%</code>ï¼Œåªæ˜¯ä¾èµ–ç›®æ ‡ä¸­çš„<code>%</code>çš„å–å€¼ï¼Œå–å†³äºå…¶ç›®æ ‡ã€‚</p><p>æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>%</code>çš„å±•å¼€å‘ç”Ÿåœ¨å˜é‡å’Œå‡½æ•°çš„å±•å¼€ä¹‹åï¼Œå˜é‡å’Œå‡½æ•°çš„å±•å¼€å‘ç”Ÿåœ¨makeè½½å…¥Makefileæ—¶ï¼Œè€Œæ¨¡å¼è§„åˆ™ä¸­çš„<code>%</code>åˆ™å‘ç”Ÿåœ¨è¿è¡Œæ—¶ã€‚</p><h4 id="æ¨¡å¼è§„åˆ™ä»‹ç»"><a href="#æ¨¡å¼è§„åˆ™ä»‹ç»" class="headerlink" title="æ¨¡å¼è§„åˆ™ä»‹ç»"></a>æ¨¡å¼è§„åˆ™ä»‹ç»</h4><p>æ¨¡å¼è§„åˆ™ä¸­ï¼Œè‡³å°‘åœ¨è§„åˆ™çš„<strong>ç›®æ ‡å®šä¹‰</strong>ä¸­è¦åŒ…å«<code>%</code>ï¼Œå¦åˆ™ï¼Œå°±æ˜¯ä¸€èˆ¬çš„è§„åˆ™ã€‚<br>ç›®æ ‡ä¸­çš„<code>%</code>å®šä¹‰è¡¨ç¤ºå¯¹æ–‡ä»¶åçš„åŒ¹é…ï¼Œ<code>%</code>è¡¨ç¤ºé•¿åº¦ä»»æ„çš„éç©ºå­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼š<code>%.c</code>è¡¨ç¤ºä»¥<code>.c</code>ç»“å°¾çš„æ–‡ä»¶åï¼ˆæ–‡ä»¶åçš„é•¿åº¦è‡³å°‘ä¸º3ï¼‰ï¼Œè€Œ<code>s.%.c</code>åˆ™è¡¨ç¤ºä»¥<code>s.</code>å¼€å¤´ï¼Œ<code>.c</code>ç»“å°¾çš„æ–‡ä»¶åï¼ˆæ–‡ä»¶åçš„é•¿åº¦è‡³å°‘ä¸º5ï¼‰ã€‚</p><p>å¦‚æœâ€%â€å®šä¹‰åœ¨ç›®æ ‡ä¸­ï¼Œé‚£ä¹ˆï¼Œ<strong>ç›®æ ‡ä¸­çš„â€%â€çš„å€¼å†³å®šäº†ä¾èµ–ç›®æ ‡ä¸­çš„â€%â€çš„å€¼</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç›®æ ‡ä¸­çš„æ¨¡å¼çš„â€%â€å†³å®šäº†ä¾èµ–ç›®æ ‡ä¸­â€%â€çš„æ ·å­ã€‚ä¾‹å¦‚æœ‰ä¸€ä¸ªæ¨¡å¼è§„åˆ™å¦‚ä¸‹ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%.o : %.c  </span><br><span class="line">    &lt;command ......&gt;</span><br></pre></td></tr></table></figure></p><p>å…¶å«ä¹‰æ˜¯ï¼ŒæŒ‡å‡ºäº†æ€ä¹ˆä»æ‰€æœ‰çš„[.c]æ–‡ä»¶ç”Ÿæˆç›¸åº”çš„[.o]æ–‡ä»¶çš„è§„åˆ™ã€‚å¦‚æœè¦ç”Ÿæˆçš„ç›®æ ‡æ˜¯<code>a.o b.o</code>ï¼Œé‚£ä¹ˆ<code>%.c</code>å°±æ˜¯<code>a.c b.c</code>ã€‚</p><p>ä¸€æ—¦ä¾èµ–ç›®æ ‡ä¸­çš„â€%â€æ¨¡å¼è¢«ç¡®å®šï¼Œé‚£ä¹ˆï¼Œmakeä¼šè¢«è¦æ±‚å»åŒ¹é…å½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶åï¼Œä¸€æ—¦æ‰¾åˆ°ï¼Œmakeå°±ä¼šè§„åˆ™ä¸‹çš„å‘½ä»¤ï¼Œæ‰€ä»¥ï¼Œåœ¨æ¨¡å¼è§„åˆ™ä¸­ï¼Œç›®æ ‡å¯èƒ½ä¼šæ˜¯å¤šä¸ªçš„ï¼Œå¦‚æœæœ‰æ¨¡å¼åŒ¹é…å‡ºå¤šä¸ªç›®æ ‡ï¼Œmakeå°±ä¼šäº§ç”Ÿæ‰€æœ‰çš„æ¨¡å¼ç›®æ ‡ï¼Œæ­¤æ—¶ï¼Œmakeå…³å¿ƒçš„æ˜¯ä¾èµ–çš„æ–‡ä»¶åå’Œç”Ÿæˆç›®æ ‡çš„å‘½ä»¤è¿™ä¸¤ä»¶äº‹ã€‚</p><h4 id="æ¨¡å¼è§„åˆ™ç¤ºä¾‹"><a href="#æ¨¡å¼è§„åˆ™ç¤ºä¾‹" class="headerlink" title="æ¨¡å¼è§„åˆ™ç¤ºä¾‹"></a>æ¨¡å¼è§„åˆ™ç¤ºä¾‹</h4><p>ä¸‹é¢è¿™ä¸ªä¾‹å­è¡¨ç¤º,æŠŠæ‰€æœ‰çš„[.c]æ–‡ä»¶éƒ½ç¼–è¯‘æˆ[.o]æ–‡ä»¶ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%.o : %.c</span><br><span class="line">    <span class="variable">$(CC)</span> -c <span class="variable">$(CFLAGS)</span> <span class="variable">$(CPPFLAGS)</span> <span class="variable">$&lt;</span> -o <span class="variable">$@</span></span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­ï¼Œ<code>$@</code>è¡¨ç¤ºæ‰€æœ‰çš„ç›®æ ‡çš„æŒ¨ä¸ªå€¼ï¼Œ<code>$&lt;</code>è¡¨ç¤ºäº†æ‰€æœ‰ä¾èµ–ç›®æ ‡çš„æŒ¨ä¸ªå€¼ã€‚</p><p>ä¸‹é¢çš„è¿™ä¸ªä¾‹å­ä¸­æœ‰ä¸¤ä¸ªç›®æ ‡æ˜¯æ¨¡å¼çš„ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%.tab.c %.tab.h: %.y</span><br><span class="line">     bison -d <span class="variable">$&lt;</span></span><br></pre></td></tr></table></figure></p><p>è¿™æ¡è§„åˆ™å‘Šè¯‰makeæŠŠæ‰€æœ‰çš„[.y]æ–‡ä»¶éƒ½ä»¥<code>bison -d &lt;n&gt;.y</code>æ‰§è¡Œï¼Œç„¶åç”Ÿæˆ<code>&lt;n&gt;.tab.c</code>å’Œ<code>&lt;n&gt;.tab.h</code>æ–‡ä»¶ã€‚ï¼ˆå…¶ä¸­ï¼Œ<code>&lt;n&gt;</code>è¡¨ç¤ºä¸€ä¸ªä»»æ„å­—ç¬¦ä¸²ï¼‰ã€‚å¦‚æœæˆ‘ä»¬çš„æ‰§è¡Œç¨‹åº<code>foo</code>ä¾èµ–äºæ–‡ä»¶<code>parse.tab.o</code>å’Œ<code>scan.o</code>ï¼Œå¹¶ä¸”æ–‡ä»¶<code>scan.o</code>ä¾èµ–äºæ–‡ä»¶<code>parse.tab.h</code>ï¼Œå¦‚æœ<code>parse.y</code>æ–‡ä»¶è¢«æ›´æ–°äº†ï¼Œé‚£ä¹ˆæ ¹æ®ä¸Šè¿°çš„è§„åˆ™ï¼Œ<code>bison -d parse.y</code>å°±ä¼šè¢«æ‰§è¡Œä¸€æ¬¡ï¼Œäºæ˜¯ï¼Œ<code>parse.tab.o</code>å’Œ<code>scan.o</code>çš„ä¾èµ–æ–‡ä»¶å°±é½äº†ã€‚</p><h4 id="è‡ªåŠ¨åŒ–å˜é‡"><a href="#è‡ªåŠ¨åŒ–å˜é‡" class="headerlink" title="è‡ªåŠ¨åŒ–å˜é‡"></a>è‡ªåŠ¨åŒ–å˜é‡</h4><p>åœ¨ä¸Šè¿°çš„æ¨¡å¼è§„åˆ™ä¸­ï¼Œç›®æ ‡å’Œä¾èµ–æ–‡ä»¶éƒ½æ˜¯ä¸€ç³»ä¾‹çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå¦‚ä½•ä¹¦å†™ä¸€ä¸ªå‘½ä»¤æ¥å®Œæˆä»ä¸åŒçš„ä¾èµ–æ–‡ä»¶ç”Ÿæˆç›¸åº”çš„ç›®æ ‡ï¼Ÿå› ä¸ºåœ¨æ¯ä¸€æ¬¡çš„å¯¹æ¨¡å¼è§„åˆ™çš„è§£ææ—¶ï¼Œéƒ½ä¼šæ˜¯ä¸åŒçš„ç›®æ ‡å’Œä¾èµ–æ–‡ä»¶ã€‚<br>è‡ªåŠ¨åŒ–å˜é‡å°±æ˜¯å®Œæˆè¿™ä¸ªåŠŸèƒ½çš„ã€‚æ‰€è°“è‡ªåŠ¨åŒ–å˜é‡ï¼Œå°±æ˜¯ä¼šæŠŠæ¨¡å¼ä¸­æ‰€å®šä¹‰çš„ä¸€ç³»åˆ—çš„æ–‡ä»¶è‡ªåŠ¨åœ°æŒ¨ä¸ªå–å‡ºï¼Œç›´è‡³æ‰€æœ‰çš„ç¬¦åˆæ¨¡å¼çš„æ–‡ä»¶éƒ½å–å®Œäº†ã€‚è¿™ç§è‡ªåŠ¨åŒ–å˜é‡åªåº”å‡ºç°åœ¨è§„åˆ™çš„å‘½ä»¤ä¸­ã€‚</p><p>ä¸‹é¢æ˜¯æ‰€æœ‰çš„è‡ªåŠ¨åŒ–å˜é‡åŠå…¶è¯´æ˜ï¼š</p><ul><li><p><code>$@</code><br>  è¡¨ç¤ºè§„åˆ™ä¸­çš„ç›®æ ‡æ–‡ä»¶é›†ã€‚åœ¨æ¨¡å¼è§„åˆ™ä¸­ï¼Œå¦‚æœæœ‰å¤šä¸ªç›®æ ‡ï¼Œé‚£ä¹ˆï¼Œ<code>$@</code>å°±æ˜¯åŒ¹é…äºç›®æ ‡ä¸­æ¨¡å¼å®šä¹‰çš„é›†åˆã€‚</p></li><li><p><code>$%</code><br>  <strong>ä»…å½“</strong>ç›®æ ‡æ˜¯å‡½æ•°åº“æ–‡ä»¶ä¸­ï¼Œè¡¨ç¤ºè§„åˆ™ä¸­çš„ç›®æ ‡æˆå‘˜åã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªç›®æ ‡æ˜¯<code>foo.a(bar.o)</code>ï¼Œé‚£ä¹ˆï¼Œ<code>$%&quot;å°±æ˜¯&quot;bar.o</code>ï¼Œ<code>$@&quot;å°±æ˜¯&quot;foo.a</code>ã€‚å¦‚æœç›®æ ‡ä¸æ˜¯å‡½æ•°åº“æ–‡ä»¶ï¼ˆUnixä¸‹æ˜¯[.a]ï¼ŒWindowsä¸‹æ˜¯[.lib]ï¼‰ï¼Œé‚£ä¹ˆï¼Œå…¶å€¼ä¸ºç©ºã€‚</p></li><li><p><code>$&lt;</code><br>  ä¾èµ–ç›®æ ‡ä¸­çš„ç¬¬ä¸€ä¸ªç›®æ ‡åå­—ã€‚å¦‚æœä¾èµ–ç›®æ ‡æ˜¯ä»¥æ¨¡å¼ï¼ˆå³<code>%</code>ï¼‰å®šä¹‰çš„ï¼Œé‚£ä¹ˆ<code>$&lt;</code>å°†æ˜¯ç¬¦åˆæ¨¡å¼çš„ä¸€ç³»åˆ—çš„æ–‡ä»¶é›†ã€‚æ³¨æ„ï¼Œå…¶æ˜¯ä¸€ä¸ªä¸€ä¸ªå–å‡ºæ¥çš„ã€‚</p></li><li><p><code>$?</code><br>  æ‰€æœ‰æ¯”ç›®æ ‡æ–°çš„ä¾èµ–ç›®æ ‡çš„é›†åˆã€‚ä»¥ç©ºæ ¼åˆ†éš”ã€‚</p></li><li><p><code>$^</code><br>  æ‰€æœ‰çš„ä¾èµ–ç›®æ ‡çš„é›†åˆã€‚ä»¥ç©ºæ ¼åˆ†éš”ã€‚å¦‚æœåœ¨ä¾èµ–ç›®æ ‡ä¸­æœ‰å¤šä¸ªé‡å¤çš„ï¼Œé‚£ä¸ªè¿™ä¸ªå˜é‡ä¼šå»é™¤é‡å¤çš„ä¾èµ–ç›®æ ‡ï¼Œåªä¿ç•™ä¸€ä»½ã€‚</p></li><li><p><code>$+</code><br>  è¿™ä¸ªå˜é‡å¾ˆåƒ<code>$^</code>ï¼Œä¹Ÿæ˜¯æ‰€æœ‰ä¾èµ–ç›®æ ‡çš„é›†åˆã€‚åªæ˜¯å®ƒä¸å»é™¤é‡å¤çš„ä¾èµ–ç›®æ ‡ã€‚</p></li><li><p><code>$*</code><br>  è¿™ä¸ªå˜é‡è¡¨ç¤ºç›®æ ‡æ¨¡å¼ä¸­<code>%</code>åŠå…¶ä¹‹å‰çš„éƒ¨åˆ†ã€‚å¦‚æœç›®æ ‡æ˜¯<code>dir/a.foo.b</code>ï¼Œå¹¶ä¸”ç›®æ ‡çš„æ¨¡å¼æ˜¯<code>a.%.b</code>ï¼Œé‚£ä¹ˆï¼Œ<code>$*</code>çš„å€¼å°±æ˜¯<code>dir/a.foo</code>ã€‚è¿™ä¸ªå˜é‡å¯¹äºæ„é€ æœ‰å…³è”çš„æ–‡ä»¶åæ˜¯æ¯”è¾ƒæœ‰ç”¨ã€‚<br>  å¦‚æœç›®æ ‡ä¸­æ²¡æœ‰æ¨¡å¼çš„å®šä¹‰ï¼Œé‚£ä¹ˆ<code>$*</code>ä¹Ÿå°±ä¸èƒ½è¢«æ¨å¯¼å‡ºï¼Œä½†æ˜¯ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶çš„åç¼€æ˜¯makeæ‰€è¯†åˆ«çš„ï¼Œé‚£ä¹ˆ<code>$*</code>å°±æ˜¯é™¤äº†åç¼€çš„é‚£ä¸€éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼šå¦‚æœç›®æ ‡æ˜¯<code>foo.c</code>ï¼Œå› ä¸º<code>.c</code>æ˜¯makeæ‰€èƒ½è¯†åˆ«çš„åç¼€åï¼Œæ‰€ä»¥ï¼Œ<code>$*</code>çš„å€¼å°±æ˜¯<code>foo</code>ã€‚è¿™ä¸ªç‰¹æ€§æ˜¯GNU makeçš„ï¼Œå¾ˆæœ‰å¯èƒ½ä¸å…¼å®¹äºå…¶å®ƒç‰ˆæœ¬çš„makeã€‚</p></li></ul><p>å½“ä½ å¸Œæœ›åªå¯¹æ›´æ–°è¿‡çš„ä¾èµ–æ–‡ä»¶è¿›è¡Œæ“ä½œæ—¶ï¼Œâ€$?â€åœ¨æ˜¾å¼è§„åˆ™ä¸­å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ªå‡½æ•°åº“æ–‡ä»¶å«â€libâ€ï¼Œå…¶ç”±å…¶å®ƒå‡ ä¸ªobjectæ–‡ä»¶æ›´æ–°ã€‚é‚£ä¹ˆæŠŠobjectæ–‡ä»¶æ‰“åŒ…çš„æ¯”è¾ƒæœ‰æ•ˆç‡çš„Makefileè§„åˆ™æ˜¯ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lib : foo.o bar.o lose.o win.o</span><br><span class="line">    ar r lib <span class="variable">$?</span></span><br></pre></td></tr></table></figure></p><p>åœ¨ä¸Šè¿°æ‰€åˆ—å‡ºæ¥çš„è‡ªåŠ¨é‡å˜é‡ä¸­ã€‚å››ä¸ªå˜é‡ï¼ˆ<code>$@</code>ã€<code>$&lt;</code>ã€<code>$%</code>ã€<code>$*</code>ï¼‰åœ¨æ‰©å±•æ—¶åªä¼šæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œå¦ä¸‰ä¸ªçš„å€¼æ˜¯ä¸€ä¸ªæ–‡ä»¶åˆ—è¡¨ã€‚</p><p>è¿™ä¸ƒä¸ªè‡ªåŠ¨åŒ–å˜é‡è¿˜å¯ä»¥å–å¾—æ–‡ä»¶çš„ç›®å½•åæˆ–æ˜¯åœ¨å½“å‰ç›®å½•ä¸‹çš„ç¬¦åˆæ¨¡å¼çš„æ–‡ä»¶åï¼Œåªéœ€è¦æ­é…ä¸Šâ€Dâ€æˆ–â€Fâ€å­—æ ·ã€‚<br>ä¾‹å¦‚ï¼Œ<code>$(@D)</code>è¡¨ç¤º<code>$@</code>çš„ç›®å½•éƒ¨åˆ†ï¼ˆä¸ä»¥æ–œæ ä½œä¸ºç»“å°¾ï¼‰ï¼Œå¦‚æœ<code>$@</code>å€¼æ˜¯<code>dir/foo.o</code>ï¼Œé‚£ä¹ˆ<code>$(@D)</code>å°±æ˜¯<code>dir</code>ï¼Œè€Œå¦‚æœâ€$@â€ä¸­æ²¡æœ‰åŒ…å«æ–œæ çš„è¯ï¼Œå…¶å€¼å°±æ˜¯â€.â€ï¼ˆå½“å‰ç›®å½•ï¼‰ã€‚<br><code>$(@F)</code>è¡¨ç¤ºâ€$@â€çš„æ–‡ä»¶éƒ¨åˆ†ï¼Œå¦‚æœ<code>$@</code>å€¼æ˜¯<code>dir/foo.o</code>ï¼Œé‚£ä¹ˆ<code>$(@F)</code>å°±æ˜¯<code>foo.o</code>ï¼Œ<code>$(@F)</code>ç›¸å½“äºå‡½æ•°<code>$(notdir $@)</code>ã€‚</p><h4 id="æ¨¡å¼çš„åŒ¹é…"><a href="#æ¨¡å¼çš„åŒ¹é…" class="headerlink" title="æ¨¡å¼çš„åŒ¹é…"></a>æ¨¡å¼çš„åŒ¹é…</h4><p>ä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªç›®æ ‡çš„æ¨¡å¼æœ‰ä¸€ä¸ªæœ‰å‰ç¼€æˆ–æ˜¯åç¼€çš„<code>%</code>ï¼Œæˆ–æ˜¯æ²¡æœ‰å‰åç¼€ï¼Œç›´æ¥å°±æ˜¯ä¸€ä¸ª<code>%</code>ã€‚å› ä¸º<code>%</code>ä»£è¡¨ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥åœ¨å®šä¹‰å¥½äº†çš„æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬æŠŠ<code>%</code>æ‰€åŒ¹é…çš„å†…å®¹å«åšâ€œèŒâ€ï¼Œä¾‹å¦‚<code>%.c</code>æ‰€åŒ¹é…çš„æ–‡ä»¶<code>test.c</code>ä¸­<code>test</code>å°±æ˜¯â€œèŒâ€ã€‚å› ä¸ºåœ¨ç›®æ ‡å’Œä¾èµ–ç›®æ ‡ä¸­åŒæ—¶æœ‰<code>%</code>æ—¶ï¼Œä¾èµ–ç›®æ ‡çš„â€œèŒâ€ä¼šä¼ ç»™ç›®æ ‡ï¼Œå½“åšç›®æ ‡ä¸­çš„â€œèŒâ€ã€‚</p><p>å½“ä¸€ä¸ªæ¨¡å¼åŒ¹é…åŒ…å«æœ‰æ–œæ ï¼ˆå®é™…ä¹Ÿä¸ç»å¸¸åŒ…å«ï¼‰çš„æ–‡ä»¶æ—¶ï¼Œé‚£ä¹ˆåœ¨è¿›è¡Œæ¨¡å¼åŒ¹é…æ—¶ï¼Œç›®å½•éƒ¨åˆ†ä¼šé¦–å…ˆè¢«ç§»å¼€ï¼Œç„¶åè¿›è¡ŒåŒ¹é…ï¼ŒæˆåŠŸåï¼Œå†æŠŠç›®å½•åŠ å›å»ã€‚åœ¨è¿›è¡Œâ€œèŒâ€çš„ä¼ é€’æ—¶ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“è¿™ä¸ªæ­¥éª¤ã€‚ä¾‹å¦‚æœ‰ä¸€ä¸ªæ¨¡å¼<code>e%t</code>ï¼Œæ–‡ä»¶<code>src/eat</code>åŒ¹é…äºè¯¥æ¨¡å¼ï¼Œäºæ˜¯<code>src/a</code>å°±æ˜¯å…¶â€œèŒâ€ï¼Œå¦‚æœè¿™ä¸ªæ¨¡å¼å®šä¹‰åœ¨ä¾èµ–ç›®æ ‡ä¸­ï¼Œè€Œè¢«ä¾èµ–äºè¿™ä¸ªæ¨¡å¼çš„ç›®æ ‡ä¸­åˆæœ‰ä¸ªæ¨¡å¼<code>c%r</code>ï¼Œé‚£ä¹ˆï¼Œç›®æ ‡å°±æ˜¯<code>src/car</code>ã€‚ï¼ˆâ€èŒâ€è¢«ä¼ é€’ï¼‰</p><h4 id="é‡è½½å†…å»ºéšå«è§„åˆ™"><a href="#é‡è½½å†…å»ºéšå«è§„åˆ™" class="headerlink" title="é‡è½½å†…å»ºéšå«è§„åˆ™"></a>é‡è½½å†…å»ºéšå«è§„åˆ™</h4><p>å¯ä»¥é‡è½½å†…å»ºçš„éšå«è§„åˆ™ï¼ˆæˆ–æ˜¯å®šä¹‰ä¸€ä¸ªå…¨æ–°çš„ï¼‰ï¼Œä¾‹å¦‚ä½ å¯ä»¥é‡æ–°æ„é€ å’Œå†…å»ºéšå«è§„åˆ™ä¸åŒçš„å‘½ä»¤ï¼Œå¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%.o : %.c</span><br><span class="line">    <span class="variable">$(CC)</span> -c <span class="variable">$(CPPFLAGS)</span> <span class="variable">$(CFLAGS)</span> -D<span class="variable">$(date)</span></span><br></pre></td></tr></table></figure></p><p>ä½ å¯ä»¥å–æ¶ˆå†…å»ºçš„éšå«è§„åˆ™ï¼Œåªè¦ä¸åœ¨åé¢å†™å‘½ä»¤å°±è¡Œã€‚å¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%.o : %.s</span><br></pre></td></tr></table></figure></p><p>åŒæ ·ï¼Œä½ ä¹Ÿå¯ä»¥é‡æ–°å®šä¹‰ä¸€ä¸ªå…¨æ–°çš„éšå«è§„åˆ™ï¼Œå…¶åœ¨éšå«è§„åˆ™ä¸­çš„ä½ç½®å–å†³äºä½ åœ¨å“ªé‡Œå†™ä¸‹è¿™ä¸ªè§„åˆ™ã€‚æœå‰çš„ä½ç½®å°±é å‰ã€‚</p><h3 id="9-6-è€å¼é£æ ¼çš„â€åç¼€è§„åˆ™â€"><a href="#9-6-è€å¼é£æ ¼çš„â€åç¼€è§„åˆ™â€" class="headerlink" title="9.6 è€å¼é£æ ¼çš„â€åç¼€è§„åˆ™â€"></a>9.6 è€å¼é£æ ¼çš„â€åç¼€è§„åˆ™â€</h3><p>å‰é¢æ‰€è¯´çš„<code>%.c:%.o</code>ä¸ºæ¨¡å¼è§„åˆ™ï¼Œè¿˜æœ‰ä¸€ç§è¾ƒè€çš„æ–¹å¼<code>.c.o</code>ä¸ºåç¼€è§„åˆ™ã€‚åç¼€è§„åˆ™æœ‰ä¸¤ç§æ–¹å¼ï¼šâ€åŒåç¼€â€å’Œâ€å•åç¼€â€ã€‚</p><p>åŒåç¼€è§„åˆ™å®šä¹‰äº†ä¸€å¯¹åç¼€ï¼šç›®æ ‡æ–‡ä»¶çš„åç¼€å’Œä¾èµ–ç›®æ ‡ï¼ˆæºæ–‡ä»¶ï¼‰çš„åç¼€ã€‚å¦‚<code>.c.o</code>ç›¸å½“äº<code>%o : %c</code>ã€‚<br>å•åç¼€è§„åˆ™åªå®šä¹‰ä¸€ä¸ªåç¼€ï¼Œä¹Ÿå°±æ˜¯æºæ–‡ä»¶çš„åç¼€ã€‚å¦‚<code>.c</code>ç›¸å½“äº<code>% : %.c</code>ã€‚</p><p>åç¼€è§„åˆ™ä¸­æ‰€å®šä¹‰çš„åç¼€åº”è¯¥æ˜¯makeæ‰€è®¤è¯†çš„ï¼Œå¦‚æœä¸€ä¸ªåç¼€æ˜¯makeæ‰€è®¤è¯†çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªè§„åˆ™å°±æ˜¯å•åç¼€è§„åˆ™ï¼Œè€Œå¦‚æœä¸¤ä¸ªè¿åœ¨ä¸€èµ·çš„åç¼€éƒ½è¢«makeæ‰€è®¤è¯†ï¼Œé‚£å°±æ˜¯åŒåç¼€è§„åˆ™ã€‚<br>ä¾‹å¦‚ï¼š<code>.c</code>å’Œ<code>.o</code>éƒ½æ˜¯makeæ‰€çŸ¥é“ã€‚å› è€Œï¼Œå¦‚æœä½ å®šä¹‰äº†ä¸€ä¸ªè§„åˆ™æ˜¯<code>.c.o</code>é‚£ä¹ˆå…¶å°±æ˜¯åŒåç¼€è§„åˆ™ï¼Œæ„ä¹‰å°±æ˜¯<code>.c</code>æ˜¯æºæ–‡ä»¶çš„åç¼€ï¼Œ<code>.o</code>æ˜¯ç›®æ ‡æ–‡ä»¶çš„åç¼€ã€‚å¦‚ä¸‹ç¤ºä¾‹ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">.c.o:</span></span><br><span class="line">    <span class="variable">$(CC)</span> -c <span class="variable">$(CFLAGS)</span> <span class="variable">$(CPPFLAGS)</span> -o <span class="variable">$@</span> <span class="variable">$&lt;</span></span><br></pre></td></tr></table></figure></p><p>åç¼€è§„åˆ™ä¸å…è®¸ä»»ä½•çš„ä¾èµ–æ–‡ä»¶ï¼Œå¦‚æœæœ‰ä¾èµ–æ–‡ä»¶çš„è¯ï¼Œé‚£å°±ä¸æ˜¯åç¼€è§„åˆ™ï¼Œé‚£äº›åç¼€ç»Ÿç»Ÿè¢«è®¤ä¸ºæ˜¯æ–‡ä»¶åï¼Œå¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">.c.o: foo.h</span></span><br><span class="line">    <span class="variable">$(CC)</span> -c <span class="variable">$(CFLAGS)</span> <span class="variable">$(CPPFLAGS)</span> -o <span class="variable">$@</span> <span class="variable">$&lt;</span></span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªä¾‹å­çš„æ„æ€ä¸ºæ–‡ä»¶<code>.c.o</code>ä¾èµ–äºæ–‡ä»¶<code>foo.h</code>ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„è¿™æ ·ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">%.o: %.c foo.h</span></span><br><span class="line">    <span class="variable">$(CC)</span> -c <span class="variable">$(CFLAGS)</span> <span class="variable">$(CPPFLAGS)</span> -o <span class="variable">$@</span> <span class="variable">$&lt;</span></span><br></pre></td></tr></table></figure></p><p>åç¼€è§„åˆ™ä¸­ï¼Œå¦‚æœæ²¡æœ‰å‘½ä»¤ï¼Œé‚£æ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚å› ä¸ºä»–ä¹Ÿä¸ä¼šç§»å»å†…å»ºçš„éšå«è§„åˆ™ã€‚</p><p>è€Œè¦è®©makeçŸ¥é“ä¸€äº›ç‰¹å®šçš„åç¼€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¼ªç›®æ ‡<code>.SUFFIXES</code>æ¥å®šä¹‰æˆ–æ˜¯åˆ é™¤ï¼Œå¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">.SUFFIXES: .hack .win</span></span><br></pre></td></tr></table></figure></p><p>æŠŠåç¼€.hackå’Œ.winåŠ å…¥åç¼€åˆ—è¡¨ä¸­çš„æœ«å°¾ã€‚<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">.SUFFIXES:              # åˆ é™¤é»˜è®¤çš„åç¼€</span></span><br><span class="line"><span class="section">.SUFFIXES: .c .o .h   # å®šä¹‰è‡ªå·±çš„åç¼€</span></span><br></pre></td></tr></table></figure></p><p>å…ˆæ¸…é™¤é»˜è®¤åç¼€ï¼Œåå®šä¹‰è‡ªå·±çš„åç¼€åˆ—è¡¨ã€‚</p><p>makeçš„å‚æ•°<code>-r</code>æˆ–<code>-no-builtin-rules</code>ä¹Ÿä¼šä½¿ç”¨å¾—é»˜è®¤çš„åç¼€åˆ—è¡¨ä¸ºç©ºã€‚è€Œå˜é‡<code>SUFFIXE</code>è¢«ç”¨æ¥å®šä¹‰é»˜è®¤çš„åç¼€åˆ—è¡¨ï¼Œä½ å¯ä»¥ç”¨<code>.SUFFIXES</code>æ¥æ”¹å˜åç¼€åˆ—è¡¨ï¼Œä½†è¯·ä¸è¦æ”¹å˜å˜é‡<code>SUFFIXE</code>çš„å€¼ã€‚</p><h3 id="9-7-éšå«è§„åˆ™æœç´¢ç®—æ³•"><a href="#9-7-éšå«è§„åˆ™æœç´¢ç®—æ³•" class="headerlink" title="9.7 éšå«è§„åˆ™æœç´¢ç®—æ³•"></a>9.7 éšå«è§„åˆ™æœç´¢ç®—æ³•</h3><p>æ¯”å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªç›®æ ‡å« <code>T</code>ï¼Œä¸‹é¢æ˜¯æœç´¢ç›®æ ‡<code>T</code>çš„è§„åˆ™çš„ç®—æ³•ã€‚<br>å¦‚æœç›®æ ‡æ˜¯<code>archive(member)&quot;</code>çš„å‡½æ•°åº“æ–‡ä»¶æ¨¡å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªç®—æ³•ä¼šè¢«è¿è¡Œä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡æ˜¯æ‰¾ç›®æ ‡<code>T</code>ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°çš„è¯ï¼Œé‚£ä¹ˆè¿›å…¥ç¬¬äºŒæ¬¡ï¼Œç¬¬äºŒæ¬¡ä¼šæŠŠ<code>member</code>å½“ä½œ<code>T</code>æ¥æœç´¢ã€‚</p><ol><li><p>æŠŠ<code>T</code>çš„ç›®å½•éƒ¨åˆ†åˆ†ç¦»å‡ºæ¥ã€‚å«<code>D</code>ï¼Œè€Œå‰©ä½™éƒ¨åˆ†å«<code>N</code>ã€‚ï¼ˆå¦‚ï¼šå¦‚æœ<code>T</code>æ˜¯<code>src/foo.o</code>ï¼Œé‚£ä¹ˆï¼Œ<code>D</code>å°±æ˜¯<code>src/</code>ï¼Œ<code>N</code>å°±æ˜¯<code>foo.o</code>ï¼‰</p></li><li><p>åˆ›å»ºæ‰€æœ‰åŒ¹é…äºTæˆ–æ˜¯Nçš„æ¨¡å¼è§„åˆ™åˆ—è¡¨ã€‚</p></li><li><p>å¦‚æœåœ¨æ¨¡å¼è§„åˆ™åˆ—è¡¨ä¸­æœ‰åŒ¹é…æ‰€æœ‰æ–‡ä»¶çš„æ¨¡å¼ï¼Œå¦‚<code>%</code>ï¼Œé‚£ä¹ˆä»åˆ—è¡¨ä¸­ç§»é™¤å…¶å®ƒçš„æ¨¡å¼ã€‚</p></li><li><p>ç§»é™¤åˆ—è¡¨ä¸­æ²¡æœ‰å‘½ä»¤çš„è§„åˆ™ã€‚</p></li><li><p>å¯¹äºç¬¬ä¸€ä¸ªåœ¨åˆ—è¡¨ä¸­çš„æ¨¡å¼è§„åˆ™ï¼š<br> 1ï¼‰æ¨å¯¼å…¶â€èŒâ€<code>S</code>ï¼Œ<code>S</code>åº”è¯¥æ˜¯Tæˆ–æ˜¯<code>N</code>åŒ¹é…äºæ¨¡å¼ä¸­<code>%</code>éç©ºçš„éƒ¨åˆ†ã€‚<br> 2ï¼‰è®¡ç®—ä¾èµ–æ–‡ä»¶ã€‚æŠŠä¾èµ–æ–‡ä»¶ä¸­çš„<code>%</code>éƒ½æ›¿æ¢æˆâ€èŒâ€<code>S</code>ã€‚å¦‚æœç›®æ ‡æ¨¡å¼ä¸­æ²¡æœ‰åŒ…å«æ–œæ¡†å­—ç¬¦ï¼Œè€ŒæŠŠ<code>D</code>åŠ åœ¨ç¬¬ä¸€ä¸ªä¾èµ–æ–‡ä»¶çš„å¼€å¤´ã€‚<br> 3ï¼‰æµ‹è¯•æ˜¯å¦æ‰€æœ‰çš„ä¾èµ–æ–‡ä»¶éƒ½å­˜åœ¨æˆ–æ˜¯ç†å½“å­˜åœ¨ã€‚ï¼ˆå¦‚æœæœ‰ä¸€ä¸ªæ–‡ä»¶è¢«å®šä¹‰æˆå¦å¤–ä¸€ä¸ªè§„åˆ™çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªæ˜¾å¼è§„åˆ™çš„ä¾èµ–æ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶å°±å«â€ç†å½“å­˜åœ¨â€ï¼‰<br> 4ï¼‰å¦‚æœæ‰€æœ‰çš„ä¾èµ–æ–‡ä»¶å­˜åœ¨æˆ–æ˜¯ç†å½“å­˜åœ¨ï¼Œæˆ–æ˜¯å°±æ²¡æœ‰ä¾èµ–æ–‡ä»¶ã€‚é‚£ä¹ˆè¿™æ¡è§„åˆ™å°†è¢«é‡‡ç”¨ï¼Œé€€å‡ºè¯¥ç®—æ³•ã€‚</p></li><li><p>å¦‚æœç»è¿‡ç¬¬5æ­¥ï¼Œæ²¡æœ‰æ¨¡å¼è§„åˆ™è¢«æ‰¾åˆ°ï¼Œé‚£ä¹ˆå°±åšæ›´è¿›ä¸€æ­¥çš„æœç´¢ã€‚å¯¹äºå­˜åœ¨äºåˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªæ¨¡å¼è§„åˆ™ï¼š<br> 1ï¼‰å¦‚æœè§„åˆ™æ˜¯ç»ˆæ­¢è§„åˆ™ï¼Œé‚£å°±å¿½ç•¥å®ƒï¼Œç»§ç»­ä¸‹ä¸€æ¡æ¨¡å¼è§„åˆ™ã€‚<br> 2ï¼‰è®¡ç®—ä¾èµ–æ–‡ä»¶ã€‚ï¼ˆåŒç¬¬5æ­¥ï¼‰<br> 3ï¼‰æµ‹è¯•æ‰€æœ‰çš„ä¾èµ–æ–‡ä»¶æ˜¯å¦å­˜åœ¨æˆ–æ˜¯ç†å½“å­˜åœ¨ã€‚<br> 4ï¼‰å¯¹äºä¸å­˜åœ¨çš„ä¾èµ–æ–‡ä»¶ï¼Œé€’å½’è°ƒç”¨è¿™ä¸ªç®—æ³•æŸ¥æ‰¾ä»–æ˜¯å¦å¯ä»¥è¢«éšå«è§„åˆ™æ‰¾åˆ°ã€‚<br> 5ï¼‰å¦‚æœæ‰€æœ‰çš„ä¾èµ–æ–‡ä»¶å­˜åœ¨æˆ–æ˜¯ç†å½“å­˜åœ¨ï¼Œæˆ–æ˜¯å°±æ ¹æœ¬æ²¡æœ‰ä¾èµ–æ–‡ä»¶ã€‚é‚£ä¹ˆè¿™æ¡è§„åˆ™è¢«é‡‡ç”¨ï¼Œé€€å‡ºè¯¥ç®—æ³•ã€‚</p></li><li><p>å¦‚æœæ²¡æœ‰éšå«è§„åˆ™å¯ä»¥ä½¿ç”¨ï¼ŒæŸ¥çœ‹<code>.DEFAULT</code>è§„åˆ™ï¼Œå¦‚æœæœ‰ï¼Œé‡‡ç”¨ï¼ŒæŠŠ<code>.DEFAULT</code>çš„å‘½ä»¤ç»™<code>T</code>ä½¿ç”¨ã€‚</p></li></ol><p>ä¸€æ—¦è§„åˆ™è¢«æ‰¾åˆ°ï¼Œå°±ä¼šæ‰§è¡Œå…¶ç›¸å½“çš„å‘½ä»¤ï¼Œè€Œæ­¤æ—¶ï¼Œæˆ‘ä»¬çš„è‡ªåŠ¨åŒ–å˜é‡çš„å€¼æ‰ä¼šç”Ÿæˆã€‚</p><hr><h2 id="10-ä½¿ç”¨makeæ›´æ–°å‡½æ•°åº“æ–‡ä»¶"><a href="#10-ä½¿ç”¨makeæ›´æ–°å‡½æ•°åº“æ–‡ä»¶" class="headerlink" title="10 ä½¿ç”¨makeæ›´æ–°å‡½æ•°åº“æ–‡ä»¶"></a>10 ä½¿ç”¨makeæ›´æ–°å‡½æ•°åº“æ–‡ä»¶</h2><p>å‡½æ•°åº“æ–‡ä»¶ä¹Ÿå°±æ˜¯å¯¹Objectæ–‡ä»¶ï¼ˆç¨‹åºç¼–è¯‘çš„ä¸­é—´æ–‡ä»¶ï¼‰çš„æ‰“åŒ…æ–‡ä»¶ã€‚åœ¨Unixä¸‹ï¼Œä¸€èˆ¬æ˜¯ç”±å‘½ä»¤â€arâ€æ¥å®Œæˆæ‰“åŒ…å·¥ä½œã€‚</p><h3 id="10-1-å‡½æ•°åº“æ–‡ä»¶çš„æˆå‘˜"><a href="#10-1-å‡½æ•°åº“æ–‡ä»¶çš„æˆå‘˜" class="headerlink" title="10.1 å‡½æ•°åº“æ–‡ä»¶çš„æˆå‘˜"></a>10.1 å‡½æ•°åº“æ–‡ä»¶çš„æˆå‘˜</h3><p>ä¸€ä¸ªå‡½æ•°åº“æ–‡ä»¶ç”±å¤šä¸ªæ–‡ä»¶ç»„æˆã€‚ä½ å¯ä»¥ä»¥å¦‚ä¸‹æ ¼å¼æŒ‡å®šå‡½æ•°åº“æ–‡ä»¶åŠå…¶ç»„æˆï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">archive(member)</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªä¸æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œè€Œä¸€ä¸ªç›®æ ‡å’Œä¾èµ–çš„å®šä¹‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ç§ç”¨æ³•åŸºæœ¬ä¸Šå°±æ˜¯ä¸ºäº†<code>ar</code>å‘½ä»¤æ¥æœåŠ¡çš„ã€‚å¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">foolib(hack.o) : hack.o</span><br><span class="line">    ar cr foolib hack.o</span><br></pre></td></tr></table></figure></p><p>å¦‚æœè¦æŒ‡å®šå¤šä¸ªmemberï¼Œé‚£å°±ä»¥ç©ºæ ¼åˆ†å¼€ï¼Œå¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">foolib(hack.o kludge.o)</span><br><span class="line"><span class="comment">#ç­‰ä»·äºï¼š</span></span><br><span class="line">foolib(hack.o) foolib(kludge.o)</span><br></pre></td></tr></table></figure></p><p>è¿˜å¯ä»¥ä½¿ç”¨Shellçš„æ–‡ä»¶é€šé…ç¬¦æ¥å®šä¹‰ï¼š<code>foolib(*.o)</code></p><h3 id="10-2-å‡½æ•°åº“æˆå‘˜çš„éšå«è§„åˆ™"><a href="#10-2-å‡½æ•°åº“æˆå‘˜çš„éšå«è§„åˆ™" class="headerlink" title="10.2 å‡½æ•°åº“æˆå‘˜çš„éšå«è§„åˆ™"></a>10.2 å‡½æ•°åº“æˆå‘˜çš„éšå«è§„åˆ™</h3><p>å½“makeæœç´¢ä¸€ä¸ªç›®æ ‡çš„éšå«è§„åˆ™æ—¶ï¼Œä¸€ä¸ªç‰¹æ®Šçš„ç‰¹æ€§æ˜¯ï¼Œå¦‚æœè¿™ä¸ªç›®æ ‡æ˜¯<code>a(m)</code>å½¢å¼çš„ï¼Œå…¶ä¼šæŠŠç›®æ ‡å˜æˆ<code>(m)</code>ã€‚äºæ˜¯ï¼Œå¦‚æœæˆ‘ä»¬çš„æˆå‘˜æ˜¯<code>%.o</code>çš„æ¨¡å¼å®šä¹‰ï¼Œå¹¶ä¸”å¦‚æœæˆ‘ä»¬ä½¿ç”¨<code>make foo.a(bar.o)</code>çš„å½¢å¼è°ƒç”¨Makefileæ—¶ï¼Œéšå«è§„åˆ™ä¼šå»æ‰¾<code>bar.o</code>çš„è§„åˆ™ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰<code>bar.o</code>çš„è§„åˆ™ï¼Œé‚£ä¹ˆå†…å»ºéšå«è§„åˆ™ç”Ÿæ•ˆï¼Œmakeä¼šå»æ‰¾<code>bar.c</code>æ–‡ä»¶æ¥ç”Ÿæˆ<code>bar.o</code>ï¼Œå¦‚æœæ‰¾å¾—åˆ°çš„è¯ï¼Œmakeæ‰§è¡Œçš„å‘½ä»¤å¤§è‡´å¦‚ä¸‹ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cc -c bar.c -o bar.o</span><br><span class="line">ar r foo.a bar.o</span><br><span class="line">rm -f bar.o</span><br></pre></td></tr></table></figure></p><h3 id="10-3-å‡½æ•°åº“æ–‡ä»¶çš„åç¼€è§„åˆ™"><a href="#10-3-å‡½æ•°åº“æ–‡ä»¶çš„åç¼€è§„åˆ™" class="headerlink" title="10.3 å‡½æ•°åº“æ–‡ä»¶çš„åç¼€è§„åˆ™"></a>10.3 å‡½æ•°åº“æ–‡ä»¶çš„åç¼€è§„åˆ™</h3><p>å¯ä»¥ä½¿ç”¨â€åç¼€è§„åˆ™â€å’Œâ€éšå«è§„åˆ™â€æ¥ç”Ÿæˆå‡½æ•°åº“æ‰“åŒ…æ–‡ä»¶ï¼Œå¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">.c.a:</span></span><br><span class="line">    <span class="variable">$(CC)</span> <span class="variable">$(CFLAGS)</span> <span class="variable">$(CPPFLAGS)</span> -c <span class="variable">$&lt;</span> -o <span class="variable">$*</span>.o</span><br><span class="line">    <span class="variable">$(AR)</span> r <span class="variable">$@</span> <span class="variable">$*</span>.o</span><br><span class="line">    <span class="variable">$(RM)</span> <span class="variable">$*</span>.o</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ç­‰æ•ˆäºï¼š</span></span><br><span class="line">(%.o) : %.c</span><br><span class="line">    <span class="variable">$(CC)</span> <span class="variable">$(CFLAGS)</span> <span class="variable">$(CPPFLAGS)</span> -c <span class="variable">$&lt;</span> -o <span class="variable">$*</span>.o</span><br><span class="line">    <span class="variable">$(AR)</span> r <span class="variable">$@</span> <span class="variable">$*</span>.o</span><br><span class="line">    <span class="variable">$(RM)</span> <span class="variable">$*</span>.o</span><br></pre></td></tr></table></figure></p><h3 id="10-4-æ³¨æ„äº‹é¡¹"><a href="#10-4-æ³¨æ„äº‹é¡¹" class="headerlink" title="10.4 æ³¨æ„äº‹é¡¹"></a>10.4 æ³¨æ„äº‹é¡¹</h3><p>åœ¨è¿›è¡Œå‡½æ•°åº“æ‰“åŒ…æ–‡ä»¶ç”Ÿæˆæ—¶ï¼Œè¯·å°å¿ƒä½¿ç”¨makeçš„å¹¶è¡Œæœºåˆ¶ï¼ˆ<code>-j</code>å‚æ•°ï¼‰ã€‚å¦‚æœå¤šä¸ªarå‘½ä»¤åœ¨åŒä¸€æ—¶é—´è¿è¡Œåœ¨åŒä¸€ä¸ªå‡½æ•°åº“æ‰“åŒ…æ–‡ä»¶ä¸Šï¼Œå°±å¾ˆæœ‰å¯ä»¥æŸåè¿™ä¸ªå‡½æ•°åº“æ–‡ä»¶ã€‚æ‰€ä»¥ï¼Œåœ¨makeæœªæ¥çš„ç‰ˆæœ¬ä¸­ï¼Œåº”è¯¥æä¾›ä¸€ç§æœºåˆ¶æ¥é¿å…å¹¶è¡Œæ“ä½œå‘ç”Ÿåœ¨å‡½æ•°æ‰“åŒ…æ–‡ä»¶ä¸Šã€‚</p><p>ä½†å°±ç›®å‰è€Œè¨€ï¼Œä½ è¿˜æ˜¯åº”è¯¥ä¸è¦å°½é‡ä¸è¦ä½¿ç”¨<code>-j</code>å‚æ•°ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;8-makeçš„è¿è¡Œ&quot;&gt;&lt;a href=&quot;#8-makeçš„è¿è¡Œ&quot; class=&quot;headerlink&quot; title=&quot;8 makeçš„è¿è¡Œ&quot;&gt;&lt;/a&gt;8 makeçš„è¿è¡Œ&lt;/h2&gt;&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼Œæœ€ç®€å•çš„å°±æ˜¯ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸‹è¾“å…¥makeå‘½ä»¤ï¼Œmakeå‘½ä»¤ä¼šæ‰¾å½“å‰ç›®å½•çš„ma
      
    
    </summary>
    
      <category term="æ•™ç¨‹" scheme="http://yoursite.com/categories/%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="Makefile" scheme="http://yoursite.com/tags/Makefile/"/>
    
      <category term="ç¼–è¯‘" scheme="http://yoursite.com/tags/%E7%BC%96%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>Makefileå­¦ä¹ ï¼ˆäºŒï¼‰</title>
    <link href="http://yoursite.com/2018/08/18/makefile(2)/"/>
    <id>http://yoursite.com/2018/08/18/makefile(2)/</id>
    <published>2018-08-18T15:00:00.000Z</published>
    <updated>2020-05-10T07:07:22.075Z</updated>
    
    <content type="html"><![CDATA[<h2 id="5-ä½¿ç”¨å˜é‡"><a href="#5-ä½¿ç”¨å˜é‡" class="headerlink" title="5 ä½¿ç”¨å˜é‡"></a>5 ä½¿ç”¨å˜é‡</h2><p>åœ¨Makefileä¸­çš„å®šä¹‰çš„å˜é‡ï¼Œå°±åƒæ˜¯C/C++è¯­è¨€ä¸­çš„å®ä¸€æ ·ï¼Œä»–ä»£è¡¨äº†ä¸€ä¸ªæ–‡æœ¬å­—ä¸²ï¼Œåœ¨Makefileä¸­æ‰§è¡Œçš„æ—¶å€™å…¶ä¼šè‡ªåŠ¨åŸæ¨¡åŸæ ·åœ°å±•å¼€åœ¨æ‰€ä½¿ç”¨çš„åœ°æ–¹ã€‚å…¶ä¸C/C++æ‰€ä¸åŒçš„æ˜¯ï¼Œä½ å¯ä»¥åœ¨Makefileä¸­æ”¹å˜å…¶å€¼ã€‚åœ¨Makefileä¸­ï¼Œå˜é‡å¯ä»¥ä½¿ç”¨åœ¨â€œç›®æ ‡â€ï¼Œâ€œä¾èµ–ç›®æ ‡â€ï¼Œâ€œå‘½ä»¤â€æˆ– æ˜¯Makefileçš„å…¶å®ƒéƒ¨åˆ†ä¸­ã€‚</p><p>å˜é‡çš„å‘½åå­—å¯ä»¥åŒ…å«å­—ç¬¦ã€æ•°å­—ï¼Œä¸‹åˆ’çº¿ï¼ˆå¯ä»¥æ˜¯æ•°å­—å¼€å¤´ï¼‰ï¼Œä½†ä¸åº”è¯¥å«æœ‰â€œ:â€ã€â€œ#â€ã€â€œ=â€æˆ–æ˜¯ç©ºå­—ç¬¦ï¼ˆç©ºæ ¼ã€å›è½¦ç­‰ï¼‰ã€‚å˜é‡æ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œâ€œfooâ€ã€â€œFooâ€å’Œâ€œFOOâ€æ˜¯ä¸‰ä¸ªä¸åŒçš„å˜é‡åã€‚ä¼ ç»Ÿçš„Makefileçš„å˜é‡åæ˜¯å…¨å¤§å†™çš„å‘½åæ–¹å¼ï¼Œä½†æ¨èä½¿ç”¨å¤§å°å†™æ­é…çš„å˜é‡åï¼Œå¦‚ï¼š<code>MakeFlags</code>ã€‚è¿™æ ·å¯ä»¥é¿å…å’Œç³»ç»Ÿçš„å˜é‡å†²çªï¼Œè€Œå‘ç”Ÿæ„å¤–çš„äº‹æƒ…ã€‚</p><p>æœ‰ä¸€äº›å˜é‡æ˜¯å¾ˆå¥‡æ€ªå­—ä¸²ï¼Œå¦‚<code>$&lt;</code>ã€<code>$@</code>ã€<code>$^</code>ç­‰ï¼Œè¿™äº›æ˜¯è‡ªåŠ¨åŒ–å˜é‡ã€‚</p><h3 id="5-1-å˜é‡çš„åŸºç¡€"><a href="#5-1-å˜é‡çš„åŸºç¡€" class="headerlink" title="5.1 å˜é‡çš„åŸºç¡€"></a>5.1 å˜é‡çš„åŸºç¡€</h3><p>å˜é‡åœ¨å£°æ˜æ—¶éœ€è¦ç»™äºˆåˆå€¼ï¼Œè€Œåœ¨ä½¿ç”¨æ—¶ï¼Œéœ€è¦ç»™åœ¨å˜é‡åå‰åŠ ä¸Š<code>$</code>ç¬¦å·ï¼Œä½†æœ€å¥½ç”¨å°æ‹¬å·<code>()</code>æˆ–æ˜¯å¤§æ‹¬å·<code>{}</code>æŠŠå˜é‡ç»™åŒ…æ‹¬èµ·æ¥ã€‚å¦‚æœè¦ä½¿ç”¨çœŸå®çš„<code>$</code>å­—ç¬¦ï¼Œé‚£ä¹ˆéœ€è¦ç”¨<code>$$</code>æ¥è¡¨ç¤ºã€‚</p><p>å˜é‡å¯ä»¥ä½¿ç”¨åœ¨è®¸å¤šåœ°æ–¹ï¼Œå¦‚è§„åˆ™ä¸­çš„â€œç›®æ ‡â€ã€â€œä¾èµ–â€ã€â€œå‘½ä»¤â€ä»¥åŠæ–°çš„å˜é‡ä¸­ã€‚<br>å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">objects = program.o foo.o utils.o</span><br><span class="line"></span><br><span class="line">program : <span class="variable">$(objects)</span></span><br><span class="line">    cc -o program <span class="variable">$(objects)</span></span><br><span class="line"><span class="variable">$(objects)</span> : defs.h</span><br></pre></td></tr></table></figure></p><p>å˜é‡ä¼šåœ¨ä½¿ç”¨å®ƒçš„åœ°æ–¹ç²¾ç¡®åœ°å±•å¼€ï¼Œå°±åƒC/C++ä¸­çš„å®ä¸€æ ·ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">foo = c</span><br><span class="line">prog.o : prog.<span class="variable">$(foo)</span></span><br><span class="line">    <span class="variable">$(foo)</span><span class="variable">$(foo)</span> -<span class="variable">$(foo)</span> prog.<span class="variable">$(foo)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å±•å¼€åå¾—åˆ°ï¼š</span></span><br><span class="line">prog.o : prog.c</span><br><span class="line">    cc -c prog.c</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œåƒä¸‡ä¸è¦åœ¨ä½ çš„Makefileä¸­è¿™æ ·å¹²ï¼Œè¿™é‡Œåªæ˜¯ä¸¾ä¸ªä¾‹å­æ¥è¡¨æ˜Makefileä¸­çš„å˜é‡åœ¨ä½¿ç”¨å¤„å±•å¼€çš„çœŸå®æ ·å­ã€‚å¯è§å…¶å°±æ˜¯ä¸€ä¸ªâ€œæ›¿ä»£â€çš„åŸç†ã€‚</p><h3 id="5-2-å˜é‡ä¸­çš„å˜é‡"><a href="#5-2-å˜é‡ä¸­çš„å˜é‡" class="headerlink" title="5.2 å˜é‡ä¸­çš„å˜é‡"></a>5.2 å˜é‡ä¸­çš„å˜é‡</h3><p>å°†å˜é‡èµ‹å€¼ç»™å˜é‡å…±æœ‰ä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯</p><ul><li><code>=</code></li><li><code>:=</code></li></ul><p>ç¬¬ä¸€ç§æ–¹å¼ä¸ºå…¨å±€æœç´¢å˜é‡ï¼Œç¬¬äºŒç§æ–¹å¼ä¸ºåªæœç´¢ä¸Šé¢çš„å˜é‡ã€‚<br>æ¯”å¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">y = <span class="variable">$(x)</span> bar</span><br><span class="line">x = foo</span><br><span class="line"><span class="comment"># $(y) çš„å€¼ä¸º foo bar</span></span><br><span class="line"></span><br><span class="line">y := <span class="variable">$(x)</span> bar</span><br><span class="line">x := foo</span><br><span class="line"><span class="comment"># $(y) çš„å€¼ä¸º bar</span></span><br></pre></td></tr></table></figure></p><p>ç¬¬ä¸€ç§æ–¹å¼çš„å¥½å¤„æ˜¯å¯ä»¥åœ¨å˜é‡ä¸­ä½¿ç”¨åé¢å®šä¹‰çš„å˜é‡ï¼Œåå¤„æ˜¯å¯èƒ½é€ æˆé€’å½’ï¼Œä¸”å¦‚æœåœ¨å˜é‡ä¸­ä½¿ç”¨å‡½æ•°ï¼Œè¿™ç§æ–¹å¼ä¼šè®©æˆ‘ä»¬çš„makeè¿è¡Œæ—¶éå¸¸æ…¢ã€‚ä»–ä¼šä½¿ç”¨å¾—ä¸¤ä¸ªmakeçš„å‡½æ•°<code>wildcard</code>å’Œ<code>shell</code>å‘ç”Ÿä¸å¯é¢„çŸ¥çš„é”™è¯¯ã€‚å› ä¸ºä½ ä¸ä¼šçŸ¥é“è¿™ä¸¤ä¸ªå‡½æ•°ä¼šè¢«è°ƒç”¨å¤šå°‘æ¬¡ã€‚</p><p>ä¸€ä¸ªå¤æ‚çš„ä¾‹å­ï¼Œå…¶ä¸­åŒ…æ‹¬äº†makeçš„å‡½æ•°ã€æ¡ä»¶è¡¨è¾¾å¼å’Œä¸€ä¸ªç³»ç»Ÿå˜é‡â€œMAKELEVELâ€çš„ä½¿ç”¨ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ifeq</span> (0,$&#123;MAKELEVEL&#125;)</span><br><span class="line">cur-dir   := <span class="variable">$(<span class="built_in">shell</span> pwd)</span></span><br><span class="line">whoami    := <span class="variable">$(<span class="built_in">shell</span> whoami)</span></span><br><span class="line">host-type := <span class="variable">$(<span class="built_in">shell</span> arch)</span></span><br><span class="line">MAKE := $&#123;MAKE&#125; host-type=$&#123;host-type&#125; whoami=$&#123;whoami&#125;</span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure></p><p>å¯¹äºç³»ç»Ÿå˜é‡<code>MAKELEVEL</code>ï¼Œå…¶æ„æ€æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬çš„makeæœ‰ä¸€ä¸ªåµŒå¥—æ‰§è¡Œçš„åŠ¨ä½œï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªå˜é‡ä¼šè®°å½•äº†æˆ‘ä»¬çš„å½“å‰Makefileçš„è°ƒç”¨å±‚æ•°ã€‚</p><p>ä¸‹é¢å†ä»‹ç»ä¸¤ä¸ªå®šä¹‰å˜é‡æ—¶æˆ‘ä»¬éœ€è¦çŸ¥é“çš„ï¼Œè¯·å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬è¦å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œå…¶å€¼æ˜¯ä¸€ä¸ªç©ºæ ¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nullstring :=</span><br><span class="line">space := <span class="variable">$(nullstring)</span> <span class="comment"># end of the line</span></span><br></pre></td></tr></table></figure></p><p><code>nullstring</code>æ˜¯ä¸€ä¸ªEmptyå˜é‡ï¼Œå…¶ä¸­ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œè€Œæˆ‘ä»¬çš„spaceçš„å€¼æ˜¯ä¸€ä¸ªç©ºæ ¼ã€‚å› ä¸ºåœ¨æ“ä½œç¬¦çš„å³è¾¹æ˜¯å¾ˆéš¾æè¿°ä¸€ä¸ªç©ºæ ¼çš„ï¼Œè¿™é‡Œé‡‡ç”¨çš„æŠ€æœ¯å¾ˆç®¡ç”¨ï¼Œå…ˆç”¨ä¸€ä¸ªEmptyå˜é‡æ¥æ ‡æ˜å˜é‡çš„å€¼å¼€å§‹äº†ï¼Œè€Œåé¢é‡‡ç”¨<code>#</code>æ³¨é‡Šç¬¦æ¥è¡¨ç¤ºå˜é‡å®šä¹‰çš„ç»ˆæ­¢ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å®šä¹‰å‡ºå…¶å€¼æ˜¯ä¸€ä¸ªç©ºæ ¼çš„å˜é‡ã€‚æ³¨æ„è¿™é‡Œå…³äº<code>#</code>çš„ä½¿ç”¨ï¼Œæ³¨é‡Šç¬¦<code>#</code>çš„è¿™ç§ç‰¹æ€§å€¼å¾—æˆ‘ä»¬æ³¨æ„ï¼Œå¦‚æœæˆ‘ä»¬è¿™æ ·å®šä¹‰ä¸€ä¸ªå˜é‡ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir := /foo/bar    <span class="comment"># directory to put the frobs in</span></span><br></pre></td></tr></table></figure></p><p><code>dir</code>è¿™ä¸ªå˜é‡çš„å€¼æ˜¯<code>/foo/bar</code>ï¼Œåé¢è¿˜è·Ÿäº†4ä¸ªç©ºæ ¼ï¼Œå¦‚æœæˆ‘ä»¬è¿™æ ·ä½¿ç”¨è¿™æ ·å˜é‡æ¥æŒ‡å®šåˆ«çš„ç›®å½•â€”â€”<code>$(dir)/file</code>é‚£ä¹ˆå°±å®Œè›‹äº†ï¼Œè¿™ç‚¹éœ€è¦æ³¨æ„ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒæœ‰ç”¨çš„æ“ä½œç¬¦æ˜¯<code>?=</code>ï¼Œå…ˆçœ‹ç¤ºä¾‹ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FOO ?= bar</span><br></pre></td></tr></table></figure></p><p>å…¶å«ä¹‰æ˜¯ï¼Œå¦‚æœ<code>FOO</code>æ²¡æœ‰è¢«å®šä¹‰è¿‡ï¼Œé‚£ä¹ˆå˜é‡<code>FOO</code>çš„å€¼å°±æ˜¯<code>bar</code>ï¼Œå¦‚æœ<code>FOO</code>å…ˆå‰è¢«å®šä¹‰è¿‡ï¼Œé‚£ä¹ˆè¿™æ¡è¯­å°†ä»€ä¹ˆä¹Ÿä¸åšï¼Œå…¶ç­‰ä»·äºï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(<span class="built_in">origin</span> FOO)</span>, undefined)</span><br><span class="line">    FOO = bar</span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure></p><h3 id="5-3-å˜é‡é«˜çº§ç”¨æ³•"><a href="#5-3-å˜é‡é«˜çº§ç”¨æ³•" class="headerlink" title="5.3 å˜é‡é«˜çº§ç”¨æ³•"></a>5.3 å˜é‡é«˜çº§ç”¨æ³•</h3><h4 id="å˜é‡å€¼çš„æ›¿æ¢"><a href="#å˜é‡å€¼çš„æ›¿æ¢" class="headerlink" title="å˜é‡å€¼çš„æ›¿æ¢"></a>å˜é‡å€¼çš„æ›¿æ¢</h4><p>æˆ‘ä»¬å¯ä»¥æ›¿æ¢å˜é‡ä¸­çš„å…±æœ‰çš„éƒ¨åˆ†ï¼Œå…¶æ ¼å¼æ˜¯<code>$(var:a=b)</code>æˆ–æ˜¯<code>${var:a=b}</code>ï¼Œå…¶æ„æ€æ˜¯ï¼ŒæŠŠå˜é‡<code>var</code>ä¸­æ‰€æœ‰ä»¥<code>a</code>å­—ä¸²ç»“å°¾çš„<code>a</code>æ›¿æ¢æˆ<code>b</code>å­—ä¸²ã€‚è¿™é‡Œçš„â€œç»“å°¾â€æ„æ€æ˜¯â€œç©ºæ ¼â€æˆ–æ˜¯â€œç»“æŸç¬¦â€ã€‚</p><p>ä¸¾ä¾‹è¯´æ˜ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">foo := a.o b.o c.o</span><br><span class="line">bar := $(foo:.o=.c)</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰äº†ä¸€ä¸ªâ€œ$(foo)â€å˜é‡ï¼Œè€Œç¬¬äºŒè¡Œçš„æ„æ€æ˜¯æŠŠâ€œ$(foo)â€ä¸­æ‰€æœ‰ä»¥â€œ.oâ€å­—ä¸²â€œç»“å°¾â€å…¨éƒ¨æ›¿æ¢æˆâ€œ.câ€ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„â€œ$(bar)â€çš„å€¼å°±æ˜¯â€œa.c b.c c.câ€ã€‚</p><h4 id="æŠŠå˜é‡çš„å€¼å†å½“æˆå˜é‡"><a href="#æŠŠå˜é‡çš„å€¼å†å½“æˆå˜é‡" class="headerlink" title="æŠŠå˜é‡çš„å€¼å†å½“æˆå˜é‡"></a>æŠŠå˜é‡çš„å€¼å†å½“æˆå˜é‡</h4><p>ä¾‹å­ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = y</span><br><span class="line">y = z</span><br><span class="line">a := $(<span class="variable">$(x)</span>)</span><br></pre></td></tr></table></figure></p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>$(x)</code>çš„å€¼æ˜¯<code>y</code>ï¼Œæ‰€ä»¥<code>$($(x))</code>å°±æ˜¯<code>$(y)</code>ï¼Œäºæ˜¯<code>$(a)</code>çš„å€¼å°±æ˜¯<code>z</code>ã€‚<br>æ³¨æ„ï¼Œæ˜¯<code>x=y</code>ï¼Œè€Œä¸æ˜¯<code>x=$(y)</code>ã€‚å¦‚æœæ˜¯<code>x=$(y)</code>ï¼Œé‚£ä¹ˆ<code>x</code>çš„å€¼å°±æ˜¯<code>z</code>è€Œä¸æ˜¯<code>y</code>äº†ã€‚</p><p>æ›´å¤æ‚çš„ä¾‹å­ï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x = variable1</span><br><span class="line">variable2 := Hello</span><br><span class="line">y = <span class="variable">$(<span class="built_in">subst</span> 1,2,<span class="variable">$(x)</span>)</span></span><br><span class="line">z = y</span><br><span class="line">a := $($(<span class="variable">$(z)</span>))</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>$($($(z)))</code>æ‰©å±•ä¸º<code>$($(y))</code>ï¼Œè€Œå…¶å†æ¬¡è¢«æ‰©å±•ä¸º<code>$($(subst 1,2,$(x)))</code>ã€‚<code>$(x)</code>çš„å€¼æ˜¯<code>variable1</code>ï¼Œ<code>subst</code>å‡½æ•°æŠŠ<code>variable1</code>ä¸­çš„æ‰€æœ‰â€œ1â€å­—ä¸²æ›¿æ¢æˆâ€œ2â€å­—ä¸²ï¼Œäºæ˜¯ï¼Œ <code>variable1</code>å˜æˆ<code>variable2</code>ï¼Œå†å–å…¶å€¼ï¼Œæ‰€ä»¥ï¼Œæœ€ç»ˆï¼Œ<code>$(a)</code>çš„å€¼å°±æ˜¯<code>$(variable2)</code>çš„å€¼â€”â€”<code>Hello</code>ã€‚</p><p>ä½¿ç”¨å¤šä¸ªå˜é‡çš„åå­—ç»„æˆä¸€ä¸ªå˜é‡çš„åå­—ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">first_second = Hello</span><br><span class="line">a = first</span><br><span class="line">b = second</span><br><span class="line">all = $($a_$b)</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œ<code>$a_$b$</code>å±•å¼€ä¸º<code>first_second</code>ï¼Œæœ€å<code>$first_second</code>çš„å€¼ä¸º<code>Hello</code></p><p>ç»“åˆå˜é‡æ›¿æ¢ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a_objects := a.o b.o c.o</span><br><span class="line">1_objects := 1.o 2.o 3.o</span><br><span class="line">sources := $(<span class="variable">$(a1)</span>_objects:.o=.c)</span><br></pre></td></tr></table></figure></p><p>å¦‚æœ<code>$a1</code>çš„å€¼ä¸º<code>1</code>ï¼Œæœ€ç»ˆçš„ç»“æœæ˜¯<code>1.c 2.c 3.c</code>ï¼›å¦‚æœ<code>$a1</code>çš„å€¼æ˜¯<code>a</code>ï¼Œæœ€ç»ˆçš„ç»“æœæ˜¯<code>a.c b.c c.c</code></p><p>â€œæŠŠå˜é‡çš„å€¼å†å½“æˆå˜é‡â€è¿™ç§æŠ€æœ¯ï¼ŒåŒæ ·å¯ä»¥ç”¨åœ¨æ“ä½œç¬¦çš„å·¦è¾¹ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dir = foo</span><br><span class="line"><span class="variable">$(dir)</span>_sources := <span class="variable">$(<span class="built_in">wildcard</span> <span class="variable">$(dir)</span>/*.c)</span></span><br><span class="line"><span class="keyword">define</span> <span class="variable">$(dir)</span>_print</span><br><span class="line">lpr $(<span class="variable">$(dir)</span>_sources)</span><br><span class="line"><span class="keyword">endef</span></span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªä¾‹å­ä¸­å®šä¹‰äº†ä¸‰ä¸ªå˜é‡ï¼š<code>dir</code>ï¼Œ<code>foo_sources</code>å’Œ<code>foo_print</code>ã€‚</p><h3 id="5-4-è¿½åŠ å˜é‡å€¼"><a href="#5-4-è¿½åŠ å˜é‡å€¼" class="headerlink" title="5.4 è¿½åŠ å˜é‡å€¼"></a>5.4 è¿½åŠ å˜é‡å€¼</h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨â€œ+=â€æ“ä½œç¬¦ç»™å˜é‡è¿½åŠ å€¼ï¼Œå¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">objects = main.o foo.o bar.o utils.o</span><br><span class="line">objects += another.o</span><br></pre></td></tr></table></figure></p><p>äºæ˜¯ï¼Œæˆ‘ä»¬çš„<code>$(objects)</code>å€¼å˜æˆï¼š<code>main.o foo.o bar.o utils.o another.o</code></p><p>å¦‚æœå˜é‡ä¹‹å‰æ²¡æœ‰å®šä¹‰è¿‡ï¼Œé‚£ä¹ˆï¼Œâ€œ+=â€ä¼šè‡ªåŠ¨å˜æˆâ€œ=â€ï¼Œå¦‚æœå‰é¢æœ‰å˜é‡å®šä¹‰ï¼Œé‚£ä¹ˆâ€œ+=â€ä¼šç»§æ‰¿äºå‰æ¬¡æ“ä½œçš„èµ‹å€¼ç¬¦ã€‚å¦‚æœå‰ä¸€æ¬¡çš„æ˜¯â€œ:=â€ï¼Œé‚£ä¹ˆâ€œ+=â€ä¼šä»¥â€œ:=â€ä½œä¸ºå…¶èµ‹å€¼ç¬¦ï¼Œå¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">variable := value</span><br><span class="line">variable += more</span><br><span class="line"><span class="comment">#ç­‰ä»·äºï¼š</span></span><br><span class="line">variable := value</span><br><span class="line">variable := <span class="variable">$(variable)</span> more</span><br></pre></td></tr></table></figure></p><p>ä½†å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">variable = value</span><br><span class="line">variable += more</span><br></pre></td></tr></table></figure></p><p>ç”±äºå‰æ¬¡çš„èµ‹å€¼ç¬¦æ˜¯<code>=</code>ï¼Œæ‰€ä»¥<code>+=</code>ä¹Ÿä¼šä»¥<code>=</code>æ¥åšä¸ºèµ‹å€¼ï¼Œé‚£ä¹ˆå²‚ä¸ä¼šå‘ç”Ÿå˜é‡çš„é€’è¡¥å½’å®šä¹‰ï¼Œè¿™æ˜¯å¾ˆä¸å¥½çš„ï¼Œæ‰€ä»¥makeä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¸å¿…æ‹…å¿ƒè¿™ä¸ªé—®é¢˜ã€‚</p><h3 id="5-5-overrideæŒ‡ç¤ºç¬¦"><a href="#5-5-overrideæŒ‡ç¤ºç¬¦" class="headerlink" title="5.5 overrideæŒ‡ç¤ºç¬¦"></a>5.5 overrideæŒ‡ç¤ºç¬¦</h3><p>å¦‚æœæœ‰å˜é‡æ˜¯é€šå¸¸makeçš„å‘½ä»¤è¡Œå‚æ•°è®¾ç½®çš„ï¼Œé‚£ä¹ˆMakefileä¸­å¯¹è¿™ä¸ªå˜é‡çš„èµ‹å€¼ä¼šè¢«å¿½ç•¥ã€‚å¦‚æœä½ æƒ³åœ¨Makefileä¸­è®¾ç½®è¿™ç±»å‚æ•°çš„å€¼ï¼Œé‚£ä¹ˆï¼Œä½ å¯ä»¥ä½¿ç”¨<code>override</code>æŒ‡ç¤ºç¬¦ã€‚å…¶è¯­æ³•æ˜¯ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> &lt;variable&gt; = &lt;value&gt;</span><br><span class="line"><span class="keyword">override</span> &lt;variable&gt; := &lt;value&gt;</span><br><span class="line"><span class="comment">#è¿½åŠ ï¼š</span></span><br><span class="line"><span class="keyword">override</span> &lt;variable&gt; += &lt;more text&gt;</span><br><span class="line"><span class="comment">#å¤šè¡Œå˜é‡</span></span><br><span class="line"><span class="keyword">override</span> <span class="keyword">define</span> foo</span><br><span class="line">bar</span><br><span class="line"><span class="keyword">endef</span></span><br></pre></td></tr></table></figure></p><h3 id="5-6-å¤šè¡Œå˜é‡"><a href="#5-6-å¤šè¡Œå˜é‡" class="headerlink" title="5.6 å¤šè¡Œå˜é‡"></a>5.6 å¤šè¡Œå˜é‡</h3><p>å¤šè¡Œå˜é‡å°±æ˜¯å‰é¢æ‰€è¿°çš„<code>define...endef</code>ã€‚ä½¿ç”¨<code>define</code>å…³é”®å­—è®¾ç½®å˜é‡çš„å€¼å¯ä»¥æœ‰æ¢è¡Œï¼Œè¿™æœ‰åˆ©äºå®šä¹‰ä¸€ç³»åˆ—çš„å‘½ä»¤ã€‚<br><code>define</code>æŒ‡ç¤ºç¬¦åé¢è·Ÿçš„æ˜¯å˜é‡çš„åå­—ï¼Œè€Œé‡èµ·ä¸€è¡Œå®šä¹‰å˜é‡çš„å€¼ï¼Œå®šä¹‰æ˜¯ä»¥<code>endef</code>å…³é”®å­—ç»“æŸã€‚å…¶å·¥ä½œæ–¹å¼å’Œ<code>=</code>æ“ä½œç¬¦ä¸€æ ·ã€‚å˜é‡çš„å€¼å¯ä»¥åŒ…å«å‡½ æ•°ã€å‘½ä»¤ã€æ–‡å­—ï¼Œæˆ–æ˜¯å…¶å®ƒå˜é‡ã€‚å› ä¸ºå‘½ä»¤éœ€è¦ä»¥<code>Tab</code>é”®å¼€å¤´ï¼Œæ‰€ä»¥å¦‚æœä½ ç”¨<code>define</code>å®šä¹‰çš„å‘½ä»¤å˜é‡ä¸­æ²¡æœ‰ä»¥<code>Tab</code>é”®å¼€å¤´ï¼Œé‚£ä¹ˆmakeå°±ä¸ä¼šæŠŠå…¶è®¤ä¸ºæ˜¯å‘½ä»¤ã€‚æ³¨æ„è¿™é‡Œæ˜¯åœ¨ä½¿ç”¨æ—¶ä»¥<code>Tab</code>å¼€å¤´ã€‚</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">define</span> two-lines</span><br><span class="line">echo foo</span><br><span class="line">echo <span class="variable">$(bar)</span></span><br><span class="line"><span class="keyword">endef</span></span><br><span class="line"></span><br><span class="line">ä½¿ç”¨æ—¶ï¼š</span><br><span class="line">    $(two-lines)</span><br></pre></td></tr></table></figure><h3 id="5-7-ç¯å¢ƒå˜é‡"><a href="#5-7-ç¯å¢ƒå˜é‡" class="headerlink" title="5.7 ç¯å¢ƒå˜é‡"></a>5.7 ç¯å¢ƒå˜é‡</h3><p>makeè¿è¡Œæ—¶çš„ç³»ç»Ÿç¯å¢ƒå˜é‡å¯ä»¥åœ¨makeå¼€å§‹è¿è¡Œæ—¶è¢«è½½å…¥åˆ°Makefileæ–‡ä»¶ä¸­ï¼Œä½†æ˜¯å¦‚æœMakefileä¸­å·²å®šä¹‰äº†è¿™ä¸ªå˜é‡ï¼Œæˆ–æ˜¯è¿™ä¸ªå˜é‡ç”±makeå‘½ä»¤è¡Œå¸¦å…¥ï¼Œé‚£ä¹ˆç³»ç»Ÿçš„ç¯å¢ƒå˜é‡çš„å€¼å°†è¢«è¦†ç›–ã€‚ï¼ˆå¦‚æœmakeæŒ‡å®šäº†<code>-e</code>å‚æ•°ï¼Œé‚£ä¹ˆï¼Œç³»ç»Ÿç¯å¢ƒå˜é‡å°†è¦†ç›–Makefileä¸­å®šä¹‰çš„å˜é‡ï¼‰</p><p>å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ç¯å¢ƒå˜é‡ä¸­è®¾ç½®äº†<code>CFLAGS</code>ç¯å¢ƒå˜é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨æ‰€æœ‰çš„Makefileä¸­ä½¿ç”¨è¿™ä¸ªå˜é‡äº†ã€‚è¿™å¯¹äºæˆ‘ä»¬ä½¿ç”¨ç»Ÿä¸€çš„ç¼–è¯‘å‚æ•°æœ‰æ¯”è¾ƒå¤§çš„å¥½å¤„ã€‚å¦‚æœMakefileä¸­å®šä¹‰äº†<code>CFLAGS</code>ï¼Œé‚£ä¹ˆåˆ™ä¼šä½¿ç”¨Makefileä¸­çš„è¿™ä¸ªå˜é‡ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰åˆ™ä½¿ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡çš„å€¼ï¼Œä¸€ä¸ªå…±æ€§å’Œä¸ªæ€§çš„ç»Ÿä¸€ï¼Œå¾ˆåƒâ€œå…¨å±€å˜é‡â€å’Œâ€œå±€éƒ¨å˜é‡â€çš„ç‰¹æ€§ã€‚</p><p>å½“makeåµŒå¥—è°ƒç”¨æ—¶ï¼ˆå‚è§å‰é¢çš„â€œåµŒå¥—è°ƒç”¨â€ç« èŠ‚ï¼‰ï¼Œä¸Šå±‚Makefileä¸­å®šä¹‰çš„å˜é‡ä¼šä»¥ç³»ç»Ÿç¯å¢ƒå˜é‡çš„æ–¹å¼ä¼ é€’åˆ°ä¸‹å±‚çš„Makefileä¸­ã€‚å½“ç„¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰é€šè¿‡å‘½ä»¤è¡Œè®¾ç½®çš„å˜é‡ä¼šè¢«ä¼ é€’ã€‚è€Œå®šä¹‰åœ¨æ–‡ä»¶ä¸­çš„å˜é‡ï¼Œå¦‚æœè¦å‘ä¸‹å±‚Makefileä¼ é€’ï¼Œåˆ™éœ€è¦ä½¿ç”¨<code>exprot</code>å…³é”®å­—æ¥å£°æ˜ã€‚</p><h3 id="5-8-ç›®æ ‡å˜é‡"><a href="#5-8-ç›®æ ‡å˜é‡" class="headerlink" title="5.8 ç›®æ ‡å˜é‡"></a>5.8 ç›®æ ‡å˜é‡</h3><p>å‰é¢æˆ‘ä»¬æ‰€è®²çš„åœ¨Makefileä¸­å®šä¹‰çš„å˜é‡éƒ½æ˜¯â€œå…¨å±€å˜é‡â€ï¼Œåœ¨æ•´ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥è®¿é—®è¿™äº›å˜é‡ã€‚å½“ç„¶ï¼Œâ€œè‡ªåŠ¨åŒ–å˜é‡â€é™¤å¤–ï¼Œå¦‚<code>$&lt;</code>ç­‰è¿™ç§ç±»é‡çš„è‡ªåŠ¨åŒ–å˜é‡å°±å±äºâ€œè§„åˆ™å‹å˜é‡â€ï¼Œè¿™ç§å˜é‡çš„å€¼ä¾èµ–äºè§„åˆ™çš„ç›®æ ‡å’Œä¾èµ–ç›®æ ‡çš„å®šä¹‰ã€‚</p><p>åŒæ ·å¯ä»¥ä¸ºæŸä¸ªç›®æ ‡è®¾ç½®å±€éƒ¨å˜é‡ï¼Œè¿™ç§å˜é‡è¢«ç§°ä¸ºâ€œTarget-specific Variableâ€ï¼Œå®ƒå¯ä»¥å’Œâ€œå…¨å±€å˜é‡â€åŒåï¼Œå› ä¸ºå®ƒçš„ä½œç”¨èŒƒå›´åªåœ¨è¿™æ¡è§„åˆ™ä»¥åŠè¿å¸¦è§„åˆ™ä¸­ï¼Œæ‰€ä»¥å…¶å€¼ä¹Ÿåªåœ¨ä½œç”¨èŒƒå›´å†…æœ‰æ•ˆã€‚è€Œä¸ä¼šå½±å“è§„åˆ™é“¾ä»¥å¤–çš„å…¨å±€å˜é‡çš„å€¼ã€‚</p><p>å…¶è¯­æ³•æ˜¯ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;target ...&gt; : &lt;variable-assignment&gt;</span><br><span class="line">&lt;target ...&gt; : overide &lt;variable-assignment&gt;</span><br></pre></td></tr></table></figure></p><p><code>&lt;variable-assignment&gt;</code>å¯ä»¥æ˜¯å‰é¢è®²è¿‡çš„å„ç§èµ‹å€¼è¡¨è¾¾å¼ï¼Œå¦‚<code>=</code>ã€<code>:=</code>ã€<code>+=</code>æˆ–æ˜¯<code>ï¼Ÿ=</code>ã€‚<br>ç¬¬äºŒä¸ªè¯­æ³•æ˜¯é’ˆå¯¹äºmakeå‘½ä»¤è¡Œå¸¦å…¥çš„å˜é‡ï¼Œæˆ–æ˜¯ç³»ç»Ÿç¯å¢ƒå˜é‡ã€‚</p><p>å½“æˆ‘ä»¬è®¾ç½®äº†è¿™æ ·ä¸€ä¸ªå˜é‡ï¼Œè¿™ä¸ªå˜é‡ä¼šä½œç”¨åˆ°ç”±è¿™ä¸ªç›®æ ‡æ‰€å¼•å‘çš„æ‰€æœ‰çš„è§„åˆ™ä¸­å»ã€‚ä¸¾ä¾‹ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">prog : CFLAGS = -g</span><br><span class="line">prog : prog.o foo.o bar.o</span><br><span class="line">    <span class="variable">$(CC)</span> <span class="variable">$(CFLAGS)</span> prog.o foo.o bar.o</span><br><span class="line"></span><br><span class="line">prog.o : prog.c</span><br><span class="line">    <span class="variable">$(CC)</span> <span class="variable">$(CFLAGS)</span> prog.c</span><br><span class="line"></span><br><span class="line">foo.o : foo.c</span><br><span class="line">    <span class="variable">$(CC)</span> <span class="variable">$(CFLAGS)</span> foo.c</span><br><span class="line"></span><br><span class="line">bar.o : bar.c</span><br><span class="line">    <span class="variable">$(CC)</span> <span class="variable">$(CFLAGS)</span> bar.c</span><br></pre></td></tr></table></figure></p><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œä¸ç®¡å…¨å±€çš„<code>$(CFLAGS)</code>çš„å€¼æ˜¯ä»€ä¹ˆï¼Œåœ¨<code>prog</code>ç›®æ ‡ï¼Œä»¥åŠå…¶æ‰€å¼•å‘çš„æ‰€æœ‰è§„åˆ™ä¸­ï¼ˆ<code>prog.o</code> <code>foo.o</code> <code>bar.o</code>çš„è§„åˆ™ï¼‰ï¼Œ<code>$(CFLAGS)</code>çš„å€¼éƒ½æ˜¯<code>-g</code></p><h3 id="5-9-æ¨¡å¼å˜é‡"><a href="#5-9-æ¨¡å¼å˜é‡" class="headerlink" title="5.9 æ¨¡å¼å˜é‡"></a>5.9 æ¨¡å¼å˜é‡</h3><p>ä¸Šé¢ä»‹ç»çš„ç›®æ ‡å˜é‡ï¼Œæ˜¯æŒ‡åœ¨ä¸€ä¸ªæŒ‡å®šç›®æ ‡ä¸Šè¯¥å˜é‡ç”Ÿæ•ˆï¼Œè€Œæ¨¡å¼å˜é‡æ˜¯åœ¨ä¸€ç§ç»™å®šâ€œæ¨¡å¼â€ä¸Šï¼ŒæŠŠå˜é‡å®šä¹‰åœ¨ç¬¦åˆè¿™ç§æ¨¡å¼çš„æ‰€æœ‰ç›®æ ‡ä¸Šã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œmakeçš„â€œæ¨¡å¼â€ä¸€èˆ¬æ˜¯è‡³å°‘å«æœ‰ä¸€ä¸ª<code>%</code>çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥å¦‚ä¸‹æ–¹å¼ç»™æ‰€æœ‰ä»¥<code>.o</code>ç»“å°¾çš„ç›®æ ‡å®šä¹‰ç›®æ ‡å˜é‡ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%.o : CFLAGS = -O</span><br></pre></td></tr></table></figure></p><p>åŒæ ·ï¼Œæ¨¡å¼å˜é‡çš„è¯­æ³•å’Œâ€œç›®æ ‡å˜é‡â€ä¸€æ ·ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;pattern ...&gt; : &lt;variable-assignment&gt;</span><br><span class="line">&lt;pattern ...&gt; : <span class="keyword">override</span> &lt;variable-assignment&gt;</span><br></pre></td></tr></table></figure></p><p><code>override</code>åŒæ ·æ˜¯é’ˆå¯¹äºç³»ç»Ÿç¯å¢ƒä¼ å…¥çš„å˜é‡ï¼Œæˆ–æ˜¯makeå‘½ä»¤è¡ŒæŒ‡å®šçš„å˜é‡ã€‚</p><h2 id="6-ä½¿ç”¨æ¡ä»¶åˆ¤æ–­"><a href="#6-ä½¿ç”¨æ¡ä»¶åˆ¤æ–­" class="headerlink" title="6 ä½¿ç”¨æ¡ä»¶åˆ¤æ–­"></a>6 ä½¿ç”¨æ¡ä»¶åˆ¤æ–­</h2><p>ä½¿ç”¨æ¡ä»¶åˆ¤æ–­ï¼Œå¯ä»¥è®©makeæ ¹æ®è¿è¡Œæ—¶çš„ä¸åŒæƒ…å†µé€‰æ‹©ä¸åŒçš„æ‰§è¡Œåˆ†æ”¯ã€‚æ¡ä»¶è¡¨è¾¾å¼å¯ä»¥æ˜¯æ¯”è¾ƒå˜é‡çš„å€¼ï¼Œæˆ–æ˜¯æ¯”è¾ƒå˜é‡å’Œå¸¸é‡çš„å€¼ã€‚</p><h3 id="6-1-ç¤ºä¾‹"><a href="#6-1-ç¤ºä¾‹" class="headerlink" title="6.1 ç¤ºä¾‹"></a>6.1 ç¤ºä¾‹</h3><p>ä¸‹é¢çš„ä¾‹å­ï¼Œåˆ¤æ–­<code>$(CC)</code>å˜é‡æ˜¯å¦<code>gcc</code>ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œåˆ™ä½¿ç”¨GNUå‡½æ•°ç¼–è¯‘ç›®æ ‡ã€‚<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">libs_for_gcc = -lgnu</span><br><span class="line">normal_libs =</span><br><span class="line"></span><br><span class="line"><span class="section">foo: <span class="variable">$(objects)</span></span></span><br><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(CC)</span>,gcc)</span><br><span class="line">    <span class="variable">$(CC)</span> -o foo <span class="variable">$(objects)</span> <span class="variable">$(libs_for_gcc)</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="variable">$(CC)</span> -o foo <span class="variable">$(objects)</span> <span class="variable">$(normal_libs)</span></span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬å¯ä»¥ä»ä¸Šé¢çš„ç¤ºä¾‹ä¸­çœ‹åˆ°ä¸‰ä¸ªå…³é”®å­—ï¼š<code>ifeq</code>ã€<code>else</code>å’Œ<code>endif</code>ã€‚<code>ifeq</code>çš„æ„æ€è¡¨ç¤ºæ¡ä»¶è¯­å¥çš„å¼€å§‹ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªæ¡ä»¶è¡¨è¾¾å¼ï¼Œè¡¨è¾¾å¼åŒ…å«ä¸¤ä¸ªå‚æ•°ï¼Œä»¥é€—å·åˆ†éš”ï¼Œè¡¨è¾¾å¼ä»¥åœ†æ‹¬å·æ‹¬èµ·ã€‚<code>else</code>è¡¨ç¤ºæ¡ä»¶è¡¨è¾¾å¼ä¸ºå‡çš„æƒ…å†µã€‚<code>endif</code>è¡¨ç¤ºä¸€ä¸ªæ¡ä»¶è¯­å¥çš„ç»“æŸï¼Œä»»ä½•ä¸€ä¸ªæ¡ä»¶è¡¨è¾¾å¼éƒ½åº”è¯¥ä»¥<code>endif</code>ç»“æŸã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŠŠä¸Šé¢çš„é‚£ä¸ªä¾‹å­å†™å¾—æ›´ç®€æ´ä¸€äº›ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">libs_for_gcc = -lgnu</span><br><span class="line">normal_libs =</span><br><span class="line"></span><br><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(CC)</span>,gcc)</span><br><span class="line">    libs=<span class="variable">$(libs_for_gcc)</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    libs=<span class="variable">$(normal_libs)</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"><span class="section">foo: <span class="variable">$(objects)</span></span></span><br><span class="line">    <span class="variable">$(CC)</span> -o foo <span class="variable">$(objects)</span> <span class="variable">$(libs)</span></span><br></pre></td></tr></table></figure></p><h3 id="6-2-è¯­æ³•"><a href="#6-2-è¯­æ³•" class="headerlink" title="6.2 è¯­æ³•"></a>6.2 è¯­æ³•</h3><p>æ¡ä»¶è¡¨è¾¾å¼çš„è¯­æ³•ä¸ºï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;conditional-directive&gt;</span><br><span class="line">&lt;text-if-true&gt;</span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure></p><p>ä»¥åŠï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;conditional-directive&gt;</span><br><span class="line">&lt;text-if-true&gt;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&lt;text-if-false&gt;</span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure></p><p><code>&lt;conditional-directive&gt;</code>å¯ä»¥æ˜¯<code>ifeq</code>/<code>ifneq</code>/<code>ifdef</code>/<code>ifndef</code>ã€‚</p><p><code>ifeq</code>ä¸<code>ifneq</code>å…±æœ‰äº”ç§è¡¨è¾¾ï¼Œå…¶ä¸­åå››ä¸ªéƒ½ç±»ä¼¼ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ifeq</span> (&lt;arg1&gt;, &lt;arg2&gt;)</span><br><span class="line"><span class="keyword">ifeq</span> '&lt;arg1&gt;' '&lt;arg2&gt;'</span><br><span class="line"><span class="keyword">ifeq</span> <span class="string">"&lt;arg1&gt;"</span> <span class="string">"&lt;arg2&gt;"</span></span><br><span class="line"><span class="keyword">ifeq</span> <span class="string">"&lt;arg1&gt;"</span> '&lt;arg2&gt;'</span><br><span class="line"><span class="keyword">ifeq</span> '&lt;arg1&gt;' <span class="string">"&lt;arg2&gt;"</span></span><br></pre></td></tr></table></figure></p><p><code>ifdef</code>ä¸<code>ifndef</code>çš„è¡¨è¾¾æ¯”è¾ƒç®€å•ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ifdef</span> &lt;variable-name&gt;</span><br><span class="line"><span class="keyword">ifndef</span> &lt;variable-name&gt;</span><br></pre></td></tr></table></figure></p><p>åœ¨<code>&lt;conditional-directive&gt;</code>è¿™ä¸€è¡Œä¸Šï¼Œå¤šä½™çš„ç©ºæ ¼æ˜¯è¢«å…è®¸çš„ï¼Œä½†æ˜¯ä¸èƒ½ä»¥[Tab]é”®åšä¸ºå¼€å§‹ï¼ˆä¸ç„¶å°±è¢«è®¤ä¸ºæ˜¯å‘½ä»¤ï¼‰ã€‚è€Œæ³¨é‡Šç¬¦<code>#</code>åŒæ ·ä¹Ÿæ˜¯å®‰å…¨çš„ã€‚<code>else</code>å’Œ<code>endif</code>ä¹Ÿä¸€æ ·ï¼Œåªè¦ä¸æ˜¯ä»¥[Tab]é”®å¼€å§‹å°±è¡Œäº†ã€‚</p><p>ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œmakeæ˜¯åœ¨è¯»å–Makefileæ—¶å°±è®¡ç®—æ¡ä»¶è¡¨è¾¾å¼çš„å€¼ï¼Œå¹¶æ ¹æ®æ¡ä»¶è¡¨è¾¾å¼çš„å€¼æ¥é€‰æ‹©è¯­å¥ï¼Œæ‰€ä»¥æœ€å¥½ä¸è¦æŠŠè‡ªåŠ¨åŒ–å˜é‡ï¼ˆå¦‚<code>$@</code>ç­‰ï¼‰æ”¾å…¥æ¡ä»¶è¡¨è¾¾å¼ä¸­ï¼ˆä½œä¸ºæ¡ä»¶è¢«åˆ¤æ–­ï¼‰ï¼Œå› ä¸ºè‡ªåŠ¨åŒ–å˜é‡æ˜¯åœ¨è¿è¡Œæ—¶æ‰æœ‰çš„ã€‚</p><hr><h2 id="7-ä½¿ç”¨å‡½æ•°"><a href="#7-ä½¿ç”¨å‡½æ•°" class="headerlink" title="7 ä½¿ç”¨å‡½æ•°"></a>7 ä½¿ç”¨å‡½æ•°</h2><h3 id="7-1-å‡½æ•°çš„è°ƒç”¨è¯­æ³•"><a href="#7-1-å‡½æ•°çš„è°ƒç”¨è¯­æ³•" class="headerlink" title="7.1 å‡½æ•°çš„è°ƒç”¨è¯­æ³•"></a>7.1 å‡½æ•°çš„è°ƒç”¨è¯­æ³•</h3><p>å‡½æ•°è°ƒç”¨ï¼Œå¾ˆåƒå˜é‡çš„ä½¿ç”¨ï¼Œä¹Ÿæ˜¯ä»¥<code>$</code>æ¥æ ‡è¯†çš„ï¼Œå…¶è¯­æ³•å¦‚ä¸‹ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(&lt;function&gt; &lt;arguments&gt;)</span><br><span class="line"><span class="comment">#æˆ–æ˜¯</span></span><br><span class="line">$&#123;&lt;function&gt; &lt;arguments&gt;&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œï¼Œ<code>&lt;function&gt;</code>å°±æ˜¯å‡½æ•°åï¼Œmakeæ”¯æŒçš„å‡½æ•°ä¸å¤šã€‚<code>&lt;arguments&gt;</code>æ˜¯å‡½æ•°çš„å‚æ•°ï¼Œå‚æ•°é—´ä»¥é€—å·â€œ,â€ åˆ†éš”ï¼Œè€Œå‡½æ•°åå’Œå‚æ•°ä¹‹é—´ä»¥â€œç©ºæ ¼â€åˆ†éš”ã€‚</p><p>å‡½æ•°è°ƒç”¨ä»¥<code>$</code>å¼€å¤´ï¼Œä»¥åœ†æ‹¬å·æˆ–èŠ±æ‹¬å·æŠŠå‡½æ•°åå’Œå‚æ•°æ‹¬èµ·ã€‚    </p><p>ç¤ºä¾‹ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">comma:= ,</span><br><span class="line">empty:=</span><br><span class="line">space:= <span class="variable">$(empty)</span> <span class="variable">$(empty)</span></span><br><span class="line">foo:= a b c</span><br><span class="line">bar:= <span class="variable">$(<span class="built_in">subst</span> <span class="variable">$(space)</span>,<span class="variable">$(comma)</span>,<span class="variable">$(foo)</span>)</span></span><br></pre></td></tr></table></figure></p><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>$(comma)</code>çš„å€¼æ˜¯ä¸€ä¸ªé€—å·ã€‚<code>$(space)</code>ä½¿ç”¨äº†<code>$(empty)</code>å®šä¹‰äº†ä¸€ä¸ªç©ºæ ¼ï¼Œ<code>$(foo)</code>çš„å€¼æ˜¯<code>a b c</code>ï¼Œ<code>$(bar)</code>çš„å®šä¹‰ç”¨ï¼Œè°ƒç”¨äº†å‡½æ•°<code>subst</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªæ›¿æ¢å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¢«æ›¿æ¢å­—ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ›¿æ¢å­—ä¸²ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ›¿æ¢æ“ä½œä½œç”¨çš„å­—ä¸²ã€‚è¿™ä¸ªå‡½æ•°ä¹Ÿå°±æ˜¯æŠŠ<code>$(foo)</code>ä¸­çš„ç©ºæ ¼æ›¿æ¢æˆé€—å·ï¼Œæ‰€ä»¥<code>$(bar)</code>çš„å€¼æ˜¯<code>a,b,c</code>ã€‚</p><h3 id="7-2-å­—ç¬¦ä¸²å¤„ç†å‡½æ•°"><a href="#7-2-å­—ç¬¦ä¸²å¤„ç†å‡½æ•°" class="headerlink" title="7.2 å­—ç¬¦ä¸²å¤„ç†å‡½æ•°"></a>7.2 å­—ç¬¦ä¸²å¤„ç†å‡½æ•°</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å­—ç¬¦ä¸²æ›¿æ¢å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">subst</span> &lt;from&gt;,&lt;to&gt;,&lt;text&gt;)</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">#æ¨¡å¼å­—ç¬¦ä¸²æ›¿æ¢å‡½æ•°             </span></span><br><span class="line"><span class="variable">$(<span class="built_in">patsubst</span> &lt;pattern&gt;,&lt;replacement&gt;,&lt;text&gt;)</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment">#å»ç©ºæ ¼å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">strip</span> &lt;string&gt;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥æ‰¾å­—ç¬¦ä¸²å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">findstring</span> &lt;find&gt;,&lt;in&gt;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿‡æ»¤å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">filter</span> &lt;pattern...&gt;,&lt;text&gt;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#åå‘è¿‡æ»¤å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">filter</span>-out &lt;pattern...&gt;,&lt;text&gt;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ’åºå‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">sort</span> &lt;list&gt;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å–å•è¯å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">word</span> &lt;n&gt;,&lt;text&gt;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å–å•è¯ä¸²å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">wordlist</span> &lt;s&gt;,&lt;e&gt;,&lt;text&gt;)</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">#å•è¯ä¸ªæ•°å‡½æ•°</span></span><br><span class="line"><span class="variable">$(words &lt;text&gt;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#é¦–å•è¯å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">firstword</span> &lt;text&gt;)</span></span><br></pre></td></tr></table></figure><ul><li><p><code>$(subst &lt;from&gt;,&lt;to&gt;,&lt;text&gt;)</code><br>åç§°ï¼šå­—ç¬¦ä¸²æ›¿æ¢å‡½æ•°â€”â€”substã€‚<br>åŠŸèƒ½ï¼šæŠŠå­—ä¸²<code>&lt;text&gt;</code>ä¸­çš„<code>&lt;from&gt;</code>å­—ç¬¦ä¸²æ›¿æ¢æˆ<code>&lt;to&gt;</code>ã€‚<br>è¿”å›ï¼šå‡½æ•°è¿”å›è¢«æ›¿æ¢è¿‡åçš„å­—ç¬¦ä¸²ã€‚<br>ç¤ºä¾‹ï¼š</p>  <figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(<span class="built_in">subst</span> ee,EE,feet on the street)</span></span><br></pre></td></tr></table></figure><p>  æŠŠ<code>feet on the street</code>ä¸­çš„<code>ee</code>æ›¿æ¢æˆ<code>EE</code>ï¼Œè¿”å›ç»“æœæ˜¯<code>fEEt on the strEEt</code>ã€‚</p></li><li><p><code>$(patsubst &lt;pattern&gt;,&lt;replacement&gt;,&lt;text&gt;)</code><br>åç§°ï¼šæ¨¡å¼å­—ç¬¦ä¸²æ›¿æ¢å‡½æ•°â€”â€”patsubstã€‚<br>åŠŸèƒ½ï¼šæŸ¥æ‰¾<code>&lt;text&gt;</code>ä¸­çš„å•è¯ï¼ˆå•è¯ä»¥â€œç©ºæ ¼â€ã€â€œTabâ€æˆ–â€œå›è½¦â€â€œæ¢è¡Œâ€åˆ†éš”ï¼‰æ˜¯å¦ç¬¦åˆæ¨¡å¼<code>&lt;pattern&gt;</code>ï¼Œå¦‚æœåŒ¹é…çš„è¯ï¼Œåˆ™ä»¥<code>&lt;replacement&gt;</code>æ›¿æ¢ã€‚è¿™é‡Œï¼Œ<code>&lt;pattern&gt;</code>å¯ä»¥åŒ…æ‹¬é€šé…ç¬¦<code>%</code>ï¼Œè¡¨ç¤ºä»»æ„é•¿åº¦çš„å­—ä¸²ã€‚å¦‚æœ<code>&lt;replacement&gt;</code>ä¸­ä¹ŸåŒ…å«<code>%</code>ï¼Œé‚£ä¹ˆï¼Œ<code>&lt;replacement&gt;</code>ä¸­çš„è¿™ä¸ª<code>%</code>å°†æ˜¯<code>&lt;pattern&gt;</code>ä¸­çš„é‚£ä¸ª<code>%</code>æ‰€ä»£è¡¨çš„å­—ä¸²ã€‚ï¼ˆå¯ä»¥ç”¨<code>/</code>æ¥è½¬ä¹‰ï¼Œä»¥<code>/%</code>æ¥è¡¨ç¤ºçœŸå®å«ä¹‰çš„<code>%</code>å­—ç¬¦ï¼‰<br>è¿”å›ï¼šå‡½æ•°è¿”å›è¢«æ›¿æ¢è¿‡åçš„å­—ç¬¦ä¸²ã€‚<br>ç¤ºä¾‹ï¼š</p>  <figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(<span class="built_in">patsubst</span> %.c,%.o,x.c.c bar.c)</span></span><br></pre></td></tr></table></figure><p>æŠŠå­—ä¸²<code>x.c.c bar.c</code>ç¬¦åˆæ¨¡å¼<code>[%.c]</code>çš„å•è¯æ›¿æ¢æˆ<code>[%.o]</code>ï¼Œè¿”å›ç»“æœæ˜¯<code>x.c.o bar.o</code><br>å¤‡æ³¨ï¼šè¿™ä¸5.3èŠ‚ä¸­çš„å˜é‡æ›¿æ¢å¾ˆç›¸ä¼¼ï¼Œä¸Šè¿°ç¤ºä¾‹å¦‚æœå†™ä¸ºï¼š<code>$(x.c.c bar.c: .c = .o)</code>ï¼Œåˆ™è¿”å›æœ‰äº›è®¸ä¸åŒï¼Œä¼šè¿”å›<code>x.o.o bar.o</code></p></li><li><p><code>$(strip &lt;string&gt;)</code><br>åç§°ï¼šå»ç©ºæ ¼å‡½æ•°â€”â€”stripã€‚<br>åŠŸèƒ½ï¼šå»æ‰<code>&lt;string&gt;</code>å­—ä¸²ä¸­<strong>å¼€å¤´å’Œç»“å°¾</strong>çš„ç©ºå­—ç¬¦ã€‚<br>è¿”å›ï¼šè¿”å›è¢«å»æ‰ç©ºæ ¼çš„å­—ç¬¦ä¸²å€¼ã€‚<br>ç¤ºä¾‹ï¼š</p>  <figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(<span class="built_in">strip</span> a b c )</span></span><br></pre></td></tr></table></figure><p>æŠŠå­—ä¸²<code>a b c</code>å»åˆ°å¼€å¤´å’Œç»“å°¾çš„ç©ºæ ¼ï¼Œç»“æœæ˜¯<code>a b c</code>ã€‚</p></li><li><p><code>$(findstring &lt;find&gt;,&lt;in&gt;)</code><br>åç§°ï¼šæŸ¥æ‰¾å­—ç¬¦ä¸²å‡½æ•°â€”â€”findstringã€‚<br>åŠŸèƒ½ï¼šåœ¨å­—ä¸²<code>&lt;in&gt;</code>ä¸­æŸ¥æ‰¾<code>&lt;find&gt;</code>å­—ä¸²ã€‚<br>è¿”å›ï¼šå¦‚æœæ‰¾åˆ°ï¼Œé‚£ä¹ˆè¿”å›<code>&lt;find&gt;</code>ï¼Œå¦åˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚<br>ç¤ºä¾‹ï¼š</p>  <figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(<span class="built_in">findstring</span> a,a b c)</span></span><br><span class="line"><span class="variable">$(<span class="built_in">findstring</span> a,b c)</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‡½æ•°è¿”å›<code>a</code>å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªè¿”å›â€œâ€å­—ç¬¦ä¸²ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰</p></li><li><p><code>$(filter &lt;pattern...&gt;, &lt;text&gt;)</code><br>åç§°ï¼šè¿‡æ»¤å‡½æ•°â€”â€”filterã€‚<br>åŠŸèƒ½ï¼šä»¥<code>&lt;pattern&gt;</code>æ¨¡å¼è¿‡æ»¤<code>&lt;text&gt;</code>å­—ç¬¦ä¸²ä¸­çš„å•è¯ï¼Œ<strong>ä¿ç•™</strong>ç¬¦åˆæ¨¡å¼<code>&lt;pattern&gt;</code>çš„å•è¯ã€‚å¯ä»¥æœ‰å¤šä¸ªæ¨¡å¼ã€‚<br>è¿”å›ï¼šè¿”å›ç¬¦åˆæ¨¡å¼<code>&lt;pattern&gt;</code>çš„å­—ä¸²ã€‚<br>ç¤ºä¾‹ï¼š</p>  <figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sources := foo.c bar.c baz.s ugh.h</span><br><span class="line"><span class="section">foo: <span class="variable">$(sources)</span></span></span><br><span class="line">  cc <span class="variable">$(<span class="built_in">filter</span> %.c %.s, <span class="variable">$(sources)</span>)</span> -o foo</span><br><span class="line"><span class="variable">$(<span class="built_in">filter</span> %.c %.s,<span class="variable">$(sources)</span>)</span></span><br></pre></td></tr></table></figure><p>è¿”å›çš„å€¼æ˜¯<code>foo.c bar.c baz.s</code>ã€‚</p></li><li><p><code>$(filter-out &lt;pattern...&gt;,&lt;text&gt;)</code><br>åç§°ï¼šåè¿‡æ»¤å‡½æ•°â€”â€”filter-outã€‚<br>åŠŸèƒ½ï¼šä»¥<code>&lt;pattern&gt;</code>æ¨¡å¼è¿‡æ»¤<code>&lt;text&gt;</code>å­—ç¬¦ä¸²ä¸­çš„å•è¯ï¼Œ<strong>å»é™¤</strong>ç¬¦åˆæ¨¡å¼<code>&lt;pattern&gt;</code>çš„å•è¯ã€‚å¯ä»¥æœ‰å¤šä¸ªæ¨¡å¼ã€‚<br>è¿”å›ï¼šè¿”å›ä¸ç¬¦åˆæ¨¡å¼<code>&lt;pattern&gt;</code>çš„å­—ä¸²ã€‚<br>ç¤ºä¾‹ï¼šå˜é‡å®šä¹‰ä¸ä¸Šç›¸åŒï¼Œ<code>$(filter-out %.c %.s,$(sources))</code>ï¼Œè¿”å›å€¼æ˜¯<code>ugh.h</code>ã€‚      </p></li><li><p><code>$(sort &lt;list&gt;)</code><br>åç§°ï¼šæ’åºå‡½æ•°â€”â€”sortã€‚<br>åŠŸèƒ½ï¼šç»™å­—ç¬¦ä¸²<code>&lt;list&gt;</code>ä¸­çš„å•è¯æ’åºï¼ˆå‡åºï¼‰ã€‚<br>è¿”å›ï¼šè¿”å›æ’åºåçš„å­—ç¬¦ä¸²ã€‚<br>ç¤ºä¾‹ï¼š<code>$(sort foo bar lose)</code>è¿”å›<code>bar foo lose</code>ã€‚<br>å¤‡æ³¨ï¼šsortå‡½æ•°ä¼šå»æ‰<code>&lt;list&gt;</code>ä¸­ç›¸åŒçš„å•è¯ã€‚</p></li><li><p><code>(word &lt;n&gt;,&lt;text&gt;)</code><br>åç§°ï¼šå–å•è¯å‡½æ•°â€”â€”wordã€‚<br>åŠŸèƒ½ï¼šå–å­—ç¬¦ä¸²<code>&lt;text&gt;</code>ä¸­ç¬¬<code>&lt;n&gt;</code>ä¸ªå•è¯ã€‚ï¼ˆä»ä¸€å¼€å§‹ï¼‰<br>è¿”å›ï¼šè¿”å›å­—ç¬¦ä¸²<code>&lt;text&gt;</code>ä¸­ç¬¬<code>&lt;n&gt;</code>ä¸ªå•è¯ã€‚å¦‚æœ<code>&lt;n&gt;</code>æ¯”<code>&lt;text&gt;</code>ä¸­çš„å•è¯æ•°è¦å¤§ï¼Œé‚£ä¹ˆè¿”å›ç©ºå­—ç¬¦ä¸²ã€‚<br>ç¤ºä¾‹ï¼š$(word 2, foo bar baz)è¿”å›å€¼æ˜¯â€œbarâ€ã€‚</p></li><li><p><code>(wordlist &lt;s&gt;,&lt;e&gt;,&lt;text&gt;)</code><br>åç§°ï¼šå–å•è¯ä¸²å‡½æ•°â€”â€”wordlistã€‚<br>åŠŸèƒ½ï¼šä»å­—ç¬¦ä¸²<code>&lt;text&gt;</code>ä¸­å–ä»<code>&lt;s&gt;</code>å¼€å§‹åˆ°<code>&lt;e&gt;</code>çš„å•è¯ä¸²ã€‚<code>&lt;s&gt;</code>å’Œ<code>&lt;e&gt;</code>æ˜¯ä¸€ä¸ªæ•°å­—ã€‚<br>è¿”å›ï¼šè¿”å›å­—ç¬¦ä¸²<code>&lt;text&gt;</code>ä¸­ä»<code>&lt;s&gt;</code>åˆ°<code>&lt;e&gt;</code>çš„å•è¯å­—ä¸²ã€‚å¦‚æœ<code>&lt;s&gt;</code>å¤§äº<code>&lt;text&gt;</code>çš„å•è¯æ•°ï¼Œé‚£ä¹ˆè¿”å›ç©ºå­—ç¬¦ä¸²ã€‚å¦‚æœ<code>&lt;e&gt;</code>å¤§äº<code>&lt;text&gt;</code>çš„å•è¯æ•°ï¼Œé‚£ä¹ˆè¿”å›ä»<code>&lt;s&gt;</code>å¼€å§‹ï¼Œåˆ°<code>&lt;text&gt;</code>ç»“æŸçš„å•è¯ä¸²ã€‚<br>ç¤ºä¾‹ï¼š <code>$(wordlist 2, 3, foo bar baz)</code>è¿”å›å€¼æ˜¯<code>bar baz</code>ã€‚</p></li><li><p><code>$(words &lt;text&gt;)</code><br>åç§°ï¼šå•è¯ä¸ªæ•°ç»Ÿè®¡å‡½æ•°â€”â€”wordsã€‚<br>åŠŸèƒ½ï¼šç»Ÿè®¡<code>&lt;text&gt;</code>ä¸­å­—ç¬¦ä¸²ä¸­çš„å•è¯ä¸ªæ•°ã€‚<br>è¿”å›ï¼šè¿”å›<code>&lt;text&gt;</code>ä¸­çš„å•è¯æ•°ã€‚<br>ç¤ºä¾‹ï¼š<code>$(words, foo bar baz)</code>è¿”å›å€¼æ˜¯<code>3</code>ã€‚<br>å¤‡æ³¨ï¼šå¦‚æœæˆ‘ä»¬è¦å–<code>&lt;text&gt;</code>ä¸­æœ€åçš„ä¸€ä¸ªå•è¯ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ï¼š<code>$(word $(words &lt;text&gt;),&lt;text&gt;)</code>ã€‚</p></li><li><p><code>$(firstword &lt;text&gt;)</code><br>åç§°ï¼šé¦–å•è¯å‡½æ•°â€”â€”firstwordã€‚<br>åŠŸèƒ½ï¼šå–å­—ç¬¦ä¸²&lt;<code>text&gt;</code>ä¸­çš„ç¬¬ä¸€ä¸ªå•è¯ã€‚<br>è¿”å›ï¼šè¿”å›å­—ç¬¦ä¸²<code>&lt;text&gt;</code>çš„ç¬¬ä¸€ä¸ªå•è¯ã€‚<br>ç¤ºä¾‹ï¼š<code>$(firstword foo bar)</code>è¿”å›å€¼æ˜¯<code>foo</code>ã€‚<br>å¤‡æ³¨ï¼šè¿™ä¸ªå‡½æ•°å¯ä»¥ç”¨wordå‡½æ•°æ¥å®ç°ï¼š<code>$(word 1, &lt;text&gt;)</code>ã€‚</p></li></ul><p>ä»¥ä¸Šï¼Œæ˜¯æ‰€æœ‰çš„å­—ç¬¦ä¸²æ“ä½œå‡½æ•°ï¼Œå¦‚æœæ­é…æ··åˆä½¿ç”¨ï¼Œå¯ä»¥å®Œæˆæ¯”è¾ƒå¤æ‚çš„åŠŸèƒ½ã€‚è¿™é‡Œï¼Œä¸¾ä¸€ä¸ªç°å®ä¸­åº”ç”¨çš„ä¾‹å­ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œmakeä½¿ç”¨<code>VPATH</code>å˜é‡æ¥æŒ‡å®šâ€œä¾èµ–æ–‡ä»¶â€çš„æœç´¢è·¯å¾„ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæœç´¢è·¯å¾„æ¥æŒ‡å®šç¼–è¯‘å™¨å¯¹å¤´æ–‡ä»¶çš„æœç´¢è·¯å¾„å‚æ•°<code>CFLAGS</code>ï¼Œå¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> CFLAGS += <span class="variable">$(<span class="built_in">patsubst</span> %,-I%,$(<span class="built_in">subst</span> :, ,<span class="variable">$(VPATH)</span>)</span>)</span><br></pre></td></tr></table></figure></p><p>å¦‚æœæˆ‘ä»¬çš„<code>$(VPATH)</code>å€¼æ˜¯<code>src:../headers</code>ï¼Œé‚£ä¹ˆ<code>$(patsubst %,-I%,$(subst :, ,$(VPATH)))</code>å°†è¿”å›<code>-Isrc -I../headers</code>ï¼ˆæ‰€æœ‰å•è¯çš„å‰é¢åŠ -Iï¼‰ï¼Œè¿™æ­£æ˜¯ccæˆ–gccæœç´¢å¤´æ–‡ä»¶è·¯å¾„çš„å‚æ•°ã€‚</p><h3 id="7-3-æ–‡ä»¶åæ“ä½œå‡½æ•°"><a href="#7-3-æ–‡ä»¶åæ“ä½œå‡½æ•°" class="headerlink" title="7.3 æ–‡ä»¶åæ“ä½œå‡½æ•°"></a>7.3 æ–‡ä»¶åæ“ä½œå‡½æ•°</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å–ç›®å½•å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">dir</span> &lt;names...&gt;)</span></span><br><span class="line"><span class="comment">#ä»æ–‡ä»¶ååºåˆ—&lt;names&gt;ä¸­å–å‡ºç›®å½•éƒ¨åˆ†ã€‚ç›®å½•éƒ¨åˆ†æ˜¯æŒ‡æœ€åä¸€ä¸ªåæ–œæ ï¼ˆâ€œ/â€ï¼‰ä¹‹å‰çš„éƒ¨åˆ†ã€‚å¦‚æœæ²¡æœ‰åæ–œæ ï¼Œé‚£ä¹ˆè¿”å›â€œ./â€ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å–æ–‡ä»¶å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">notdir</span> &lt;names...&gt;)</span></span><br><span class="line"><span class="comment">#ä»æ–‡ä»¶ååºåˆ—&lt;names&gt;ä¸­å–å‡ºéç›®å½•éƒ¨åˆ†ã€‚éç›®å½•éƒ¨åˆ†æ˜¯æŒ‡æœ€åä¸€ä¸ªåæ–œæ ï¼ˆâ€œ/â€ï¼‰ä¹‹åçš„éƒ¨åˆ†ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å–åç¼€å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">suffix</span> &lt;names...&gt;)</span></span><br><span class="line"><span class="comment">#ä»æ–‡ä»¶ååºåˆ—&lt;names&gt;ä¸­å–å‡ºå„ä¸ªæ–‡ä»¶åçš„åç¼€ã€‚è¿”å›ä¸€ä¸ªåç¼€åºåˆ—ã€‚ï¼ˆæ²¡æœ‰.çš„é¡¹å°±æ— è§†ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å–å‰ç¼€å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">basename</span> &lt;names...&gt;)</span></span><br><span class="line"><span class="comment">#ä»æ–‡ä»¶ååºåˆ—&lt;names&gt;ä¸­å–å‡ºå„ä¸ªæ–‡ä»¶åçš„å‰ç¼€éƒ¨åˆ†ã€‚è¿”å›ä¸€ä¸ªå‰ç¼€åºåˆ—ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#åŠ åç¼€å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">addsuffix</span> &lt;<span class="built_in">suffix</span>&gt;,&lt;names...&gt;)</span></span><br><span class="line"><span class="comment">#æŠŠåç¼€&lt;suffix&gt;åŠ åˆ°&lt;names&gt;ä¸­çš„æ¯ä¸ªå•è¯åé¢ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#åŠ å‰ç¼€å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">addprefix</span> &lt;prefix&gt;,&lt;names...&gt;)</span></span><br><span class="line"><span class="comment">#æŠŠå‰ç¼€&lt;prefix&gt;åŠ åˆ°&lt;names&gt;ä¸­çš„æ¯ä¸ªå•è¯åé¢ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿æ¥å‡½æ•°</span></span><br><span class="line"><span class="variable">$(<span class="built_in">join</span> &lt;list1&gt;,&lt;list2&gt;)</span></span><br><span class="line"><span class="comment">#æŠŠ&lt;list2&gt;ä¸­çš„å•è¯å¯¹åº”åœ°åŠ åˆ°&lt;list1&gt;çš„å•è¯åé¢ã€‚å¦‚æœ&lt;list1&gt;çš„å•è¯ä¸ªæ•°è¦æ¯”&lt;list2&gt;çš„å¤šï¼Œé‚£ä¹ˆï¼Œ&lt;list1&gt;ä¸­çš„å¤šå‡ºæ¥çš„å•è¯å°†ä¿æŒåŸæ ·ã€‚å¦‚æœ&lt;list2&gt;çš„å•è¯ä¸ªæ•°è¦æ¯”&lt;list1&gt;å¤šï¼Œé‚£ä¹ˆï¼Œ&lt;list2&gt;å¤šå‡ºæ¥çš„å•è¯å°†è¢«å¤åˆ¶åˆ°&lt;list2&gt;ä¸­ã€‚</span></span><br></pre></td></tr></table></figure><h3 id="7-4-foreachå‡½æ•°"><a href="#7-4-foreachå‡½æ•°" class="headerlink" title="7.4 foreachå‡½æ•°"></a>7.4 foreachå‡½æ•°</h3><p><code>foreach</code>å‡½æ•°å’Œåˆ«çš„å‡½æ•°éå¸¸çš„ä¸ä¸€æ ·ã€‚å› ä¸ºè¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥åšå¾ªç¯ç”¨çš„ï¼ŒMakefileä¸­çš„<code>foreach</code>å‡½æ•°å‡ ä¹æ˜¯ä»¿ç…§äºUnixæ ‡å‡†Shellï¼ˆ/bin/shï¼‰ä¸­çš„forè¯­å¥ï¼Œæˆ–æ˜¯C-Shellï¼ˆ/bin/cshï¼‰ä¸­çš„foreachè¯­å¥è€Œæ„å»ºçš„ã€‚å…¶è¯­æ³•ä¸ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(foreach &lt;var&gt;,&lt;list&gt;,&lt;text&gt;)</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªå‡½æ•°çš„æ„æ€æ˜¯ï¼ŒæŠŠå‚æ•°<code>&lt;list&gt;</code>ä¸­çš„å•è¯é€ä¸€å–å‡ºæ”¾åˆ°å‚æ•°<code>&lt;var&gt;</code>æ‰€æŒ‡å®šçš„å˜é‡ä¸­ï¼Œç„¶åå†æ‰§è¡Œ<code>&lt;text&gt;</code>æ‰€åŒ…å«çš„è¡¨è¾¾å¼ã€‚æ¯ä¸€æ¬¡<code>&lt;text&gt;</code>ä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¾ªç¯è¿‡ç¨‹ä¸­ï¼Œ<code>&lt;text&gt;</code>çš„æ‰€è¿”å›çš„æ¯ä¸ªå­—ç¬¦ä¸²ä¼šä»¥ç©ºæ ¼åˆ†éš”ï¼Œæœ€åå½“æ•´ä¸ªå¾ªç¯ç»“æŸæ—¶ï¼Œ<code>&lt;text&gt;</code>æ‰€è¿”å›çš„æ¯ä¸ªå­—ç¬¦ä¸²æ‰€ç»„æˆçš„æ•´ä¸ªå­—ç¬¦ä¸²ï¼ˆä»¥ç©ºæ ¼åˆ†éš”ï¼‰å°†ä¼šæ˜¯<code>foreach</code>å‡½æ•°çš„è¿”å›å€¼ã€‚</p><p>ä¾‹å­ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">names := a b c d</span><br><span class="line">files := <span class="variable">$(<span class="built_in">foreach</span> n,<span class="variable">$(names)</span>,<span class="variable">$(n)</span>.o)</span></span><br></pre></td></tr></table></figure></p><p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>$(name)</code>ä¸­çš„å•è¯ä¼šè¢«æŒ¨ä¸ªå–å‡ºï¼Œå¹¶å­˜åˆ°å˜é‡<code>n</code>ä¸­ï¼Œ<code>$(n).o</code>æ¯æ¬¡æ ¹æ®<code>$(n)</code>è®¡ç®—å‡ºä¸€ä¸ªå€¼ï¼Œè¿™äº›å€¼ä»¥ç©ºæ ¼åˆ†éš”ï¼Œæœ€åä½œä¸º<code>foreach</code>å‡½æ•°çš„è¿”å›ï¼Œæ‰€ä»¥ï¼Œ<code>$(files)</code>çš„å€¼æ˜¯<code>a.o b.o c.o d.o</code>ã€‚</p><h3 id="7-5-ifå‡½æ•°"><a href="#7-5-ifå‡½æ•°" class="headerlink" title="7.5 ifå‡½æ•°"></a>7.5 ifå‡½æ•°</h3><p>ifå‡½æ•°çš„è¯­æ³•ä¸ºï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(<span class="built_in">if</span> &lt;condition&gt;,&lt;then-part&gt;)</span></span><br><span class="line"><span class="comment">#æˆ–è€…æ˜¯</span></span><br><span class="line"><span class="variable">$(<span class="built_in">if</span> &lt;condition&gt;,&lt;then-part&gt;,&lt;else-part&gt;)</span></span><br></pre></td></tr></table></figure></p><p>å¯è§ï¼Œifå‡½æ•°å¯ä»¥åŒ…å«â€œelseâ€éƒ¨åˆ†ï¼Œæˆ–æ˜¯ä¸å«ã€‚å³ifå‡½æ•°çš„å‚æ•°å¯ä»¥æ˜¯ä¸¤ä¸ªï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸‰ä¸ªã€‚<br><code>&lt;condition&gt;</code>å‚æ•°æ˜¯ifçš„è¡¨è¾¾å¼ï¼Œå¦‚æœå…¶è¿”å›çš„ä¸ºéç©ºå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡¨è¾¾å¼å°±ç›¸å½“äºè¿”å›çœŸï¼Œäºæ˜¯ï¼Œ<code>&lt;then-part&gt;</code>ä¼šè¢«è®¡ç®—ï¼Œå¦åˆ™<code>&lt;else-part&gt;</code>ä¼šè¢«è®¡ç®—ã€‚</p><p>è€Œifå‡½æ•°çš„è¿”å›å€¼æ˜¯ï¼Œå¦‚æœ<code>&lt;condition&gt;</code>ä¸ºçœŸï¼ˆéç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œé‚£ä¸ª<code>&lt;then-part&gt;</code>ä¼šæ˜¯æ•´ä¸ªå‡½æ•°çš„è¿”å›å€¼ï¼Œå¦‚æœ<code>&lt;condition&gt;</code>ä¸ºå‡ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œé‚£ä¹ˆ<code>&lt;else-part&gt;</code>ä¼šæ˜¯æ•´ä¸ªå‡½æ•°çš„è¿”å›å€¼ï¼Œæ­¤æ—¶å¦‚æœ<code>&lt;else-part&gt;</code>æ²¡æœ‰è¢«å®šä¹‰ï¼Œé‚£ä¹ˆï¼Œæ•´ä¸ªå‡½æ•°è¿”å›ç©ºå­—ä¸²ã€‚</p><h3 id="7-6-callå‡½æ•°"><a href="#7-6-callå‡½æ•°" class="headerlink" title="7.6 callå‡½æ•°"></a>7.6 callå‡½æ•°</h3><p>callå‡½æ•°æ˜¯å¯ä»¥åˆ›å»ºæ–°çš„å‚æ•°åŒ–çš„å‡½æ•°ï¼Œä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ªã€‚<br>ä½ å¯ä»¥å†™ä¸€ä¸ªéå¸¸å¤æ‚çš„è¡¨è¾¾å¼ï¼Œè¿™ä¸ªè¡¨è¾¾å¼ä¸­ï¼Œä½ å¯ä»¥å®šä¹‰è®¸å¤šå‚æ•°ï¼Œç„¶åä½ å¯ä»¥ç”¨callå‡½æ•°æ¥å‘è¿™ä¸ªè¡¨è¾¾å¼ä¼ é€’å‚æ•°ã€‚å…¶è¯­æ³•æ˜¯ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(<span class="built_in">call</span> &lt;expression&gt;,&lt;parm1&gt;,&lt;parm2&gt;,&lt;parm3&gt;...)</span></span><br></pre></td></tr></table></figure></p><p>å½“makeæ‰§è¡Œè¿™ä¸ªå‡½æ•°æ—¶ï¼Œ<code>&lt;expression&gt;</code>å‚æ•°ä¸­çš„å˜é‡ï¼Œå¦‚<code>$(1)</code>ï¼Œ<code>$(2)</code>ï¼Œ<code>$(3)</code>ç­‰ï¼Œä¼šè¢«å‚æ•°<code>&lt;parm1&gt;</code>ï¼Œ<code>&lt;parm2&gt;</code>ï¼Œ<code>&lt;parm3&gt;</code>ä¾æ¬¡å–ä»£ã€‚è€Œ<code>&lt;expression&gt;</code>çš„è¿”å›å€¼å°±æ˜¯callå‡½æ•°çš„è¿”å›å€¼ã€‚ä¾‹å¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reverse =  $(1) $(2)</span><br><span class="line">foo = <span class="variable">$(<span class="built_in">call</span> reverse,a,b)</span></span><br></pre></td></tr></table></figure></p><p>é‚£ä¹ˆï¼Œfooçš„å€¼å°±æ˜¯<code>a b</code>ã€‚å½“ç„¶ï¼Œå‚æ•°çš„æ¬¡åºæ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ï¼Œä¸ä¸€å®šæ˜¯é¡ºåºçš„ï¼Œå¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reverse =  $(2) $(1)</span><br><span class="line">foo = <span class="variable">$(<span class="built_in">call</span> reverse,a,b)</span></span><br></pre></td></tr></table></figure></p><p>æ­¤æ—¶çš„fooçš„å€¼å°±æ˜¯<code>b a</code>ã€‚</p><ul><li>ç–‘é—®ï¼šä¸€å®šæ˜¯<code>$(1)</code>ã€<code>$(2)</code>è¿™ç§å½¢å¼å—ï¼Ÿ</li></ul><h3 id="7-7-originå‡½æ•°"><a href="#7-7-originå‡½æ•°" class="headerlink" title="7.7 originå‡½æ•°"></a>7.7 originå‡½æ•°</h3><p>originå‡½æ•°ä¸åƒå…¶å®ƒçš„å‡½æ•°ï¼Œä»–å¹¶ä¸æ“ä½œå˜é‡çš„å€¼ï¼Œä»–åªæ˜¯å‘Šè¯‰ä½ ä½ çš„è¿™ä¸ªå˜é‡æ˜¯å“ªé‡Œæ¥çš„ï¼Ÿå…¶è¯­æ³•æ˜¯ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(<span class="built_in">origin</span> &lt;variable&gt;)</span></span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ï¼Œ<code>&lt;variable&gt;</code>æ˜¯å˜é‡çš„åå­—ï¼Œä¸åº”è¯¥æ˜¯å¼•ç”¨ã€‚æ‰€ä»¥ä½ æœ€å¥½ä¸è¦åœ¨<code>&lt;variable&gt;</code>ä¸­ä½¿ç”¨<code>$</code>å­—ç¬¦ã€‚Originå‡½æ•°ä¼šä»¥å…¶è¿”å›å€¼æ¥å‘Šè¯‰ä½ è¿™ä¸ªå˜é‡çš„â€œå‡ºç”Ÿæƒ…å†µâ€ï¼Œä¸‹é¢ï¼Œæ˜¯originå‡½æ•°çš„è¿”å›å€¼:</p><ul><li><code>undefined</code>  <code>&lt;variable&gt;</code>ä»æ¥æ²¡æœ‰å®šä¹‰è¿‡ã€‚</li><li><code>default</code>  <code>&lt;variable&gt;</code>æ˜¯ä¸€ä¸ªé»˜è®¤çš„å®šä¹‰ï¼Œæ¯”å¦‚<code>CC</code>è¿™ä¸ªå˜é‡ã€‚</li><li><code>environment</code>  <code>&lt;variable&gt;</code>æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œå¹¶ä¸”å½“Makefileè¢«æ‰§è¡Œæ—¶ï¼Œ<code>-e</code>å‚æ•°æ²¡æœ‰è¢«æ‰“å¼€ã€‚</li><li><code>file</code>  <code>&lt;variable&gt;</code>è¿™ä¸ªå˜é‡è¢«å®šä¹‰åœ¨Makefileä¸­ã€‚</li><li><code>command line</code>  <code>&lt;variable&gt;</code>è¿™ä¸ªå˜é‡æ˜¯è¢«å‘½ä»¤è¡Œå®šä¹‰çš„ã€‚</li><li><code>override</code>  <code>&lt;variable&gt;</code>æ˜¯è¢«overrideæŒ‡ç¤ºç¬¦é‡æ–°å®šä¹‰çš„ã€‚</li><li><code>automatic</code>  <code>&lt;variable&gt;</code>æ˜¯ä¸€ä¸ªå‘½ä»¤è¿è¡Œä¸­çš„è‡ªåŠ¨åŒ–å˜é‡ã€‚</li></ul><p>è¿™äº›ä¿¡æ¯å¯¹äºæˆ‘ä»¬ç¼–å†™Makefileæ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªMakefileå…¶åŒ…äº†ä¸€ä¸ªå®šä¹‰æ–‡ä»¶Make.defï¼Œåœ¨Make.defä¸­å®šä¹‰äº†ä¸€ä¸ªå˜é‡<code>bletch</code>ï¼Œè€Œæˆ‘ä»¬çš„ç¯å¢ƒä¸­ä¹Ÿæœ‰ä¸€ä¸ªç¯å¢ƒå˜é‡<code>bletch</code>ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬æƒ³åˆ¤æ–­ä¸€ä¸‹ï¼Œå¦‚æœå˜é‡æ¥æºäºç¯å¢ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æŠŠä¹‹é‡å®šä¹‰äº†ï¼Œå¦‚æœæ¥æºäºMake.defæˆ–æ˜¯å‘½ä»¤è¡Œç­‰éç¯å¢ƒçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸é‡æ–°å®šä¹‰å®ƒã€‚äºæ˜¯ï¼Œåœ¨æˆ‘ä»¬çš„Makefileä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ifdef</span> bletch</span><br><span class="line">  <span class="keyword">ifeq</span> <span class="string">"$(origin bletch)"</span> <span class="string">"environment"</span></span><br><span class="line">    bletch = barf, gag, etc.</span><br><span class="line">  <span class="keyword">endif</span></span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure></p><p>ä¸<code>override</code>å¯¹æ¯”ï¼Œ<code>override</code>ä¼šé‡æ–°å®šä¹‰æ‰€æœ‰ç§ç±»çš„å˜é‡ï¼Œè¿™ç§æ–¹å¼åªä¼šé‡æ–°å®šä¹‰ç¯å¢ƒå˜é‡ã€‚</p><h3 id="7-8-shellå‡½æ•°"><a href="#7-8-shellå‡½æ•°" class="headerlink" title="7.8 shellå‡½æ•°"></a>7.8 shellå‡½æ•°</h3><p>shellå‡½æ•°ä¹Ÿä¸åƒå…¶å®ƒçš„å‡½æ•°ã€‚é¡¾åæ€ä¹‰ï¼Œå®ƒçš„å‚æ•°åº”è¯¥å°±æ˜¯æ“ä½œç³»ç»ŸShellçš„å‘½ä»¤ã€‚å®ƒå’Œåå¼•å·`æ˜¯ç›¸åŒçš„åŠŸèƒ½ã€‚è¿™å°±æ˜¯è¯´ï¼Œshellå‡½æ•°æŠŠæ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤åçš„è¾“å‡ºä½œä¸ºå‡½æ•°è¿”å›ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ“ä½œç³»ç»Ÿå‘½ä»¤ä»¥åŠå­—ç¬¦ä¸²å¤„ç†å‘½ä»¤<code>awk</code>ï¼Œ<code>sed</code>ç­‰ç­‰å‘½ä»¤æ¥ç”Ÿæˆä¸€ä¸ªå˜é‡ï¼Œå¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">contents := <span class="variable">$(<span class="built_in">shell</span> cat foo)</span></span><br><span class="line">files := <span class="variable">$(<span class="built_in">shell</span> echo *.c)</span></span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ï¼Œè¿™ä¸ªå‡½æ•°ä¼šæ–°ç”Ÿæˆä¸€ä¸ªShellç¨‹åºæ¥æ‰§è¡Œå‘½ä»¤ï¼Œæ‰€ä»¥ä½ è¦æ³¨æ„å…¶è¿è¡Œæ€§èƒ½ï¼Œå¦‚æœä½ çš„Makefileä¸­æœ‰ä¸€äº›æ¯”è¾ƒå¤æ‚çš„è§„åˆ™ï¼Œå¹¶å¤§é‡ä½¿ç”¨äº†è¿™ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆå¯¹äºä½ çš„ç³»ç»Ÿæ€§èƒ½æ˜¯æœ‰å®³çš„ã€‚ç‰¹åˆ«æ˜¯Makefileçš„éšæ™¦çš„è§„åˆ™å¯èƒ½ä¼šè®©ä½ çš„shellå‡½æ•°æ‰§è¡Œçš„æ¬¡æ•°æ¯”ä½ æƒ³åƒçš„å¤šå¾—å¤šã€‚</p><h3 id="7-9-æ§åˆ¶makeçš„å‡½æ•°"><a href="#7-9-æ§åˆ¶makeçš„å‡½æ•°" class="headerlink" title="7.9 æ§åˆ¶makeçš„å‡½æ•°"></a>7.9 æ§åˆ¶makeçš„å‡½æ•°</h3><p>makeæä¾›äº†ä¸€äº›å‡½æ•°æ¥æ§åˆ¶makeçš„è¿è¡Œã€‚é€šå¸¸ï¼Œä½ éœ€è¦æ£€æµ‹ä¸€äº›è¿è¡ŒMakefileæ—¶çš„è¿è¡Œæ—¶ä¿¡æ¯ï¼Œå¹¶ä¸”æ ¹æ®è¿™äº›ä¿¡æ¯æ¥å†³å®šï¼Œä½ æ˜¯è®©makeç»§ç»­æ‰§è¡Œï¼Œè¿˜æ˜¯åœæ­¢ã€‚</p><ul><li><p><code>$(error &lt;text ...&gt;)</code></p><p>äº§ç”Ÿä¸€ä¸ªè‡´å‘½çš„é”™è¯¯ï¼Œ<code>&lt;text ...&gt;</code>æ˜¯é”™è¯¯ä¿¡æ¯ã€‚æ³¨æ„ï¼Œerrorå‡½æ•°ä¸ä¼šåœ¨ä¸€è¢«ä½¿ç”¨å°±ä¼šäº§ç”Ÿé”™è¯¯ä¿¡æ¯ï¼Œæ‰€ä»¥å¦‚æœä½ æŠŠå…¶å®šä¹‰åœ¨æŸä¸ªå˜é‡ä¸­ï¼Œå¹¶åœ¨åç»­çš„è„šæœ¬ä¸­ä½¿ç”¨è¿™ä¸ªå˜é‡ï¼Œé‚£ä¹ˆä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¤ºä¾‹ä¸€ï¼š</span></span><br><span class="line"><span class="keyword">ifdef</span> ERROR_001</span><br><span class="line"><span class="variable">$(<span class="built_in">error</span> <span class="built_in">error</span> is <span class="variable">$(ERROR_001)</span>)</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¤ºä¾‹äºŒï¼š</span></span><br><span class="line">ERR = <span class="variable">$(<span class="built_in">error</span> found an <span class="built_in">error</span>!)</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">.PHONY</span>: err</span></span><br><span class="line"><span class="section">err: ; <span class="variable">$(ERR)</span></span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ä¸€ä¼šåœ¨å˜é‡ERROR_001å®šä¹‰äº†åæ‰§è¡Œæ—¶äº§ç”Ÿerrorè°ƒç”¨ï¼Œè€Œç¤ºä¾‹äºŒåˆ™åœ¨ç›®å½•errè¢«æ‰§è¡Œæ—¶æ‰å‘ç”Ÿerrorè°ƒç”¨ã€‚</p></li><li><p><code>(warning &lt;text ...&gt;)</code><br> è¿™ä¸ªå‡½æ•°å¾ˆåƒerrorå‡½æ•°ï¼Œåªæ˜¯å®ƒå¹¶ä¸ä¼šè®©makeé€€å‡ºï¼Œåªæ˜¯è¾“å‡ºä¸€æ®µè­¦å‘Šä¿¡æ¯ï¼Œè€Œmakeç»§ç»­æ‰§è¡Œã€‚</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;5-ä½¿ç”¨å˜é‡&quot;&gt;&lt;a href=&quot;#5-ä½¿ç”¨å˜é‡&quot; class=&quot;headerlink&quot; title=&quot;5 ä½¿ç”¨å˜é‡&quot;&gt;&lt;/a&gt;5 ä½¿ç”¨å˜é‡&lt;/h2&gt;&lt;p&gt;åœ¨Makefileä¸­çš„å®šä¹‰çš„å˜é‡ï¼Œå°±åƒæ˜¯C/C++è¯­è¨€ä¸­çš„å®ä¸€æ ·ï¼Œä»–ä»£è¡¨äº†ä¸€ä¸ªæ–‡æœ¬å­—ä¸²ï¼Œåœ¨Makefileä¸­
      
    
    </summary>
    
      <category term="æ•™ç¨‹" scheme="http://yoursite.com/categories/%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="Makefile" scheme="http://yoursite.com/tags/Makefile/"/>
    
      <category term="ç¼–è¯‘" scheme="http://yoursite.com/tags/%E7%BC%96%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>Makefileå­¦ä¹ ï¼ˆä¸€ï¼‰</title>
    <link href="http://yoursite.com/2018/08/17/makefile(1)/"/>
    <id>http://yoursite.com/2018/08/17/makefile(1)/</id>
    <published>2018-08-17T15:00:00.000Z</published>
    <updated>2020-05-10T07:07:14.002Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0-ä»€ä¹ˆæ˜¯Makeflie"><a href="#0-ä»€ä¹ˆæ˜¯Makeflie" class="headerlink" title="0 ä»€ä¹ˆæ˜¯Makeflie"></a>0 ä»€ä¹ˆæ˜¯Makeflie</h2><h3 id="0-1-makefileå…³ç³»åˆ°äº†æ•´ä¸ªå·¥ç¨‹çš„ç¼–è¯‘è§„åˆ™"><a href="#0-1-makefileå…³ç³»åˆ°äº†æ•´ä¸ªå·¥ç¨‹çš„ç¼–è¯‘è§„åˆ™" class="headerlink" title="0.1 makefileå…³ç³»åˆ°äº†æ•´ä¸ªå·¥ç¨‹çš„ç¼–è¯‘è§„åˆ™"></a>0.1 makefileå…³ç³»åˆ°äº†æ•´ä¸ªå·¥ç¨‹çš„ç¼–è¯‘è§„åˆ™</h3><p>ä¸€ä¸ªå·¥ç¨‹ä¸­çš„æºæ–‡ä»¶ä¸è®¡æ•°ï¼Œå…¶æŒ‰ç±»å‹ã€åŠŸèƒ½ã€æ¨¡å—åˆ†åˆ«æ”¾åœ¨è‹¥å¹²ä¸ªç›®å½•ä¸­ï¼Œmakefileå®šä¹‰äº†ä¸€ç³»åˆ—çš„è§„åˆ™æ¥æŒ‡å®šï¼Œå“ªäº›æ–‡ä»¶éœ€è¦å…ˆç¼–è¯‘ï¼Œå“ªäº›æ–‡ä»¶éœ€è¦åç¼–è¯‘ï¼Œå“ªäº›æ–‡ä»¶éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œç”šè‡³äºè¿›è¡Œæ›´å¤æ‚çš„åŠŸèƒ½æ“ä½œï¼Œå› ä¸ºmakefileå°±åƒä¸€ä¸ªShellè„šæœ¬ä¸€æ ·ï¼Œå…¶ä¸­ä¹Ÿå¯ä»¥æ‰§è¡Œæ“ä½œç³»ç»Ÿçš„å‘½ä»¤ã€‚ä¸€æ—¦å†™å¥½ï¼Œåªéœ€è¦ä¸€ä¸ªmakeå‘½ä»¤ï¼Œæ•´ä¸ªå·¥ç¨‹å®Œå…¨è‡ªåŠ¨ç¼–è¯‘ï¼Œæå¤§çš„æé«˜äº†è½¯ä»¶å¼€å‘çš„æ•ˆç‡ã€‚</p><h3 id="0-2-ç¼–è¯‘çš„è¿‡ç¨‹"><a href="#0-2-ç¼–è¯‘çš„è¿‡ç¨‹" class="headerlink" title="0.2 ç¼–è¯‘çš„è¿‡ç¨‹"></a>0.2 ç¼–è¯‘çš„è¿‡ç¨‹</h3><ul><li><p>ç¼–è¯‘<br>é¦–å…ˆç¼–è¯‘äº§ç”Ÿç›®æ ‡æ–‡ä»¶(object file/.obj/.o)ã€‚ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨éœ€è¦çš„æ˜¯è¯­æ³•çš„æ­£ç¡®ï¼Œå‡½æ•°ä¸å˜é‡çš„å£°æ˜çš„æ­£ç¡®ã€‚åªè¦æ‰€æœ‰çš„è¯­æ³•æ­£ç¡®ï¼Œç¼–è¯‘å™¨å°±å¯ä»¥ç¼–è¯‘å‡ºä¸­é—´ç›®æ ‡æ–‡ä»¶ã€‚<br>ä¸€èˆ¬æ¥è¯´ï¼Œæ¯ä¸ªæºæ–‡ä»¶éƒ½åº”è¯¥å¯¹åº”äºä¸€ä¸ªä¸­é—´ç›®æ ‡æ–‡ä»¶ã€‚</p></li><li><p>é“¾æ¥<br>é“¾æ¥æ—¶ï¼Œä¸»è¦æ˜¯é“¾æ¥å‡½æ•°å’Œå…¨å±€å˜é‡ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›ä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆOæ–‡ä»¶æˆ–æ˜¯OBJæ–‡ä»¶ï¼‰æ¥é“¾æ¥æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚é“¾æ¥å™¨å¹¶ä¸ç®¡å‡½æ•°æ‰€åœ¨çš„æºæ–‡ä»¶ï¼Œåªç®¡å‡½æ•°çš„ä¸­é—´ç›®æ ‡æ–‡ä»¶ (Object File) ï¼Œåœ¨å¤§å¤šæ•°æ—¶å€™ï¼Œç”±äºæºæ–‡ä»¶å¤ªå¤šï¼Œç¼–è¯‘ç”Ÿæˆçš„ä¸­é—´ç›®æ ‡æ–‡ä»¶å¤ªå¤šï¼Œè€Œåœ¨é“¾æ¥æ—¶éœ€è¦æ˜æ˜¾åœ°æŒ‡å‡ºä¸­é—´ç›®æ ‡æ–‡ä»¶åï¼Œè¿™å¯¹äºç¼–è¯‘å¾ˆä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è¦ç»™ä¸­é—´ç›®æ ‡æ–‡ä»¶æ‰“ä¸ªåŒ…ï¼Œåœ¨Windowsä¸‹è¿™ç§åŒ…å«â€œåº“æ–‡ä»¶â€ï¼ˆLibrary File)ï¼Œä¹Ÿå°±æ˜¯ .lib æ–‡ä»¶ï¼Œåœ¨UNIXä¸‹ï¼Œæ˜¯Archive Fileï¼Œä¹Ÿå°±æ˜¯ .a æ–‡ä»¶ã€‚</p></li></ul><hr><h2 id="1-Makefileä»‹ç»"><a href="#1-Makefileä»‹ç»" class="headerlink" title="1 Makefileä»‹ç»"></a>1 Makefileä»‹ç»</h2><p>ç¤ºä¾‹ï¼šä¸€ä¸ªå…·æœ‰3ä¸ªå¤´æ–‡ä»¶å’Œ7ä¸ªcæ–‡ä»¶çš„å·¥ç¨‹ï¼Œä¸”makefileè¦å®Œæˆå¦‚ä¸‹åŠŸèƒ½ï¼š</p><ul><li>å¦‚æœè¿™ä¸ªå·¥ç¨‹æ²¡æœ‰ç¼–è¯‘è¿‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ‰€æœ‰Cæ–‡ä»¶éƒ½è¦ç¼–è¯‘å¹¶è¢«é“¾æ¥ã€‚</li><li>å¦‚æœè¿™ä¸ªå·¥ç¨‹çš„æŸå‡ ä¸ªCæ–‡ä»¶è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªç¼–è¯‘è¢«ä¿®æ”¹çš„Cæ–‡ä»¶ï¼Œå¹¶é“¾æ¥ç›®æ ‡ç¨‹åºã€‚</li><li>å¦‚æœè¿™ä¸ªå·¥ç¨‹çš„å¤´æ–‡ä»¶è¢«æ”¹å˜äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ç¼–è¯‘å¼•ç”¨äº†è¿™å‡ ä¸ªå¤´æ–‡ä»¶çš„Cæ–‡ä»¶ï¼Œå¹¶é“¾æ¥ç›®æ ‡ç¨‹åºã€‚</li></ul><h3 id="1-1-Makefileè§„åˆ™"><a href="#1-1-Makefileè§„åˆ™" class="headerlink" title="1.1 Makefileè§„åˆ™"></a>1.1 Makefileè§„åˆ™</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">target... : prerequisites ...</span><br><span class="line">    command</span><br></pre></td></tr></table></figure><p>targetä¹Ÿå°±æ˜¯ä¸€ä¸ªç›®æ ‡æ–‡ä»¶ï¼Œå¯ä»¥æ˜¯Object Fileï¼Œä¹Ÿå¯ä»¥æ˜¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿˜å¯ä»¥æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼ˆLabelï¼‰ï¼›</p><p>prerequisitesæ˜¯è¦ç”Ÿæˆtargetæ‰€éœ€è¦çš„æ–‡ä»¶æˆ–æ˜¯ç›®æ ‡ï¼›  </p><p>commandä¹Ÿå°±æ˜¯makeéœ€è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚ï¼ˆä»»æ„çš„Shellå‘½ä»¤ï¼‰ã€‚</p><p>ä¸‰è€…çš„å…³ç³»ä¸ºï¼štargetè¿™ä¸€ä¸ªæˆ–å¤šä¸ªçš„ç›®æ ‡æ–‡ä»¶ä¾èµ–äºprerequisitesä¸­çš„æ–‡ä»¶ï¼Œå…¶ç”Ÿæˆè§„åˆ™å®šä¹‰åœ¨commandä¸­ã€‚</p><p>è¿›ä¸€æ­¥çš„ï¼š<strong>prerequisitesä¸­å¦‚æœæœ‰ä¸€ä¸ªä»¥ä¸Šçš„æ–‡ä»¶æ¯”targetæ–‡ä»¶è¦æ–°çš„è¯ï¼Œcommandæ‰€å®šä¹‰çš„å‘½ä»¤å°±ä¼šè¢«æ‰§è¡Œã€‚</strong> è¿™å°±æ˜¯Makefileçš„è§„åˆ™ã€‚ä¹Ÿå°±æ˜¯Makefileä¸­æœ€æ ¸å¿ƒçš„å†…å®¹ã€‚</p><ul><li>å‡ ä¸ªç¬¦å·ï¼ˆè‡ªåŠ¨åŒ–å˜é‡ï¼‰<br>$@  â€“ç›®æ ‡æ–‡ä»¶<br>$^  â€“æ‰€æœ‰çš„ä¾èµ–æ–‡ä»¶<br>$&lt;  â€“ç¬¬ä¸€ä¸ªä¾èµ–æ–‡ä»¶  </li></ul><h3 id="1-2-ç¤ºä¾‹"><a href="#1-2-ç¤ºä¾‹" class="headerlink" title="1.2 ç¤ºä¾‹"></a>1.2 ç¤ºä¾‹</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¬¬ä¸€å¥æ˜¯é“¾æ¥ï¼Œåé¢æ˜¯ç¼–è¯‘</span></span><br><span class="line"></span><br><span class="line">edit : main.o kbd.o command.o display.o insert.o search.o files.o utils.o</span><br><span class="line">    cc -o edit main.o kbd.o command.o display.o insert.o search.o files.o utils.o</span><br><span class="line"></span><br><span class="line">main.o : main.c defs.h</span><br><span class="line">    cc -c main.c</span><br><span class="line"></span><br><span class="line">kbd.o : kbd.c defs.h command.h</span><br><span class="line">    cc -c kbd.c</span><br><span class="line"></span><br><span class="line">command.o : command.c defs.h command.h</span><br><span class="line">    cc -c command.c</span><br><span class="line"></span><br><span class="line">display.o : display.c defs.h buffer.h</span><br><span class="line">    cc -c display.c</span><br><span class="line"></span><br><span class="line">insert.o : insert.c defs.h buffer.h</span><br><span class="line">    cc -c insert.c</span><br><span class="line"></span><br><span class="line">search.o : search.c defs.h buffer.h</span><br><span class="line">    cc -c search.c</span><br><span class="line"></span><br><span class="line">files.o : files.c defs.h buffer.h command.h</span><br><span class="line">    cc -c files.c</span><br><span class="line"></span><br><span class="line">utils.o : utils.c defs.h</span><br><span class="line">    cc -c utils.c</span><br><span class="line"></span><br><span class="line">clean :</span><br><span class="line">rm edit main.o kbd.o command.o display.o insert.o search.o files.o utils.o</span><br></pre></td></tr></table></figure><ul><li><p>åœ¨å®šä¹‰å¥½ä¾èµ–å…³ç³»åï¼Œåç»­çš„é‚£ä¸€è¡Œå®šä¹‰äº†å¦‚ä½•ç”Ÿæˆç›®æ ‡æ–‡ä»¶çš„<strong>æ“ä½œç³»ç»Ÿå‘½ä»¤</strong>ï¼Œä¸€å®šè¦ä»¥ä¸€ä¸ª<strong>Tabé”®ä½œä¸ºå¼€å¤´</strong>ã€‚</p></li><li><p>makeå¹¶ä¸ç®¡å‘½ä»¤æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Œä»–åªç®¡æ‰§è¡Œæ‰€å®šä¹‰çš„å‘½ä»¤ã€‚</p></li><li><p>makeä¼šæ¯”è¾ƒtargetsæ–‡ä»¶å’Œprerequisitesæ–‡ä»¶çš„ä¿®æ”¹æ—¥æœŸï¼Œå¦‚æœprerequisitesæ–‡ä»¶çš„æ—¥æœŸè¦æ¯”targetsæ–‡ä»¶çš„æ—¥æœŸè¦æ–°ï¼Œæˆ–è€…targetä¸å­˜åœ¨çš„è¯ï¼Œé‚£ä¹ˆï¼Œmakeå°±ä¼šæ‰§è¡Œåç»­å®šä¹‰çš„å‘½ä»¤ã€‚</p></li><li><p><code>clean</code>æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œå¯ä»¥ç”¨ç±»ä¼¼çš„æ–¹æ³•å®šä¹‰å‘½ä»¤ã€‚ä»¥æ­¤ä¸ºä¾‹ï¼Œåªè¦è¾“å…¥<code>make clean</code>ï¼Œå°±ä¼šæ‰§è¡Œå†’å·åé¢çš„å‘½ä»¤ã€‚</p></li></ul><h3 id="1-3-makeæ˜¯å¦‚ä½•å·¥ä½œçš„"><a href="#1-3-makeæ˜¯å¦‚ä½•å·¥ä½œçš„" class="headerlink" title="1.3 makeæ˜¯å¦‚ä½•å·¥ä½œçš„"></a>1.3 makeæ˜¯å¦‚ä½•å·¥ä½œçš„</h3><p>åœ¨é»˜è®¤çš„æ–¹å¼ä¸‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åªè¾“å…¥makeå‘½ä»¤ï¼š</p><ul><li>makeä¼šåœ¨å½“å‰ç›®å½•ä¸‹æ‰¾åå­—å«<code>Makefile</code>æˆ–<code>makefile</code>çš„æ–‡ä»¶ã€‚</li><li>å¦‚æœæ‰¾åˆ°ï¼Œå®ƒä¼šæ‰¾æ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªç›®æ ‡æ–‡ä»¶ï¼ˆtargetï¼‰ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä»–ä¼šæ‰¾åˆ°<code>edit</code>è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶æŠŠè¿™ä¸ªæ–‡ä»¶ä½œä¸ºæœ€ç»ˆçš„ç›®æ ‡æ–‡ä»¶ã€‚</li><li>å¦‚æœ<code>edit</code>æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ–æ˜¯editæ‰€ä¾èµ–çš„åé¢çš„<code>.o</code>æ–‡ä»¶çš„æ–‡ä»¶ä¿®æ”¹æ—¶é—´è¦æ¯”<code>edit</code>è¿™ä¸ªæ–‡ä»¶æ–°ï¼Œé‚£ä¹ˆï¼Œä»–å°±ä¼šæ‰§è¡Œåé¢æ‰€å®šä¹‰çš„å‘½ä»¤æ¥ç”Ÿæˆ<code>edit</code>è¿™ä¸ªæ–‡ä»¶ã€‚</li><li>å¦‚æœ<code>edit</code>æ‰€ä¾èµ–çš„<code>.o</code>æ–‡ä»¶ä¹Ÿå­˜åœ¨ï¼Œé‚£ä¹ˆmakeä¼šåœ¨å½“å‰æ–‡ä»¶ä¸­æ‰¾ç›®æ ‡ä¸º<code>.o</code>æ–‡ä»¶çš„ä¾èµ–æ€§ï¼Œå¦‚æœæ‰¾åˆ°åˆ™å†æ ¹æ®é‚£ä¸€ä¸ªè§„åˆ™ç”Ÿæˆ<code>.o</code>æ–‡ä»¶ã€‚ï¼ˆè¿™æœ‰ç‚¹åƒä¸€ä¸ªå †æ ˆçš„è¿‡ç¨‹ï¼‰</li><li>å½“ç„¶ï¼Œä½ çš„Cæ–‡ä»¶å’ŒHæ–‡ä»¶æ˜¯å­˜åœ¨çš„å•¦ï¼Œäºæ˜¯makeä¼šç”Ÿæˆ<code>.o</code>æ–‡ä»¶ï¼Œç„¶åå†ç”¨<code>.o</code>æ–‡ä»¶å£°æ˜makeçš„ç»ˆæä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œæ–‡ä»¶editäº†ã€‚</li></ul><p>makeä¼šä¸€å±‚åˆä¸€å±‚åœ°å»æ‰¾æ–‡ä»¶çš„ä¾èµ–å…³ç³»ï¼Œç›´åˆ°æœ€ç»ˆç¼–è¯‘å‡ºç¬¬ä¸€ä¸ªç›®æ ‡æ–‡ä»¶ã€‚åœ¨æ‰¾å¯»çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‡ºç°é”™è¯¯ï¼Œæ¯”å¦‚æœ€åè¢«ä¾èµ–çš„æ–‡ä»¶æ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆmakeå°±ä¼šç›´æ¥é€€å‡ºï¼Œå¹¶æŠ¥é”™ï¼Œè€Œå¯¹äºæ‰€å®šä¹‰çš„å‘½ä»¤çš„é”™è¯¯ï¼Œæˆ–æ˜¯ç¼–è¯‘ä¸æˆåŠŸï¼Œmakeæ ¹æœ¬ä¸ç†ã€‚makeåªç®¡æ–‡ä»¶çš„ä¾èµ–æ€§ã€‚<em>æ¯”å¦‚ï¼Œå¦‚æœå‘½ä»¤ä¸æ˜¯ç”¨æ¥ç¼–è¯‘è¿™ä¸ªç›®æ ‡æ–‡ä»¶çš„ï¼Œmakefileæ˜¯æ£€æµ‹ä¸å‡ºæ¥çš„</em></p><p>makefileçš„ç»ˆæè¦ä¹‰æ˜¯ä¾èµ–æ€§ï¼šå°±æ˜¯çœ‹ç›®æ ‡æ–‡ä»¶çš„ä¾èµ–æ–‡ä»¶æ˜¯å¦éƒ½å­˜åœ¨ä»¥åŠç›®æ ‡æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å­˜åœ¨åˆ™æ¯”è¾ƒæ–‡ä»¶çš„ç”Ÿæˆæ—¶é—´ï¼Œå¦‚æœä¾èµ–æ–‡ä»¶ä¸å­˜åœ¨åˆ™é€’å½’è¿™ä¸ªç¼–è¯‘è¿‡ç¨‹ï¼Œå³å¯»æ‰¾ä¾èµ–æ–‡ä»¶çš„ä¾èµ–å…³ç³»ï¼Œå¹¶æ‰§è¡Œè¿™ä¸ªä¾èµ–æ–‡ä»¶ä¸‹çš„æŒ‡ä»¤ã€‚</p><p>äºæ˜¯åœ¨æˆ‘ä»¬ç¼–ç¨‹ä¸­ï¼Œå¦‚æœè¿™ä¸ªå·¥ç¨‹å·²è¢«ç¼–è¯‘è¿‡äº†ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹äº†å…¶ä¸­ä¸€ä¸ªæºæ–‡ä»¶ï¼Œæ¯”å¦‚file.cï¼Œé‚£ä¹ˆæ ¹æ®æˆ‘ä»¬çš„ä¾èµ–æ€§ï¼Œæˆ‘ä»¬çš„ç›®æ ‡file.oä¼šè¢«é‡ç¼–è¯‘ï¼ˆä¹Ÿå°±æ˜¯åœ¨è¿™ä¸ªä¾æ€§å…³ç³»åé¢æ‰€å®šä¹‰çš„å‘½ä»¤ï¼‰ï¼Œäºæ˜¯file.oçš„æ–‡ä»¶ä¹Ÿæ˜¯æœ€æ–°çš„å•¦ï¼Œäºæ˜¯file.oçš„æ–‡ä»¶ä¿®æ”¹æ—¶é—´è¦æ¯”editè¦æ–°ï¼Œæ‰€ä»¥editä¹Ÿä¼šè¢«é‡æ–°é“¾æ¥äº†ï¼ˆè¯¦è§editç›®æ ‡æ–‡ä»¶åå®šä¹‰çš„å‘½ä»¤ï¼‰ã€‚</p><h3 id="1-4-makefileä¸­ä½¿ç”¨å˜é‡"><a href="#1-4-makefileä¸­ä½¿ç”¨å˜é‡" class="headerlink" title="1.4 makefileä¸­ä½¿ç”¨å˜é‡"></a>1.4 makefileä¸­ä½¿ç”¨å˜é‡</h3><p>å¯¹äºmakefileä¸­é‡å¤å‡ºç°çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥åƒCè¯­è¨€çš„å®ä¸€æ ·å°†å…¶å®šä¹‰ä¸ºå˜é‡ã€‚</p><p>ä¾‹å¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">objects = main.o kbd.o command.o display.o insert.o search.o files.o utils.o</span><br><span class="line"></span><br><span class="line">edit : <span class="variable">$(objects)</span></span><br><span class="line">cc -o edit <span class="variable">$(objects)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¾èµ–å…³ç³»...</span></span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">rm edit <span class="variable">$(objects)</span></span><br></pre></td></tr></table></figure></p><p>åœ¨æŒ‡ä»¤ä¸­ä½¿ç”¨<code>$(Variable_name)</code>ï¼Œå³å¯ä»£è¡¨ä¸€ä¸²æ–‡ä»¶çš„åå­—ã€‚</p><h3 id="1-5-è®©makefileè‡ªåŠ¨æ¨å¯¼"><a href="#1-5-è®©makefileè‡ªåŠ¨æ¨å¯¼" class="headerlink" title="1.5 è®©makefileè‡ªåŠ¨æ¨å¯¼"></a>1.5 è®©makefileè‡ªåŠ¨æ¨å¯¼</h3><p>åªè¦makeçœ‹åˆ°ä¸€ä¸ª[.o]æ–‡ä»¶ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨çš„æŠŠ[.c]æ–‡ä»¶åŠ åœ¨ä¾èµ–å…³ç³»ä¸­,å¹¶ä¸” cc -c [.c] ä¹Ÿä¼šè¢«æ¨å¯¼å‡ºæ¥ã€‚<br>æ‰€ä»¥ä¸Šè¿°makefileè¯­å¥å¯ä»¥ç®€åŒ–ä¸ºï¼š  </p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">objects = main.o kbd.o command.o display.o insert.o search.o files.o utils.o</span><br><span class="line"></span><br><span class="line">edit : <span class="variable">$(objects)</span></span><br><span class="line">    cc -o edit <span class="variable">$(objects)</span></span><br><span class="line"></span><br><span class="line">main.o : defs.h</span><br><span class="line">kbd.o : defs.h command.h</span><br><span class="line">command.o : defs.h command.h</span><br><span class="line">display.o : defs.h buffer.h</span><br><span class="line">insert.o : defs.h buffer.h</span><br><span class="line">search.o : defs.h buffer.h</span><br><span class="line">files.o : defs.h buffer.h command.h</span><br><span class="line">utils.o : defs.h</span><br><span class="line"></span><br><span class="line">.PHONY : clean</span><br><span class="line">clean :</span><br><span class="line">    -rm edit <span class="variable">$(objects)</span></span><br></pre></td></tr></table></figure><ul><li>å…¶ä¸­<code>.PHONY</code>è¡¨ç¤ºï¼Œ<code>clean</code>æ˜¯ä¸ªä¼ªç›®æ ‡æ–‡ä»¶ã€‚</li><li>æ¯ä¸ªMakefileä¸­éƒ½åº”è¯¥å†™ä¸€ä¸ªæ¸…ç©ºç›®æ ‡æ–‡ä»¶ï¼ˆ.oå’Œæ‰§è¡Œæ–‡ä»¶ï¼‰çš„è§„åˆ™ï¼Œè¿™ä¸ä»…ä¾¿äºé‡ç¼–è¯‘ï¼Œä¹Ÿå¾ˆåˆ©äºä¿æŒæ–‡ä»¶çš„æ¸…æ´ã€‚</li><li>åœ¨rmå‘½ä»¤å‰é¢åŠ äº†ä¸€ä¸ªå°å‡å·çš„æ„æ€å°±æ˜¯ï¼Œä¹Ÿè®¸æŸäº›æ–‡ä»¶å‡ºç°é—®é¢˜ï¼Œä½†ä¸è¦ç®¡ï¼Œç»§ç»­åšåé¢çš„äº‹ã€‚</li></ul><h3 id="1-6-ä¾èµ–å…³ç³»çš„å¦ä¸€ç§å†™æ³•"><a href="#1-6-ä¾èµ–å…³ç³»çš„å¦ä¸€ç§å†™æ³•" class="headerlink" title="1.6 ä¾èµ–å…³ç³»çš„å¦ä¸€ç§å†™æ³•"></a>1.6 ä¾èµ–å…³ç³»çš„å¦ä¸€ç§å†™æ³•</h3><p>ä¾èµ–å…³ç³»å¯ä»¥ç”¨ä¸‹åˆ—æ–¹å¼æ¥å†™ï¼Œå³ä»¥è¢«ä¾èµ–çš„æ–‡ä»¶ä¸ºä¸»ä½“çš„è¡¨è¾¾ï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(objects)</span> : defs.h</span><br><span class="line">kbd.o command.o files.o : command.h</span><br><span class="line">display.o insert.o search.o files.o : buffer.h</span><br></pre></td></tr></table></figure><hr><h2 id="2-Makefileæ€»è¿°"><a href="#2-Makefileæ€»è¿°" class="headerlink" title="2 Makefileæ€»è¿°"></a>2 Makefileæ€»è¿°</h2><h3 id="2-1-Makefileé‡Œæœ‰ä»€ä¹ˆ"><a href="#2-1-Makefileé‡Œæœ‰ä»€ä¹ˆ" class="headerlink" title="2.1 Makefileé‡Œæœ‰ä»€ä¹ˆ"></a>2.1 Makefileé‡Œæœ‰ä»€ä¹ˆ</h3><p>äº”ä¸ªéƒ¨åˆ†ï¼šæ˜¾å¼è§„åˆ™ã€éšæ™¦è§„åˆ™ã€å˜é‡å®šä¹‰ã€æ–‡ä»¶æŒ‡ç¤ºå’Œæ³¨é‡Šã€‚</p><ul><li>æ˜¾å¼è§„åˆ™<br>æ˜¾å¼è§„åˆ™è¯´æ˜äº†ï¼Œå¦‚ä½•ç”Ÿæˆä¸€ä¸ªæˆ–å¤šçš„çš„ç›®æ ‡æ–‡ä»¶ã€‚è¿™æ˜¯ç”±Makefileçš„ä¹¦å†™è€…æ˜æ˜¾æŒ‡å‡ºï¼Œè¦ç”Ÿæˆçš„æ–‡ä»¶ï¼Œæ–‡ä»¶çš„ä¾èµ–æ–‡ä»¶ï¼Œç”Ÿæˆçš„å‘½ä»¤ã€‚</li></ul><ul><li><p>éšæ™¦è§„åˆ™<br>ç”±äºmakeæœ‰è‡ªåŠ¨æ¨å¯¼çš„åŠŸèƒ½ï¼Œæ‰€ä»¥éšæ™¦çš„è§„åˆ™å¯ä»¥è®©æˆ‘ä»¬æ¯”è¾ƒç²—ç³™åœ°ç®€ç•¥åœ°ä¹¦å†™Makefileï¼Œè¿™æ˜¯ç”±makeæ‰€æ”¯æŒçš„ã€‚</p></li><li><p>å˜é‡å®šä¹‰<br>å˜é‡ä¸€èˆ¬éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå½“Makefileè¢«æ‰§è¡Œæ—¶ï¼Œå…¶ä¸­çš„å˜é‡éƒ½ä¼šè¢«æ‰©å±•åˆ°ç›¸åº”çš„å¼•ç”¨ä½ç½®ä¸Šã€‚</p></li><li><p>æ–‡ä»¶æŒ‡ç¤º<br>å…¶åŒ…æ‹¬äº†ä¸‰ä¸ªéƒ¨åˆ†ï¼š<br>åœ¨ä¸€ä¸ªMakefileä¸­å¼•ç”¨å¦ä¸€ä¸ªMakefileï¼Œå°±åƒCè¯­è¨€ä¸­çš„includeä¸€æ ·ï¼›<br>æŒ‡æ ¹æ®æŸäº›æƒ…å†µæŒ‡å®šMakefileä¸­çš„æœ‰æ•ˆéƒ¨åˆ†ï¼Œå°±åƒCè¯­è¨€ä¸­çš„é¢„ç¼–è¯‘#ifä¸€æ ·ï¼›<br>å®šä¹‰ä¸€ä¸ªå¤šè¡Œçš„å‘½ä»¤ã€‚</p></li><li><p>æ³¨é‡Š<br>ä½¿ç”¨#æ¥æ³¨é‡Šã€‚</p></li></ul><p><strong>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨Makefileä¸­çš„å‘½ä»¤ï¼Œå¿…é¡»è¦ä»¥[Tab]é”®å¼€å§‹ã€‚</strong></p><h3 id="2-2-Makefileçš„æ–‡ä»¶å"><a href="#2-2-Makefileçš„æ–‡ä»¶å" class="headerlink" title="2.2 Makefileçš„æ–‡ä»¶å"></a>2.2 Makefileçš„æ–‡ä»¶å</h3><p>é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œmakeå‘½ä»¤ä¼šåœ¨å½“å‰ç›®å½•ä¸‹æŒ‰é¡ºåºæ‰¾å¯»æ–‡ä»¶åä¸º<code>GNUmakefile</code>ã€<code>makefile</code>ã€<code>Makefile</code>çš„æ–‡ä»¶ã€‚æœ€å¥½ä½¿ç”¨<code>Makefile</code>ï¼Œè€Œä¸è¦ä½¿ç”¨<code>GNUmakefile</code>ï¼ˆä»…é€‚ç”¨äºGNU makeï¼‰ã€‚<br>ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ä»»æ„æ–‡ä»¶åï¼Œä½¿ç”¨<code>make -f filename</code>æˆ–<code>make --file filename</code>å³å¯è°ƒç”¨è¯¥æ–‡ä»¶ã€‚</p><h3 id="2-3-å¼•ç”¨å…¶å®ƒçš„Makefile"><a href="#2-3-å¼•ç”¨å…¶å®ƒçš„Makefile" class="headerlink" title="2.3 å¼•ç”¨å…¶å®ƒçš„Makefile"></a>2.3 å¼•ç”¨å…¶å®ƒçš„Makefile</h3><p>ä½¿ç”¨includeå…³é”®å­—å¯ä»¥æŠŠåˆ«çš„MakefileåŒ…å«è¿›æ¥ï¼Œè¿™å¾ˆåƒCè¯­è¨€çš„<code>#include</code>ï¼Œè¢«åŒ…å«çš„æ–‡ä»¶ä¼šåŸæ¨¡åŸæ ·çš„æ”¾åœ¨å½“å‰æ–‡ä»¶çš„åŒ…å«ä½ç½®ã€‚</p><p>è¯­æ³•ä¸ºï¼š<code>include&lt;filename&gt;</code>ï¼Œä¾‹å¦‚<code>include ../GNUMakeConfig/defines.qnx.mk</code>ã€‚æ–‡ä»¶è·¯å¾„ç¬¦åˆå½“å‰ç³»ç»Ÿshellè¯­æ³•å³å¯ã€‚</p><p>åœ¨includeå‰é¢å¯ä»¥æœ‰ä¸€äº›ç©ºå­—ç¬¦ï¼Œä½†æ˜¯ç»ä¸èƒ½æ˜¯[Tab]é”®å¼€å§‹ã€‚å¤šä¸ªæ–‡ä»¶ä¹‹é—´å¯ä»¥ç”¨ç©ºæ ¼éš”å¼€ã€‚<br>ä¸¾ä¸ªä¾‹å­ï¼Œä½ æœ‰è¿™æ ·å‡ ä¸ªMakefileï¼ša.mkã€b.mkã€c.mkï¼Œè¿˜æœ‰ä¸€ä¸ªæ–‡ä»¶å«foo.makeï¼Œä»¥åŠä¸€ä¸ªå˜é‡<code>$(bar)</code>ï¼Œå…¶åŒ…å«äº†e.mkå’Œf.mkï¼Œé‚£ä¹ˆï¼Œä¸‹é¢çš„è¯­å¥ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> foo.make *.mk <span class="variable">$(bar)</span></span><br></pre></td></tr></table></figure></p><p>ç­‰ä»·äº<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> foo.make a.mk b.mk c.mk e.mk f.mk</span><br></pre></td></tr></table></figure></p><p>makeå‘½ä»¤å¼€å§‹æ—¶ï¼Œä¼šæŠŠæ‰¾å¯»<code>include</code>æ‰€æŒ‡å‡ºçš„å…¶å®ƒMakefileï¼Œå¹¶æŠŠå…¶å†…å®¹å®‰ç½®åœ¨å½“å‰çš„ä½ç½®ã€‚å°±å¥½åƒC++çš„<code>#include</code>æŒ‡ä»¤ä¸€æ ·ã€‚å¦‚æœæ–‡ä»¶éƒ½æ²¡æœ‰æŒ‡å®šç»å¯¹è·¯å¾„æˆ–æ˜¯ç›¸å¯¹è·¯å¾„çš„è¯ï¼Œmakeä¼šåœ¨å½“å‰ç›®å½•ä¸‹é¦–å…ˆå¯»æ‰¾ï¼Œå¦‚æœå½“å‰ç›®å½•ä¸‹æ²¡æœ‰æ‰¾åˆ°ï¼Œé‚£ä¹ˆï¼Œmakeè¿˜ä¼šåœ¨ä¸‹é¢çš„å‡ ä¸ªç›®å½•ä¸‹æ‰¾ï¼š</p><ul><li>å¦‚æœmakeæ‰§è¡Œæ—¶ï¼Œæœ‰<code>-I</code>æˆ–<code>--include-dir</code>å‚æ•°ï¼Œé‚£ä¹ˆmakeå°±ä¼šåœ¨è¿™ä¸ªå‚æ•°æ‰€æŒ‡å®šçš„ç›®å½•ä¸‹å»å¯»æ‰¾ã€‚</li><li>å¦‚æœç›®å½•<code>/include</code>ï¼ˆä¸€èˆ¬æ˜¯ï¼š<code>/usr/local/binæˆ–/usr/include</code>ï¼‰å­˜åœ¨çš„è¯ï¼Œmakeä¹Ÿä¼šå»æ‰¾ã€‚</li></ul><p>å¦‚æœæœ‰æ–‡ä»¶æ²¡æœ‰æ‰¾åˆ°çš„è¯ï¼Œmakeä¼šç”Ÿæˆä¸€æ¡è­¦å‘Šä¿¡æ¯ï¼Œä½†ä¸ä¼šé©¬ä¸Šå‡ºç°è‡´å‘½é”™è¯¯ã€‚å®ƒä¼šç»§ç»­è½½å…¥å…¶å®ƒçš„æ–‡ä»¶ï¼Œä¸€æ—¦å®Œæˆmakefileçš„è¯»å–ï¼Œmakeä¼šå†é‡è¯•è¿™äº›æ²¡æœ‰æ‰¾åˆ°ï¼Œæˆ–æ˜¯ä¸èƒ½è¯»å–çš„æ–‡ä»¶ï¼Œå¦‚æœè¿˜æ˜¯ä¸è¡Œï¼Œmakeæ‰ä¼šå‡ºç°ä¸€æ¡è‡´å‘½ä¿¡æ¯ã€‚å¦‚æœä½ æƒ³è®©makeä¸ç†é‚£äº›æ— æ³•è¯»å–çš„æ–‡ä»¶ï¼Œè€Œç»§ç»­æ‰§è¡Œï¼Œä½ å¯ä»¥åœ¨includeå‰åŠ ä¸€ä¸ªå‡å·â€œ-â€ã€‚</p><h3 id="2-4-ç¯å¢ƒå˜é‡MAKEFILES"><a href="#2-4-ç¯å¢ƒå˜é‡MAKEFILES" class="headerlink" title="2.4 ç¯å¢ƒå˜é‡MAKEFILES"></a>2.4 ç¯å¢ƒå˜é‡<code>MAKEFILES</code></h3><p>å¦‚æœä½ çš„å½“å‰ç¯å¢ƒä¸­å®šä¹‰äº†ç¯å¢ƒå˜é‡<code>MAKEFILES</code>ï¼Œé‚£ä¹ˆï¼Œmakeä¼šæŠŠè¿™ä¸ªå˜é‡ä¸­çš„å€¼åšä¸€ä¸ªç±»ä¼¼äº<code>include</code>çš„åŠ¨ä½œã€‚è¿™ä¸ªå˜é‡ä¸­çš„å€¼æ˜¯å…¶å®ƒçš„Makefileï¼Œç”¨ç©ºæ ¼åˆ†éš”ã€‚åªæ˜¯ï¼Œå®ƒå’Œ<code>include</code>ä¸åŒçš„æ˜¯ï¼Œä»è¿™ä¸ªç¯å¢ƒå˜ä¸­å¼•å…¥çš„Makefileçš„â€œç›®æ ‡â€ä¸ä¼šèµ·ä½œç”¨ï¼Œå¦‚æœç¯å¢ƒå˜é‡ä¸­å®šä¹‰çš„æ–‡ä»¶å‘ç°é”™è¯¯ï¼Œmakeä¹Ÿä¼šä¸ç†ã€‚</p><h3 id="2-5-makeçš„å·¥ä½œæ–¹å¼"><a href="#2-5-makeçš„å·¥ä½œæ–¹å¼" class="headerlink" title="2.5 makeçš„å·¥ä½œæ–¹å¼"></a>2.5 makeçš„å·¥ä½œæ–¹å¼</h3><p>GNUçš„makeå·¥ä½œæ—¶çš„æ‰§è¡Œæ­¥éª¤å…¥ä¸‹ï¼š</p><ol><li>è¯»å…¥æ‰€æœ‰çš„Makefileã€‚</li><li>è¯»å…¥è¢«includeçš„å…¶å®ƒMakefileã€‚</li><li>åˆå§‹åŒ–æ–‡ä»¶ä¸­çš„å˜é‡ã€‚</li><li>æ¨å¯¼éšæ™¦è§„åˆ™ï¼Œå¹¶åˆ†ææ‰€æœ‰è§„åˆ™ã€‚</li><li>ä¸ºæ‰€æœ‰çš„ç›®æ ‡æ–‡ä»¶åˆ›å»ºä¾èµ–å…³ç³»é“¾ã€‚</li><li>æ ¹æ®ä¾èµ–å…³ç³»ï¼Œå†³å®šå“ªäº›ç›®æ ‡è¦é‡æ–°ç”Ÿæˆã€‚</li><li>æ‰§è¡Œç”Ÿæˆå‘½ä»¤ã€‚</li></ol><hr><h2 id="3-Makefileä¹¦å†™è§„åˆ™"><a href="#3-Makefileä¹¦å†™è§„åˆ™" class="headerlink" title="3 Makefileä¹¦å†™è§„åˆ™"></a>3 Makefileä¹¦å†™è§„åˆ™</h2><p>è§„åˆ™åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯ä¾èµ–å…³ç³»ï¼Œä¸€ä¸ªæ˜¯ç”Ÿæˆç›®æ ‡çš„æ–¹æ³•ã€‚<br>ä¸€èˆ¬æ¥è¯´ï¼Œå®šä¹‰åœ¨Makefileä¸­çš„ç›®æ ‡å¯èƒ½ä¼šæœ‰å¾ˆå¤šï¼Œä½†æ˜¯<strong>ç¬¬ä¸€æ¡è§„åˆ™ä¸­çš„ç›®æ ‡</strong>å°†è¢«ç¡®ç«‹ä¸º<strong>æœ€ç»ˆçš„ç›®æ ‡</strong>ã€‚å¦‚æœç¬¬ä¸€æ¡è§„åˆ™ä¸­çš„ç›®æ ‡æœ‰å¾ˆå¤šä¸ªï¼Œé‚£ä¹ˆï¼Œç¬¬ä¸€ä¸ªç›®æ ‡ä¼šæˆä¸ºæœ€ç»ˆçš„ç›®æ ‡ã€‚makeæ‰€å®Œæˆçš„ä¹Ÿå°±æ˜¯è¿™ä¸ªç›®æ ‡ã€‚</p><h3 id="3-1-è§„åˆ™çš„è¯­æ³•"><a href="#3-1-è§„åˆ™çš„è¯­æ³•" class="headerlink" title="3.1 è§„åˆ™çš„è¯­æ³•"></a>3.1 è§„åˆ™çš„è¯­æ³•</h3><p>å¦‚1.1å’Œ1.2èŠ‚æ‰€è¿°ï¼Œè§„åˆ™å¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">main.o : main.c defs.h</span><br><span class="line">    cc -c main.c</span><br></pre></td></tr></table></figure></p><p>è§„åˆ™å‘Šè¯‰æˆ‘ä»¬ä¸¤ä»¶äº‹ï¼š</p><ul><li>æ–‡ä»¶çš„ä¾èµ–å…³ç³»ï¼Œmain.oä¾èµ–äºmain.cå’Œdefs.hçš„æ–‡ä»¶ï¼Œå¦‚æœmain.cå’Œdefs.hçš„æ–‡ä»¶æ—¥æœŸè¦æ¯”main.oæ–‡ä»¶æ—¥æœŸè¦æ–°ï¼Œæˆ–æ˜¯main.oä¸å­˜åœ¨ï¼Œé‚£ä¹ˆä¾èµ–å…³ç³»å‘ç”Ÿï¼Œæ‰§è¡Œä¸‹é¢çš„æŒ‡ä»¤ã€‚</li><li>å¦‚æœç”Ÿæˆï¼ˆæˆ–æ›´æ–°ï¼‰main.oæ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯é‚£ä¸ªccå‘½ä»¤ï¼Œå…¶è¯´æ˜äº†ï¼Œå¦‚ä½•ç”Ÿæˆmain.oè¿™ä¸ªæ–‡ä»¶ã€‚</li></ul><p>è§„åˆ™ä¹Ÿå¯ä»¥å†™æˆï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">main.o : main.c defs.h; cc -c main.c</span><br></pre></td></tr></table></figure></p><p>å‘½ä»¤è¡Œå¦‚æœä¸ä¸<code>target:prerequisites</code>åœ¨ä¸€è¡Œï¼Œé‚£ä¹ˆï¼Œå¿…é¡»ä»¥[Tabé”®]å¼€å¤´ï¼Œå¦‚æœå’Œ<code>prerequisites</code>åœ¨ä¸€è¡Œï¼Œé‚£ä¹ˆå¯ä»¥ç”¨åˆ†å·åšä¸ºåˆ†éš”ã€‚</p><h3 id="3-2-æ–‡ä»¶æœå¯»"><a href="#3-2-æ–‡ä»¶æœå¯»" class="headerlink" title="3.2 æ–‡ä»¶æœå¯»"></a>3.2 æ–‡ä»¶æœå¯»</h3><p>åœ¨ä¸€äº›å¤§çš„å·¥ç¨‹ä¸­ï¼Œæœ‰å¤§é‡çš„æºæ–‡ä»¶ï¼Œæˆ‘ä»¬é€šå¸¸çš„åšæ³•æ˜¯æŠŠè¿™è®¸å¤šçš„æºæ–‡ä»¶åˆ†ç±»ï¼Œå¹¶å­˜æ”¾åœ¨ä¸åŒçš„ç›®å½•ä¸­ã€‚æ‰€ä»¥ï¼Œå½“makeéœ€è¦å»æ‰¾å¯»æ–‡ä»¶çš„ä¾èµ–å…³ç³»æ—¶ï¼Œå¯ä»¥åœ¨æ–‡ä»¶å‰åŠ ä¸Šè·¯å¾„ï¼Œä½†æœ€å¥½çš„æ–¹æ³•æ˜¯æŠŠä¸€ä¸ªè·¯å¾„å‘Šè¯‰makeï¼Œè®©makeåœ¨è‡ªåŠ¨å»æ‰¾ã€‚</p><ul><li>ç‰¹æ®Šå˜é‡<code>VPATH</code>å¯ä»¥å®Œæˆè¿™ä¸ªåŠŸèƒ½<br>å¦‚æœæ²¡æœ‰æŒ‡æ˜<code>VPATH</code>ï¼Œmakeåªä¼šåœ¨å½“å‰çš„ç›®å½•ä¸­å»æ‰¾å¯»ä¾èµ–æ–‡ä»¶å’Œç›®æ ‡æ–‡ä»¶ã€‚å¦‚æœå®šä¹‰äº†è¿™ä¸ªå˜é‡ï¼Œé‚£ä¹ˆï¼Œmakeå°±ä¼šåœ¨å½“å½“å‰ç›®å½•æ‰¾ä¸åˆ°çš„æƒ…å†µä¸‹ï¼Œåˆ°æ‰€æŒ‡å®šçš„ç›®å½•ä¸­å»æ‰¾å¯»æ–‡ä»¶äº†ã€‚  <figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">VPATH = src:../headers</span><br><span class="line">```  </span><br><span class="line">ä¸Šé¢çš„çš„å®šä¹‰æŒ‡å®šä¸¤ä¸ªç›®å½•ï¼Œâ€œsrcâ€å’Œâ€œ../headersâ€ï¼Œmakeä¼šæŒ‰ç…§è¿™ä¸ªé¡ºåºè¿›è¡Œæœç´¢ã€‚ç›®å½•ç”±â€œå†’å·â€åˆ†éš”ã€‚  </span><br><span class="line"></span><br><span class="line">* å…³é”®å­—`<span class="keyword">vpath</span>`ä¹Ÿå¯ä»¥è®¾ç½®æœç´¢æ–‡ä»¶è·¯å¾„</span><br><span class="line">å®ƒå¯ä»¥æŒ‡å®šä¸åŒçš„æ–‡ä»¶åœ¨ä¸åŒçš„æœç´¢ç›®å½•ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆçµæ´»çš„åŠŸèƒ½ã€‚å®ƒçš„ä½¿ç”¨æ–¹æ³•æœ‰ä¸‰ç§ï¼š</span><br><span class="line">```makefile</span><br><span class="line"><span class="keyword">vpath</span> &lt; pattern&gt; &lt; directories&gt;    <span class="comment">#ä¸ºç¬¦åˆæ¨¡å¼&lt; pattern&gt;çš„æ–‡ä»¶æŒ‡å®šæœç´¢ç›®å½•&lt;directories&gt;ã€‚</span></span><br><span class="line"><span class="keyword">vpath</span> &lt; pattern&gt;                   <span class="comment">#æ¸…é™¤ç¬¦åˆæ¨¡å¼&lt; pattern&gt;çš„æ–‡ä»¶çš„æœç´¢ç›®å½•ã€‚</span></span><br><span class="line"><span class="keyword">vpath</span>                              <span class="comment">#æ¸…é™¤æ‰€æœ‰å·²è¢«è®¾ç½®å¥½äº†çš„æ–‡ä»¶æœç´¢ç›®å½•ã€‚</span></span><br><span class="line">```  </span><br><span class="line">`vapth`ä½¿ç”¨æ–¹æ³•ä¸­çš„`&lt;pattern&gt;`éœ€è¦åŒ…å«`%`å­—ç¬¦ã€‚`%`çš„æ„æ€æ˜¯åŒ¹é…é›¶æˆ–è‹¥å¹²å­—ç¬¦ï¼Œä¾‹å¦‚ï¼Œ`%.h`è¡¨ç¤ºæ‰€æœ‰ä»¥`.h`ç»“å°¾çš„æ–‡ä»¶ã€‚`&lt;pattern&gt;`æŒ‡å®šäº†è¦æœç´¢çš„æ–‡ä»¶é›†ï¼Œè€Œ`&lt;directories&gt;`åˆ™æŒ‡å®šäº†çš„æ–‡ä»¶é›†çš„æœç´¢çš„ç›®å½•ã€‚ä¾‹å¦‚ï¼š</span><br><span class="line">```makefile</span><br><span class="line"><span class="keyword">vpath</span> %.h ../headers</span><br></pre></td></tr></table></figure></li></ul><p>è¯¥è¯­å¥è¡¨ç¤ºï¼Œè¦æ±‚makeåœ¨<code>../headers</code>ç›®å½•ä¸‹æœç´¢æ‰€æœ‰ä»¥<code>.h</code>ç»“å°¾çš„æ–‡ä»¶ï¼ˆå¦‚æœæŸæ–‡ä»¶åœ¨å½“å‰ç›®å½•æ²¡æœ‰æ‰¾åˆ°çš„è¯ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥è¿ç»­åœ°ä½¿ç”¨<code>vpath</code>è¯­å¥ï¼Œä»¥æŒ‡å®šä¸åŒæœç´¢ç­–ç•¥ã€‚å¦‚æœè¿ç»­çš„<code>vpath</code>è¯­å¥ä¸­å‡ºç°äº†ç›¸åŒçš„<code>&lt;pattern&gt;</code>ï¼Œæˆ–æ˜¯è¢«é‡å¤äº†çš„<code>&lt;pattern&gt;</code>ï¼Œé‚£ä¹ˆï¼Œmakeä¼šæŒ‰ç…§<code>vpath</code>è¯­å¥çš„å…ˆåé¡ºåºæ¥æ‰§è¡Œæœç´¢ã€‚</p><h3 id="3-3-ä¼ªç›®æ ‡"><a href="#3-3-ä¼ªç›®æ ‡" class="headerlink" title="3.3 ä¼ªç›®æ ‡"></a>3.3 ä¼ªç›®æ ‡</h3><p>ä¼ªç›®æ ‡ä¸è¢«æœ€ç»ˆç›®æ ‡æ‰€ä¾èµ–ã€‚æ¯”å¦‚ä¸Šè¿°çš„cleanã€‚æˆ‘ä»¬å¹¶ä¸ç”Ÿæˆâ€œcleanâ€è¿™ä¸ªæ–‡ä»¶ã€‚â€œä¼ªç›®æ ‡â€å¹¶ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œåªæ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œç”±äºâ€œä¼ªç›®æ ‡â€ä¸æ˜¯æ–‡ä»¶ï¼Œæ‰€ä»¥makeæ— æ³•ç”Ÿæˆå®ƒçš„ä¾èµ–å…³ç³»å’Œå†³å®šå®ƒæ˜¯å¦è¦æ‰§è¡Œã€‚æˆ‘ä»¬åªæœ‰é€šè¿‡æ˜¾ç¤ºåœ°æŒ‡æ˜è¿™ä¸ªâ€œç›®æ ‡â€æ‰èƒ½è®©å…¶ç”Ÿæ•ˆã€‚</p><p><code>.PHONY : clean</code>å¯ä»¥æ˜¾å¼åœ°å£°æ˜è¿™æ˜¯ä¸€ä¸ªä¼ªç›®æ ‡ï¼Œå³ä½¿åé¢çš„åç§°ä¸è¦ç¼–è¯‘çš„æ–‡ä»¶é‡åä¹Ÿæ²¡å…³ç³»ï¼Œ<code>make clean</code>ä¸€æ ·èƒ½å¤Ÿæ‰§è¡Œ<code>clean</code>åçš„å‘½ä»¤ï¼Œè¿™å°±æ˜¯ä¼ªç›®æ ‡çš„ç‰¹æ€§ï¼šåªè¦è°ƒç”¨ï¼Œæ— è®ºæœ‰æ²¡æœ‰ä¾èµ–å…³ç³»éƒ½æ€»æ˜¯è¢«æ‰§è¡Œã€‚</p><p>ä¼ªç›®æ ‡ä¹Ÿå¯ä»¥ä½œä¸ºæœ€ç»ˆç›®æ ‡ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºä¾èµ–ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">.PHONY : all</span><br><span class="line">all : prog1 prog2 prog3</span><br><span class="line"></span><br><span class="line">prog1 : prog1.o utils.o</span><br><span class="line">    cc -o prog1 prog1.o utils.o</span><br><span class="line"></span><br><span class="line">prog2 : prog2.o</span><br><span class="line">    cc -o prog2 prog2.o</span><br><span class="line"></span><br><span class="line">prog3 : prog3.o sort.o utils.o</span><br><span class="line">    cc -o prog3 prog3.o sort.o utils.o</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta"><span class="meta-keyword">.PHONY</span>: cleanall cleanobj cleandiff</span></span><br><span class="line"></span><br><span class="line">cleanall : cleanobj cleandiff</span><br><span class="line">    rm program</span><br><span class="line"></span><br><span class="line">cleanobj :</span><br><span class="line">    rm *.o</span><br><span class="line"></span><br><span class="line">cleandiff :</span><br><span class="line">    rm *.diff</span><br></pre></td></tr></table></figure></p><p>å¯¹äºè¿™ä¸ªmakefileæ–‡ä»¶ï¼Œåªéœ€è¦ä¸€ä¸ªmakeå‘½ä»¤å°±å¯ä»¥ç”Ÿæˆ<code>prog1</code>ã€<code>prog2</code>ã€<code>prog3</code>ä¸‰ä¸ªç›®æ ‡ï¼Œè€Œ<code>cleanall</code>ä¾èµ–<code>cleanobj</code>ä¸<code>cleandiff</code>å› æ­¤ä½¿ç”¨<code>make cleanall</code>ä¼šæ‰§è¡Œæ‰€æœ‰æŒ‡ä»¤ã€‚</p><h3 id="3-4-å¤šç›®æ ‡"><a href="#3-4-å¤šç›®æ ‡" class="headerlink" title="3.4 å¤šç›®æ ‡"></a>3.4 å¤šç›®æ ‡</h3><p>å¦‚1.6èŠ‚æ‰€è¿°ï¼Œå¯ä»¥å¤šä¸ªç›®æ ‡ä¾èµ–ä¸€ä¸ªæ–‡ä»¶ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bigoutput littleoutput : text.g</span><br><span class="line">    generate text.g -<span class="variable">$(<span class="built_in">subst</span> output,,<span class="variable">$@</span>)</span> &gt; <span class="variable">$@</span></span><br></pre></td></tr></table></figure></p><p>ä¸Šè¿°è§„åˆ™ç­‰ä»·äºï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bigoutput : text.g</span><br><span class="line">    generate text.g -big &gt; bigoutput</span><br><span class="line"></span><br><span class="line">littleoutput : text.g</span><br><span class="line">    generate text.g -little &gt; littleoutput</span><br></pre></td></tr></table></figure></p><h3 id="3-5-é™æ€æ¨¡å¼"><a href="#3-5-é™æ€æ¨¡å¼" class="headerlink" title="3.5 é™æ€æ¨¡å¼"></a>3.5 é™æ€æ¨¡å¼</h3><p>é™æ€æ¨¡å¼å¯ä»¥æ›´åŠ å®¹æ˜“åœ°å®šä¹‰å¤šç›®æ ‡çš„è§„åˆ™ï¼Œå¯ä»¥è®©æˆ‘ä»¬çš„è§„åˆ™å˜å¾—æ›´åŠ çš„æœ‰å¼¹æ€§å’Œçµæ´»ã€‚<br>å…¶è¯­æ³•ä¸ºï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;targets...&gt;: &lt;target-pattern&gt;: &lt;prereq-patterns ...&gt;</span></span><br><span class="line">    &lt;commands&gt;</span><br></pre></td></tr></table></figure></p><p><code>&lt;targets&gt;</code>å®šä¹‰äº†ä¸€ç³»åˆ—çš„ç›®æ ‡æ–‡ä»¶ï¼Œå¯ä»¥æœ‰é€šé…ç¬¦ã€‚æ˜¯ç›®æ ‡çš„ä¸€ä¸ªé›†åˆã€‚<br><code>&lt;target-parrtern&gt;</code>æ˜¯æŒ‡æ˜äº†<code>&lt;targets&gt;</code>çš„æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯çš„ç›®æ ‡é›†æ¨¡å¼ã€‚<br><code>&lt;prereq-parrterns&gt;</code>æ˜¯ç›®æ ‡çš„ä¾èµ–æ¨¡å¼ï¼Œå®ƒå¯¹<code>&lt;target-parrtern&gt;</code>å½¢æˆçš„æ¨¡å¼å†è¿›è¡Œä¸€æ¬¡ä¾èµ–ç›®æ ‡çš„å®šä¹‰ã€‚</p><p>å¦‚æœæˆ‘ä»¬çš„<code>&lt;target-parrtern&gt;</code>å®šä¹‰æˆ<code>%.o</code>ï¼Œæ„æ€æ˜¯æˆ‘ä»¬çš„é›†åˆä¸­éƒ½æ˜¯ä»¥<code>.o</code>ç»“å°¾çš„ï¼Œè€Œå¦‚æœæˆ‘ä»¬çš„<code>&lt;prereq-parrterns&gt;</code>å®šä¹‰æˆ<code>%.c</code>ï¼Œæ„æ€æ˜¯å¯¹<code>&lt;target-parrtern&gt;</code>æ‰€å½¢æˆçš„ç›®æ ‡é›†è¿›è¡ŒäºŒæ¬¡å®šä¹‰ï¼Œå…¶è®¡ç®—æ–¹æ³•æ˜¯ï¼Œå–<code>&lt;target-parrtern&gt;</code>æ¨¡å¼ä¸­çš„<code>%</code>ï¼ˆä¹Ÿå°±æ˜¯å»æ‰äº†<code>.o</code>è¿™ä¸ªç»“å°¾ï¼‰ï¼Œå¹¶ä¸ºå…¶åŠ ä¸Š<code>.c</code>è¿™ä¸ªç»“å°¾ï¼Œå½¢æˆçš„æ–°é›†åˆã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">objects = foo.o bar.o</span><br><span class="line"><span class="section">all: <span class="variable">$(objects)</span></span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(objects)</span>: %.o: %.c</span><br><span class="line">    <span class="variable">$(CC)</span> -c <span class="variable">$(CFLAGS)</span> <span class="variable">$&lt;</span> -o <span class="variable">$@</span></span><br></pre></td></tr></table></figure></p><p>å…¶ç›¸å½“äº<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">foo.o : foo.c</span><br><span class="line"><span class="variable">$(CC)</span> -c <span class="variable">$(CFLAGS)</span> foo.c -o foo.o</span><br><span class="line"></span><br><span class="line">bar.o : bar.c</span><br><span class="line"><span class="variable">$(CC)</span> -c <span class="variable">$(CFLAGS)</span> bar.c -o bar.o</span><br></pre></td></tr></table></figure></p><p>å†æ¯”å¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">files = foo.elc bar.o lose.o</span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">filter</span> %.o,<span class="variable">$(files)</span>)</span>: %.o: %.c</span><br><span class="line">    <span class="variable">$(CC)</span> -c <span class="variable">$(CFLAGS)</span> <span class="variable">$&lt;</span> -o <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">filter</span> %.elc,<span class="variable">$(files)</span>)</span>: %.elc: %.el</span><br><span class="line">    emacs -f batch-byte-compile <span class="variable">$&lt;</span></span><br></pre></td></tr></table></figure></p><h3 id="3-6-è‡ªåŠ¨ç”Ÿæˆä¾èµ–æ€§"><a href="#3-6-è‡ªåŠ¨ç”Ÿæˆä¾èµ–æ€§" class="headerlink" title="3.6 è‡ªåŠ¨ç”Ÿæˆä¾èµ–æ€§"></a>3.6 è‡ªåŠ¨ç”Ÿæˆä¾èµ–æ€§</h3><p>ä½¿ç”¨<code>gcc -MM filename</code>æˆ–<code>cc -m filename</code>å¯ä»¥è¾“å‡ºæ–‡ä»¶çš„ä¾èµ–é¡¹ã€‚<br>GNUç»„ç»‡å»ºè®®æŠŠç¼–è¯‘å™¨ä¸ºæ¯ä¸€ä¸ªæºæ–‡ä»¶çš„è‡ªåŠ¨ç”Ÿæˆçš„ä¾èµ–å…³ç³»æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä¸ºæ¯ä¸€ä¸ª<code>name.c</code>çš„æ–‡ä»¶éƒ½ç”Ÿæˆä¸€ä¸ª<code>name.d</code>çš„Makefileæ–‡ä»¶ï¼Œ<code>.d</code>æ–‡ä»¶ä¸­å°±å­˜æ”¾å¯¹åº”<code>.c</code>æ–‡ä»¶çš„ä¾èµ–å…³ç³»ã€‚<br>äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡º<code>.c</code>æ–‡ä»¶å’Œ<code>.d</code>æ–‡ä»¶çš„ä¾èµ–å…³ç³»ï¼Œå¹¶è®©makeè‡ªåŠ¨æ›´æ–°æˆ–è‡ªæˆ<code>.d</code>æ–‡ä»¶ï¼Œå¹¶æŠŠå…¶åŒ…å«åœ¨æˆ‘ä»¬çš„ä¸»Makefileä¸­ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥è‡ªåŠ¨åŒ–åœ°ç”Ÿæˆæ¯ä¸ªæ–‡ä»¶çš„ä¾èµ–å…³ç³»äº†ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬ç»™å‡ºäº†ä¸€ä¸ªæ¨¡å¼è§„åˆ™æ¥äº§ç”Ÿ[.d]æ–‡ä»¶ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">%.d: %.c</span></span><br><span class="line">    @set -e; rm -f <span class="variable">$@</span>; \</span><br><span class="line">    <span class="variable">$(CC)</span> -M <span class="variable">$(CPPFLAGS)</span> <span class="variable">$&lt;</span> &gt;; <span class="variable">$@</span>.$$$$; \</span><br><span class="line">    sed 's,\(<span class="variable">$*</span>\)\.o[ :]*,\1.o <span class="variable">$@</span> : ,g' &lt; <span class="variable">$@</span>.$$$$ &gt;; <span class="variable">$@</span>; \</span><br><span class="line">    rm -f <span class="variable">$@</span>.$$$$</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªè§„åˆ™çš„æ„æ€æ˜¯ï¼Œæ‰€æœ‰çš„<code>.d</code>æ–‡ä»¶ä¾èµ–äº<code>.c</code>æ–‡ä»¶ï¼Œ<code>rm -f $@</code>çš„æ„æ€æ˜¯åˆ é™¤æ‰€æœ‰çš„ç›®æ ‡ï¼Œä¹Ÿå°±æ˜¯<code>.d</code>æ–‡ä»¶ï¼Œç¬¬äºŒè¡Œçš„æ„æ€æ˜¯ï¼Œä¸ºæ¯ä¸ªä¾èµ–æ–‡ä»¶<code>$&lt;</code>ï¼Œä¹Ÿå°±æ˜¯<code>.c</code>æ–‡ä»¶ç”Ÿæˆä¾èµ–æ–‡ä»¶ï¼Œ<code>$@</code>è¡¨ç¤ºæ¨¡å¼ <code>%.d</code>æ–‡ä»¶ï¼Œå¦‚æœæœ‰ä¸€ä¸ªCæ–‡ä»¶æ˜¯name.cï¼Œé‚£ä¹ˆ<code>%</code>å°±æ˜¯<code>name</code>ï¼Œ<code>$$$$</code>æ„ä¸ºä¸€ä¸ªéšæœºç¼–å·ï¼Œç¬¬äºŒè¡Œç”Ÿæˆçš„æ–‡ä»¶æœ‰å¯èƒ½æ˜¯ <code>name.d.12345</code>ï¼Œç¬¬ä¸‰è¡Œä½¿ç”¨<code>sed</code>å‘½ä»¤åšäº†ä¸€ä¸ªæ›¿æ¢ï¼Œå…³äº<code>sed</code>å‘½ä»¤çš„ç”¨æ³•è¯·å‚çœ‹ç›¸å…³çš„ä½¿ç”¨æ–‡æ¡£ã€‚ç¬¬å››è¡Œå°±æ˜¯åˆ é™¤ä¸´æ—¶æ–‡ä»¶ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œè¿™ä¸ªæ¨¡å¼è¦åšçš„äº‹å°±æ˜¯åœ¨ç¼–è¯‘å™¨ç”Ÿæˆçš„ä¾èµ–å…³ç³»ä¸­åŠ å…¥[.d]æ–‡ä»¶çš„ä¾èµ–ï¼Œå³æŠŠä¾èµ–å…³ç³»ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">main.o : main.c defs.h</span><br></pre></td></tr></table></figure></p><p>è½¬æˆï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">main.o main.d : main.c defs.h</span><br></pre></td></tr></table></figure></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±è¦æŠŠè¿™äº›è‡ªåŠ¨ç”Ÿæˆçš„è§„åˆ™æ”¾è¿›æˆ‘ä»¬çš„ä¸»Makefileä¸­ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Makefileçš„<code>include</code>å‘½ä»¤ï¼Œæ¥å¼•å…¥åˆ«çš„Makefileæ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sources = foo.c bar.c</span><br><span class="line"><span class="keyword">include</span> $(sources:.c=.d)</span><br></pre></td></tr></table></figure></p><p>ä¸Šè¿°è¯­å¥ä¸­çš„<code>$(sources:.c=.d)</code>ä¸­çš„â€œ.c=.dâ€çš„æ„æ€æ˜¯åšä¸€ä¸ªæ›¿æ¢ï¼ŒæŠŠå˜é‡<code>$(sources)</code>æ‰€æœ‰<code>.c</code>çš„å­—ä¸²éƒ½æ›¿æ¢æˆ<code>.d</code>ï¼Œå…³äºè¿™ä¸ªâ€œæ›¿æ¢â€çš„å†…å®¹ï¼Œåœ¨åé¢æˆ‘ä¼šæœ‰æ›´ä¸ºè¯¦ç»†çš„è®²è¿°ã€‚å½“ç„¶ï¼Œä½ å¾—æ³¨æ„æ¬¡åºï¼Œå› ä¸º<code>include</code>æ˜¯æŒ‰æ¬¡æ¥è½½å…¥æ–‡ä»¶ï¼Œæœ€å…ˆè½½å…¥çš„<code>.d</code>æ–‡ä»¶ä¸­çš„ ç›®æ ‡ä¼šæˆä¸ºé»˜è®¤ç›®æ ‡ã€‚</p><hr><h2 id="4-Makefileä¹¦å†™å‘½ä»¤"><a href="#4-Makefileä¹¦å†™å‘½ä»¤" class="headerlink" title="4 Makefileä¹¦å†™å‘½ä»¤"></a>4 Makefileä¹¦å†™å‘½ä»¤</h2><h3 id="4-1-æ˜¾ç¤ºå‘½ä»¤"><a href="#4-1-æ˜¾ç¤ºå‘½ä»¤" class="headerlink" title="4.1 æ˜¾ç¤ºå‘½ä»¤"></a>4.1 æ˜¾ç¤ºå‘½ä»¤</h3><p>é€šå¸¸ï¼Œmakeä¼šæŠŠå…¶è¦æ‰§è¡Œçš„å‘½ä»¤è¡Œåœ¨å‘½ä»¤æ‰§è¡Œå‰è¾“å‡ºåˆ°å±å¹•ä¸Šã€‚å½“æˆ‘ä»¬ç”¨â€œ@â€å­—ç¬¦åœ¨å‘½ä»¤è¡Œå‰ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªå‘½ä»¤å°†ä¸è¢«makeæ˜¾ç¤ºå‡ºæ¥ï¼Œæœ€å…·ä»£è¡¨æ€§çš„ä¾‹å­æ˜¯ï¼Œæˆ‘ä»¬ç”¨è¿™ä¸ªåŠŸèƒ½æ¥åƒå±å¹•æ˜¾ç¤ºä¸€äº›ä¿¡æ¯ã€‚å¦‚ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@echo æ­£åœ¨ç¼–è¯‘XXXæ¨¡å—......</span><br></pre></td></tr></table></figure></p><p>å½“makeæ‰§è¡Œæ—¶ï¼Œä¼šè¾“å‡ºâ€œæ­£åœ¨ç¼–è¯‘XXXæ¨¡å—â€¦â€¦â€å­—ä¸²ï¼Œä½†ä¸ä¼šè¾“å‡ºå‘½ä»¤ï¼Œå¦‚æœæ²¡æœ‰â€œ@â€ï¼Œé‚£ä¹ˆï¼Œmakeå°†è¾“å‡ºï¼š</p><p>echo æ­£åœ¨ç¼–è¯‘XXXæ¨¡å—â€¦â€¦<br>æ­£åœ¨ç¼–è¯‘XXXæ¨¡å—â€¦â€¦</p><p>å¦‚æœmakeæ‰§è¡Œæ—¶ï¼Œå¸¦å…¥makeå‚æ•°<code>-n</code>æˆ–<code>--just-print</code>ï¼Œé‚£ä¹ˆå…¶åªæ˜¯æ˜¾ç¤ºå‘½ä»¤ï¼Œä½†ä¸ä¼šæ‰§è¡Œå‘½ä»¤ï¼Œè¿™ä¸ªåŠŸèƒ½å¾ˆæœ‰åˆ©äºæˆ‘ä»¬è°ƒè¯•æˆ‘ä»¬çš„Makefileï¼Œçœ‹çœ‹æˆ‘ä»¬ä¹¦å†™çš„å‘½ä»¤æ˜¯æ‰§è¡Œèµ·æ¥æ˜¯ä»€ä¹ˆæ ·å­çš„æˆ–æ˜¯ä»€ä¹ˆé¡ºåºçš„ã€‚</p><p>è€Œmakeå‚æ•°<code>-s</code>æˆ–<code>--slient</code>åˆ™æ˜¯å…¨é¢ç¦æ­¢å‘½ä»¤çš„æ˜¾ç¤ºã€‚</p><h3 id="4-2-å‘½ä»¤æ‰§è¡Œ"><a href="#4-2-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="4.2 å‘½ä»¤æ‰§è¡Œ"></a>4.2 å‘½ä»¤æ‰§è¡Œ</h3><p>å½“ä¾èµ–ç›®æ ‡æ–°äºç›®æ ‡æ—¶ï¼Œä¹Ÿå°±æ˜¯å½“è§„åˆ™çš„ç›®æ ‡éœ€è¦è¢«æ›´æ–°æ—¶ï¼Œmakeä¼šä¸€æ¡ä¸€æ¡çš„æ‰§è¡Œå…¶åçš„å‘½ä»¤ã€‚<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¦è®©<strong>ä¸Šä¸€æ¡å‘½ä»¤çš„ç»“æœåº”ç”¨åœ¨ä¸‹ä¸€æ¡å‘½ä»¤æ—¶ï¼Œåº”è¯¥ä½¿ç”¨åˆ†å·åˆ†éš”è¿™ä¸¤æ¡å‘½ä»¤</strong>ã€‚æ¯”å¦‚ç¬¬ä¸€æ¡å‘½ä»¤æ˜¯<code>cd</code>å‘½ä»¤ï¼Œä½ å¸Œæœ›ç¬¬äºŒæ¡å‘½ä»¤å¾—åœ¨<code>cd</code>ä¹‹åçš„åŸºç¡€ä¸Šè¿è¡Œï¼Œé‚£ä¹ˆä½ å°±ä¸èƒ½æŠŠè¿™ä¸¤æ¡å‘½ä»¤å†™åœ¨ä¸¤è¡Œä¸Šï¼Œè€Œåº”è¯¥æŠŠè¿™ä¸¤æ¡å‘½ä»¤å†™åœ¨ä¸€è¡Œä¸Šï¼Œç”¨åˆ†å·åˆ†éš”ã€‚å¦‚ï¼š</p><p>ç¤ºä¾‹ä¸€ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">exec:</span></span><br><span class="line">    cd /home/hchen</span><br><span class="line">    pwd</span><br></pre></td></tr></table></figure></p><p>ç¤ºä¾‹äºŒï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">exec:</span></span><br><span class="line">    cd /home/hchen; pwd</span><br></pre></td></tr></table></figure></p><p>å½“æˆ‘ä»¬æ‰§è¡Œ<code>make exec</code>æ—¶ï¼Œç¬¬ä¸€ä¸ªä¾‹å­ä¸­çš„<code>cd</code>æ²¡æœ‰ä½œç”¨ï¼Œ<code>pwd</code>ä¼šæ‰“å°å‡ºå½“å‰çš„Makefileç›®å½•ï¼Œè€Œç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œ<code>cd</code>å°±èµ·ä½œç”¨äº†ï¼Œpwdä¼šæ‰“å°å‡º<code>/home/hchen</code>ã€‚</p><h3 id="4-3-å‘½ä»¤å‡ºé”™"><a href="#4-3-å‘½ä»¤å‡ºé”™" class="headerlink" title="4.3 å‘½ä»¤å‡ºé”™"></a>4.3 å‘½ä»¤å‡ºé”™</h3><p>æ¯å½“å‘½ä»¤è¿è¡Œå®Œåï¼Œmakeä¼šæ£€æµ‹æ¯ä¸ªå‘½ä»¤çš„è¿”å›ç ï¼Œå¦‚æœå‘½ä»¤è¿”å›æˆåŠŸï¼Œé‚£ä¹ˆmakeä¼šæ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤ï¼Œå½“è§„åˆ™ä¸­æ‰€æœ‰çš„å‘½ä»¤æˆåŠŸè¿”å›åï¼Œè¿™ä¸ªè§„åˆ™å°±ç®—æ˜¯æˆåŠŸå®Œæˆäº†ã€‚å¦‚æœä¸€ä¸ªè§„åˆ™ä¸­çš„æŸä¸ªå‘½ä»¤å‡ºé”™äº†ï¼ˆå‘½ä»¤é€€å‡ºç éé›¶ï¼‰ï¼Œé‚£ä¹ˆmakeå°±ä¼šç»ˆæ­¢æ‰§è¡Œå½“å‰è§„åˆ™ï¼Œè¿™å°†æœ‰å¯èƒ½ç»ˆæ­¢æ‰€æœ‰è§„åˆ™çš„æ‰§è¡Œã€‚</p><p>æœ‰æ—¶å‘½ä»¤è¿”å›é0å¹¶ä¸ä»£è¡¨æœ‰é”™è¯¯ï¼Œæ¯”å¦‚<code>mkdir</code>çš„ç›®å½•å·²å­˜åœ¨ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬åœ¨å‘½ä»¤å‰åŠ <code>-</code>ï¼Œæ ‡è®°ä¸ºä¸ç®¡å‘½ä»¤å‡ºä¸å‡ºé”™éƒ½è®¤ä¸ºæ˜¯æˆåŠŸçš„ã€‚</p><p>å¦ä¸€ç§æ–¹å¼ä¸ºç»™makeåŠ ä¸Š<code>-i</code>æˆ–æ˜¯<code>--ignore-errors</code>å‚æ•°ï¼Œé‚£ä¹ˆï¼ŒMakefileä¸­æ‰€æœ‰å‘½ä»¤éƒ½ä¼šå¿½ç•¥é”™è¯¯ã€‚è€Œå¦‚æœä¸€ä¸ª è§„åˆ™æ˜¯ä»¥<code>.IGNORE</code>ä½œä¸ºç›®æ ‡çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªè§„åˆ™ä¸­çš„æ‰€æœ‰å‘½ä»¤å°†ä¼šå¿½ç•¥é”™è¯¯ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªè¦æä¸€ä¸‹çš„makeçš„å‚æ•°çš„æ˜¯<code>-k</code>æˆ–æ˜¯<code>--keep-going</code>ï¼Œè¿™ä¸ªå‚æ•°çš„æ„æ€æ˜¯ï¼Œå¦‚æœæŸè§„åˆ™ä¸­çš„å‘½ä»¤å‡ºé”™äº†ï¼Œé‚£ä¹ˆå°±ç»ˆç›®è¯¥è§„åˆ™çš„æ‰§è¡Œï¼Œä½†ç»§ç»­æ‰§è¡Œå…¶å®ƒè§„åˆ™ã€‚</p><h3 id="4-4-åµŒå¥—æ‰§è¡Œmake"><a href="#4-4-åµŒå¥—æ‰§è¡Œmake" class="headerlink" title="4.4 åµŒå¥—æ‰§è¡Œmake"></a>4.4 åµŒå¥—æ‰§è¡Œmake</h3><p>åœ¨ä¸€äº›å¤§çš„å·¥ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šæŠŠæˆ‘ä»¬ä¸åŒæ¨¡å—æˆ–æ˜¯ä¸åŒåŠŸèƒ½çš„æºæ–‡ä»¶æ”¾åœ¨ä¸åŒçš„ç›®å½•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸ªç›®å½•ä¸­éƒ½ä¹¦å†™ä¸€ä¸ªè¯¥ç›®å½•çš„Makefileï¼Œè¿™æœ‰åˆ©äºè®©æˆ‘ä»¬çš„Makefileå˜å¾—æ›´åŠ åœ°ç®€æ´ï¼Œè€Œä¸è‡³äºæŠŠæ‰€æœ‰çš„ä¸œè¥¿å…¨éƒ¨å†™åœ¨ä¸€ä¸ªMakefileä¸­ï¼Œè¿™æ ·ä¼šå¾ˆéš¾ç»´æŠ¤æˆ‘ä»¬çš„Makefileï¼Œè¿™ä¸ªæŠ€æœ¯å¯¹äºæˆ‘ä»¬æ¨¡ å—ç¼–è¯‘å’Œåˆ†æ®µç¼–è¯‘æœ‰ç€éå¸¸å¤§çš„å¥½å¤„ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå­ç›®å½•å«<code>subdir</code>ï¼Œè¿™ä¸ªç›®å½•ä¸‹æœ‰ä¸ªMakefileæ–‡ä»¶ï¼Œæ¥æŒ‡æ˜äº†è¿™ä¸ªç›®å½•ä¸‹æ–‡ä»¶çš„ç¼–è¯‘è§„åˆ™ã€‚é‚£ä¹ˆæˆ‘ä»¬æ€»æ§çš„Makefileå¯ä»¥è¿™æ ·ä¹¦å†™ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">subsystem:</span><br><span class="line">    cd subdir &amp;&amp; $(MAKE)</span><br></pre></td></tr></table></figure><p>å…¶ç­‰ä»·äºï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">subsystem:</span></span><br><span class="line">    <span class="variable">$(MAKE)</span> -C subdir</span><br></pre></td></tr></table></figure></p><p>å®šä¹‰<code>$(MAKE)</code>å®å˜é‡çš„æ„æ€æ˜¯ï¼Œä¹Ÿè®¸æˆ‘ä»¬çš„makeéœ€è¦ä¸€äº›å‚æ•°ï¼Œæ‰€ä»¥å®šä¹‰æˆä¸€ä¸ªå˜é‡æ¯”è¾ƒåˆ©äºç»´æŠ¤ã€‚è¿™ä¸¤ä¸ªä¾‹å­çš„æ„æ€éƒ½æ˜¯å…ˆè¿›å…¥<code>subdir</code>ç›®å½•ï¼Œç„¶åæ‰§è¡Œmakeå‘½ä»¤ã€‚<br>æˆ‘ä»¬æŠŠè¿™ä¸ªMakefileå«åšâ€œæ€»æ§Makefileâ€ï¼Œæ€»æ§Makefileçš„å˜é‡å¯ä»¥ä¼ é€’åˆ°ä¸‹çº§çš„Makefileä¸­ï¼ˆå¦‚æœä½ æ˜¾ç¤ºçš„å£°æ˜ï¼‰ï¼Œä½†æ˜¯ä¸ä¼šè¦†ç›–ä¸‹å±‚çš„Makefileä¸­æ‰€å®šä¹‰çš„å˜é‡ï¼Œé™¤éæŒ‡å®šäº†<code>-e</code>å‚æ•°ã€‚</p><p>å¦‚æœä½ è¦ä¼ é€’å˜é‡åˆ°ä¸‹çº§Makefileä¸­ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨è¿™æ ·çš„å£°æ˜ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> &lt;variable ...&gt;;</span><br></pre></td></tr></table></figure></p><p>å¦‚æœä½ ä¸æƒ³è®©æŸäº›å˜é‡ä¼ é€’åˆ°ä¸‹çº§Makefileä¸­ï¼Œé‚£ä¹ˆä½ å¯ä»¥è¿™æ ·å£°æ˜ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unexport</span> &lt;variable ...&gt;;</span><br></pre></td></tr></table></figure></p><p>ç¤ºä¾‹ï¼š<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¤ºä¾‹ä¸€</span></span><br><span class="line"><span class="keyword">export</span> variable = value</span><br><span class="line"><span class="comment">#å…¶ç­‰ä»·äºï¼š</span></span><br><span class="line">variable = value</span><br><span class="line"><span class="keyword">export</span> variable</span><br><span class="line"><span class="comment">#å…¶ç­‰ä»·äºï¼š</span></span><br><span class="line"><span class="keyword">export</span> variable := value</span><br><span class="line"><span class="comment">#å…¶ç­‰ä»·äºï¼š</span></span><br><span class="line">variable := value</span><br><span class="line"><span class="keyword">export</span> variable</span><br><span class="line"><span class="comment">#ç¤ºä¾‹äºŒï¼š</span></span><br><span class="line"><span class="keyword">export</span> variable += value</span><br><span class="line"><span class="comment">#å…¶ç­‰ä»·äºï¼š</span></span><br><span class="line">variable += value</span><br><span class="line"><span class="keyword">export</span> variable</span><br></pre></td></tr></table></figure></p><p>å¦‚æœä½ è¦ä¼ é€’æ‰€æœ‰çš„å˜é‡ï¼Œé‚£ä¹ˆï¼Œåªè¦ä¸€ä¸ª<code>export</code>å°±è¡Œäº†ã€‚åé¢ä»€ä¹ˆä¹Ÿä¸ç”¨è·Ÿï¼Œè¡¨ç¤ºä¼ é€’æ‰€æœ‰çš„å˜é‡ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ‰ä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªæ˜¯<code>SHELL</code>ï¼Œä¸€ä¸ªæ˜¯<code>MAKEFLAGS</code>ï¼Œè¿™ä¸¤ä¸ªå˜é‡ä¸ç®¡ä½ æ˜¯å¦<code>export</code>ï¼Œå…¶æ€»æ˜¯è¦ä¼ é€’åˆ°ä¸‹å±‚Makefileä¸­ï¼Œç‰¹åˆ«æ˜¯<code>MAKEFILES</code>å˜é‡ï¼Œå…¶ä¸­åŒ…å«äº†makeçš„å‚æ•°ä¿¡æ¯ï¼Œå¦‚æœæˆ‘ä»¬æ‰§è¡Œâ€œæ€»æ§Makefileâ€æ—¶æœ‰makeå‚æ•°æˆ–æ˜¯åœ¨ä¸Šå±‚Makefileä¸­å®šä¹‰äº† è¿™ä¸ªå˜é‡ï¼Œé‚£ä¹ˆ<code>MAKEFILES</code>å˜é‡å°†ä¼šæ˜¯è¿™äº›å‚æ•°ï¼Œå¹¶ä¼šä¼ é€’åˆ°ä¸‹å±‚Makefileä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ªç³»ç»Ÿçº§çš„ç¯å¢ƒå˜é‡ã€‚</p><h3 id="4-5-å®šä¹‰å‘½ä»¤åŒ…"><a href="#4-5-å®šä¹‰å‘½ä»¤åŒ…" class="headerlink" title="4.5 å®šä¹‰å‘½ä»¤åŒ…"></a>4.5 å®šä¹‰å‘½ä»¤åŒ…</h3><p>å¦‚æœMakefileä¸­å‡ºç°ä¸€äº›ç›¸åŒå‘½ä»¤åºåˆ—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä¸ºè¿™äº›ç›¸åŒçš„å‘½ä»¤åºåˆ—å®šä¹‰ä¸€ä¸ªå˜é‡ã€‚å®šä¹‰è¿™ç§å‘½ä»¤åºåˆ—çš„è¯­æ³•ä»¥<code>define</code>å¼€å§‹ï¼Œä»¥<code>endef</code>ç»“æŸï¼Œå¦‚ï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">define</span> run-yacc</span><br><span class="line">yacc <span class="variable">$(<span class="built_in">firstword</span> <span class="variable">$^</span>)</span></span><br><span class="line">mv y.tab.c <span class="variable">$@</span></span><br><span class="line"><span class="keyword">endef</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä½¿ç”¨å‘½ä»¤åŒ…</span></span><br><span class="line">foo.c : foo.y</span><br><span class="line">    $(run-yacc)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œ<code>run-yacc</code>æ˜¯è¿™ä¸ªå‘½ä»¤åŒ…çš„åå­—ï¼Œå…¶ä¸è¦å’ŒMakefileä¸­çš„å˜é‡é‡åã€‚åœ¨<code>define</code>å’Œ<code>endef</code>ä¸­çš„ä¸¤è¡Œå°±æ˜¯å‘½ä»¤åºåˆ—ã€‚è¿™ä¸ªå‘½ä»¤åŒ…ä¸­çš„ç¬¬ä¸€ä¸ªå‘½ä»¤æ˜¯è¿è¡Œ<code>Yacc</code>ç¨‹åºï¼Œå› ä¸º<code>Yacc</code>ç¨‹åºæ€»æ˜¯ç”Ÿæˆ<code>y.tab.c</code>çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ç¬¬äºŒè¡Œçš„å‘½ä»¤å°±æ˜¯æŠŠè¿™ä¸ªæ–‡ä»¶æ”¹æ”¹åå­—ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0-ä»€ä¹ˆæ˜¯Makeflie&quot;&gt;&lt;a href=&quot;#0-ä»€ä¹ˆæ˜¯Makeflie&quot; class=&quot;headerlink&quot; title=&quot;0 ä»€ä¹ˆæ˜¯Makeflie&quot;&gt;&lt;/a&gt;0 ä»€ä¹ˆæ˜¯Makeflie&lt;/h2&gt;&lt;h3 id=&quot;0-1-makefileå…³ç³»åˆ°äº†æ•´ä¸ªå·¥ç¨‹çš„
      
    
    </summary>
    
      <category term="æ•™ç¨‹" scheme="http://yoursite.com/categories/%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="Makefile" scheme="http://yoursite.com/tags/Makefile/"/>
    
      <category term="ç¼–è¯‘" scheme="http://yoursite.com/tags/%E7%BC%96%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>C++ç±»é›¶ç¢</title>
    <link href="http://yoursite.com/2018/07/29/C++%E7%B1%BB%E9%9B%B6%E7%A2%8E/"/>
    <id>http://yoursite.com/2018/07/29/C++ç±»é›¶ç¢/</id>
    <published>2018-07-28T22:00:00.000Z</published>
    <updated>2020-05-10T07:05:43.257Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç§æœ‰æ„é€ å‡½æ•°"><a href="#ç§æœ‰æ„é€ å‡½æ•°" class="headerlink" title="ç§æœ‰æ„é€ å‡½æ•°"></a>ç§æœ‰æ„é€ å‡½æ•°</h2><p>é¦–å…ˆï¼Œprivateæˆå‘˜ä¸æ–¹æ³•åªèƒ½è¢«ç±»å†…éƒ¨çš„æ–¹æ³•è®¿é—®ï¼Œè€Œprotectedæˆå‘˜ä¸æ–¹æ³•åªèƒ½è¢«ç±»å†…éƒ¨æˆ–æ´¾ç”Ÿç±»å†…éƒ¨çš„æ–¹æ³•è®¿é—®ã€‚<br>è€Œæ„é€ å‡½æ•°ä¸€å®šæ˜¯åœ¨å¤–éƒ¨è¢«è®¿é—®ï¼Œæ‰€ä»¥å«æœ‰privateæˆ–protectedæ„é€ å‡½æ•°çš„ç±»ä¸èƒ½å£°æ˜å¯¹è±¡ã€‚<br>æˆ‘è§‰å¾—è¿™ç§ç±»å¸¸ç”¨äºæŠ½è±¡ç±»ï¼Œå³å«æœ‰çº¯è™šå‡½æ•°çš„ç±»ï¼Œè¿™ç§ç±»ç”¨äºå®ç°å¤šæ€ï¼Œåªèƒ½ä»å…¶å­ç±»å£°æ˜å¯¹è±¡ï¼Œä¸ºäº†é˜²æ­¢ç”¨æŠ½è±¡ç±»å£°æ˜å¯¹è±¡ï¼Œå°†å…¶æ„é€ å‡½æ•°è®¾ä¸ºç§æœ‰ã€‚</p><ul><li><p>æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°è°ƒç”¨</p><p>æ—¢ç„¶æŠ½è±¡ç±»ä¸èƒ½å£°æ˜å¯¹è±¡ï¼Œé‚£ä¹ˆå…¶æ„é€ å‡½æ•°è¿˜æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿ<br>å›å¿†èµ·å­ç±»å£°æ˜çš„è¿‡ç¨‹ï¼Œæ„é€ å‡½æ•°æ˜¯ä¸€å±‚å±‚å‘ä¸Šè°ƒç”¨çš„ï¼Œæ‰€ä»¥æœ€ç»ˆä¼šè°ƒç”¨æŠ½è±¡åŸºç±»çš„æ„é€ å‡½æ•°ï¼Œç”¨æ¥åˆå§‹åŒ–æŠ½è±¡åŸºç±»çš„æˆå‘˜ã€‚</p></li><li><p>å•ä¾‹æ¨¡å¼</p><p>privateæ„é€ å‡½æ•°è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„ç”¨æ³•ä¸ºå®ç°ç®€å•å•ä¾‹æ¨¡å¼ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CSingleton</span>&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  CSingleton()&#123;<span class="comment">//æ„é€ å‡½æ•°æ˜¯ç§æœ‰çš„</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">static</span> CSingleton *m_pInstance;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">static</span> CSingleton * <span class="title">GetInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(m_pInstance == <span class="literal">NULL</span>)  <span class="comment">//åˆ¤æ–­æ˜¯å¦ç¬¬ä¸€æ¬¡è°ƒç”¨</span></span><br><span class="line">m_pInstance = <span class="keyword">new</span> CSingleton();</span><br><span class="line"><span class="keyword">return</span> m_pInstance;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç”¨æˆ·è·å¾—å®ä¾‹çš„æ–¹æ³•åªæœ‰é€šè¿‡<code>GetInstance</code>æ–¹æ³•ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CSingleton * pCSingle = CSingleton::GetInstance();</span><br><span class="line">CSingleton * p2 = pCSingle-&gt;GetInstance();</span><br></pre></td></tr></table></figure></li></ul><h2 id="ç±»çš„staticæˆå‘˜"><a href="#ç±»çš„staticæˆå‘˜" class="headerlink" title="ç±»çš„staticæˆå‘˜"></a>ç±»çš„<code>static</code>æˆå‘˜</h2><p>é¦–å…ˆï¼Œ<code>static</code>å…³é”®å­—çš„ä½œç”¨æœ‰äºŒï¼š</p><ul><li>å½“å®ƒç”¨åœ¨å…¨å±€å˜é‡ä¸Šæ—¶ï¼Œå®ƒçš„ä½œç”¨æ˜¯é™åˆ¶è¯¥å˜é‡çš„å¯è§èŒƒå›´ï¼Œå°†è¯¥å˜é‡é™åˆ¶åœ¨æœ¬æ–‡ä»¶å†…å¯è§ï¼›</li><li>å½“å®ƒåº”ç”¨åœ¨å±€éƒ¨å˜é‡ä¸Šæ—¶ï¼Œä¼šå°†è¯¥å˜é‡çš„å­˜å‚¨ä½ç½®æ”¹å˜ä¸ºå­˜å‚¨åœ¨é™æ€åŒºï¼Œå¹¶ä¸”å°†è¯¥å˜é‡çš„ç”Ÿå­˜å‘¨æœŸæ”¹ä¸ºæ•´ä¸ªç¨‹åºéƒ½å­˜åœ¨ï¼Œè™½ç„¶å˜é‡çš„ä½œç”¨åŸŸä¸å‘ç”Ÿå˜åŒ–ã€‚</li></ul><p>ç±»ä¸­å®šä¹‰çš„<code>static</code>æˆå‘˜ï¼ŒåŒæ ·å­˜å‚¨åœ¨é™æ€å­˜å‚¨åŒºï¼Œç±»çš„æ‰€æœ‰å¯¹è±¡å…±ç”¨<code>static</code>æˆå‘˜ï¼Œæ—¢ä¿è¯äº†å¯¹å¤–éƒ¨éšè—ï¼Œå³ä½œç”¨äºä»…é™äºç±»å†…éƒ¨ï¼Œåˆå®ç°äº†æ‰€æœ‰ç±»å¯¹è±¡ä¹‹é—´çš„å…±äº«ã€‚</p><ul><li>å¯¹äº<code>static</code>å‡½æ•°ï¼Œå…¶æ²¡æœ‰thisæŒ‡é’ˆï¼Œä¸èƒ½è®¿é—®ç±»çš„æ™®é€šæˆå‘˜ä¸æˆå‘˜å‡½æ•°ï¼Œåªèƒ½è®¿é—®ç±»çš„é™æ€æˆå‘˜ï¼›</li><li>å¯¹äº<code>static</code>æˆå‘˜ï¼Œéœ€è¦åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ï¼Œä¸”ä¸èƒ½åœ¨å¤´æ–‡ä»¶ä¸­åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–æ–¹æ³•ä¸ºï¼š<code>&lt;æ•°æ®ç±»å‹&gt;&lt;ç±»å&gt;::&lt;é™æ€æ•°æ®æˆå‘˜å&gt;=&lt;å€¼&gt;</code>ï¼›</li><li>å¯¹äº<code>public</code>ç±»å‹çš„<code>static</code>æˆå‘˜ï¼Œå¯ç”¨<code>&lt;ç±»å&gt;::&lt;é™æ€æˆå‘˜å&gt;</code>çš„æ–¹æ³•åœ¨éç±»çš„å¯¹è±¡ä¸­å¼•ç”¨é™æ€æˆå‘˜ï¼Œè¿›ä¸€æ­¥è¯´æ˜äº†é™æ€æˆå‘˜å±äºç±»è€Œéå¯¹è±¡ï¼›</li><li>å­ç±»å’Œçˆ¶ç±»çš„åŒå<code>static</code>æˆå‘˜æˆ–æ–¹æ³•ï¼Œè°ƒç”¨å“ªä¸€ä¸ªçœ‹ä½œç”¨åŸŸã€‚</li></ul><h2 id="è™šå‡½æ•°è°ƒç”¨"><a href="#è™šå‡½æ•°è°ƒç”¨" class="headerlink" title="è™šå‡½æ•°è°ƒç”¨"></a>è™šå‡½æ•°è°ƒç”¨</h2><p>ä»Šå¤©å¯¹è™šå‡½æ•°çš„è°ƒç”¨æœ‰ç–‘é—®ï¼Œä¸»è¦ç–‘é—®ä¸ºï¼šç±»æ–¹æ³•å¯¹è™šå‡½æ•°çš„è°ƒç”¨åˆ°åº•è°ƒç”¨çš„æ˜¯å“ªä¸ªã€‚<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">go_out</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"out A"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span><span class="keyword">public</span> A&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">go_out();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">go_out</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"out B"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span><span class="keyword">public</span> B&#123;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">go_out</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"out C"</span> &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span>&#123;</span><br><span class="line">C *cc = <span class="keyword">new</span> C();</span><br><span class="line">cc-&gt;test();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å®éªŒå‘ç°ï¼Œè¾“å‡ºç»“æœä¸º<code>out C</code>ã€‚<br>å…¶å®è¿™ç¬¦åˆè™šå‡½æ•°çš„è°ƒç”¨åŸç†ï¼Œæ¯•ç«Ÿtestæ˜¯é€šè¿‡æŒ‡å‘Cç±»å‹çš„æŒ‡é’ˆè°ƒç”¨çš„ã€‚<br>æ”¹ä¸º<code>B *cc = new C();</code>è¾“å‡ºç»“æœä¹Ÿä¸€æ ·ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ç§æœ‰æ„é€ å‡½æ•°&quot;&gt;&lt;a href=&quot;#ç§æœ‰æ„é€ å‡½æ•°&quot; class=&quot;headerlink&quot; title=&quot;ç§æœ‰æ„é€ å‡½æ•°&quot;&gt;&lt;/a&gt;ç§æœ‰æ„é€ å‡½æ•°&lt;/h2&gt;&lt;p&gt;é¦–å…ˆï¼Œprivateæˆå‘˜ä¸æ–¹æ³•åªèƒ½è¢«ç±»å†…éƒ¨çš„æ–¹æ³•è®¿é—®ï¼Œè€Œprotectedæˆå‘˜ä¸æ–¹æ³•åªèƒ½è¢«ç±»å†…éƒ¨æˆ–æ´¾ç”Ÿç±»å†…éƒ¨
      
    
    </summary>
    
      <category term="ç¬”è®°" scheme="http://yoursite.com/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="C++" scheme="http://yoursite.com/tags/C/"/>
    
      <category term="å¤šæ€" scheme="http://yoursite.com/tags/%E5%A4%9A%E6%80%81/"/>
    
  </entry>
  
  <entry>
    <title>typedefä¸å‡½æ•°æŒ‡é’ˆ</title>
    <link href="http://yoursite.com/2018/07/26/typedef%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88/"/>
    <id>http://yoursite.com/2018/07/26/typedefå‡½æ•°æŒ‡é’ˆ/</id>
    <published>2018-07-25T22:44:00.000Z</published>
    <updated>2020-05-10T07:08:45.662Z</updated>
    
    <content type="html"><![CDATA[<h2 id="typedefåŸºæœ¬"><a href="#typedefåŸºæœ¬" class="headerlink" title="typedefåŸºæœ¬"></a>typedefåŸºæœ¬</h2><p>ä»Šæ—¥åœ¨ä»£ç ä¸­çœ‹åˆ°ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">void</span> <span class="params">(ISSCALLBACK *Proc_MVWOnMsgProc)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> <span class="keyword">void</span>*         pUsrArg,     <span class="comment">/* [In] User defined parameter */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">unsigned</span> <span class="keyword">int</span>        uMsg,        <span class="comment">/* [In] The message identifier */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">unsigned</span> <span class="keyword">int</span>        wParam,      <span class="comment">/* [In] Message additional information */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> <span class="keyword">void</span>*         lParam        <span class="comment">/* [In] Message additional information */</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><p>ä¸€æ—¶ä¹‹é—´æ— æ³•ç†è§£å…¶æ„ä¹‰ï¼Œå‘è§‰è‡ªå·±å¯¹<code>typedef</code>ä»¥åŠå‡½æ•°æŒ‡é’ˆæœ‰äº›ç”Ÿç–ï¼Œç°åœ¨é‡æ–°æ•´ç†äºŒè€…ç”¨æ³•ã€‚</p><p>é¦–å…ˆçœ‹ä¸€ä¸ªå˜é‡å®šä¹‰ä¸<code>typedef</code>çš„åŒºåˆ«ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> number1;<span class="comment">//numberä¸º unsigned int å‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> number2;<span class="comment">//ä½¿ç”¨number2å®šä¹‰çš„å˜é‡ä¸º unsigned int å‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> ISS_TTS_CODEPAGE &#123;</span><br><span class="line">    ISS_TTS_CODEPAGE_GBK = <span class="number">936</span>,</span><br><span class="line">    ISS_TTS_CODEPAGE_UTF16LE = <span class="number">1200</span>,</span><br><span class="line">    ISS_TTS_CODEPAGE_UTF8 = <span class="number">65001</span></span><br><span class="line">&#125; ISSTTSCodePage;</span><br><span class="line"><span class="comment">//ISSTTSCodePageä¸ºISS_TTS_CODEPAGEç±»å‹çš„enum</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> ISS_TTS_CODEPAGE &#123;</span><br><span class="line">    ISS_TTS_CODEPAGE_GBK = <span class="number">936</span>,</span><br><span class="line">    ISS_TTS_CODEPAGE_UTF16LE = <span class="number">1200</span>,</span><br><span class="line">    ISS_TTS_CODEPAGE_UTF8 = <span class="number">65001</span></span><br><span class="line">&#125; ISSTTSCodePage2;</span><br><span class="line"><span class="comment">//ISSTTSCodePageå®šä¹‰çš„å˜é‡ä¸ºISS_TTS_CODEPAGEç±»å‹çš„enum</span></span><br><span class="line">ISSTTSCodePage2 someitem;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºåŸæœ‰çš„å®šä¹‰åŠ ä¸Š<code>typedef</code>å°±å°†å…¶è½¬åŒ–ä¸ºå®šä¹‰åŸå®šä¹‰çš„ç±»å‹ã€‚</p><h2 id="å‡½æ•°æŒ‡é’ˆ"><a href="#å‡½æ•°æŒ‡é’ˆ" class="headerlink" title="å‡½æ•°æŒ‡é’ˆ"></a>å‡½æ•°æŒ‡é’ˆ</h2><p>å†æ¥è¯´å‡½æ•°æŒ‡é’ˆï¼Œä¸¾æœ€ç®€å•çš„ä¾‹å­ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> (*PTRFUN)(<span class="keyword">int</span>);</span><br></pre></td></tr></table></figure></p><p>è¡¨ç¤º<code>PTRFUN</code>æŒ‡å‘ä¸€ä¸ªå½¢å‚ä¸º<code>int</code>è¿”å›å€¼ä¸º<code>char</code>çš„å‡½æ•°</p><p>è‹¥æ˜¯åŠ ä¸Š<code>typedef</code>ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">char</span> <span class="params">(*PTRFUN)</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br></pre></td></tr></table></figure></p><p>åˆ™å¯ä»¥ç”¨<code>PTRFUN</code>æ¥å®šä¹‰å‡½æ•°ï¼Œç‰¹åˆ«æ˜¯ç”¨åœ¨å›è°ƒå‡½æ•°ä¸Šï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">callbackfunc</span><span class="params">(<span class="keyword">int</span> num, <span class="keyword">bool</span> torf, PTRFUN somefunc)</span></span>;</span><br></pre></td></tr></table></figure></p><h2 id="typedefæ•°ç»„æŒ‡é’ˆ"><a href="#typedefæ•°ç»„æŒ‡é’ˆ" class="headerlink" title="typedefæ•°ç»„æŒ‡é’ˆ"></a>typedefæ•°ç»„æŒ‡é’ˆ</h2><p>ä»Šå¤©åˆåœ¨ä»£ç ä¸­çœ‹åˆ°ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BUFSIZE (3200)</span></span><br><span class="line"><span class="keyword">typedef</span> byte BUFFER[BUFSIZE];</span><br><span class="line">BUFFER *m_pBuffer = <span class="keyword">new</span> BUFFER[BUFNUM];</span><br></pre></td></tr></table></figure></p><p>æœ‰ç‚¹è¿·æƒ‘<code>new</code>å‡ºæ¥çš„æ˜¯<code>byte[10][3200]</code>è¿˜æ˜¯<code>byte[3200][10]</code>ã€‚<br>å…¶å®çœ‹<code>m_pBuffer</code>çš„ç±»å‹å³å¯ï¼Œå°†<code>*m_pBuffer</code>æ›¿æ¢åˆ°typedefå®šä¹‰ä¸­ï¼Œå³æ˜¯ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">byte *m_pBuffer[BUFSIZE];</span><br></pre></td></tr></table></figure></p><p>å³<code>m_pBuffer</code>ä¸ºæŒ‡å‘<code>byte[3200]</code>çš„æŒ‡é’ˆï¼Œå¯è§newå‡ºæ¥çš„ä¸€å®šæ˜¯<code>byte[10][3200]</code>ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;typedefåŸºæœ¬&quot;&gt;&lt;a href=&quot;#typedefåŸºæœ¬&quot; class=&quot;headerlink&quot; title=&quot;typedefåŸºæœ¬&quot;&gt;&lt;/a&gt;typedefåŸºæœ¬&lt;/h2&gt;&lt;p&gt;ä»Šæ—¥åœ¨ä»£ç ä¸­çœ‹åˆ°ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight cpp
      
    
    </summary>
    
      <category term="çŸ¥è¯†" scheme="http://yoursite.com/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="C++" scheme="http://yoursite.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntuå®‰è£…åè¦åšçš„ä¸€äº›äº‹</title>
    <link href="http://yoursite.com/2017/11/06/ubuntu%E5%AE%89%E8%A3%85%E5%90%8E%E8%A6%81%E5%81%9A%E7%9A%84%E4%B8%80%E4%BA%9B%E4%BA%8B/"/>
    <id>http://yoursite.com/2017/11/06/ubuntuå®‰è£…åè¦åšçš„ä¸€äº›äº‹/</id>
    <published>2017-11-05T22:00:00.000Z</published>
    <updated>2020-05-10T07:09:19.679Z</updated>
    
    <content type="html"><![CDATA[<p>ubuntuæˆ‘é‡è£…äº†ä¸çŸ¥é“æœ‰å¤šå°‘éï¼Œæ¯æ¬¡é‡è£…æ—¶éƒ½è¦é‡å¤è¿›è¡Œä¸€äº›æ“ä½œï¼Œè¿™æ¬¡å¹²è„†å°†è¿™äº›å¸¸ç”¨æ“ä½œè®°å½•ä¸‹æ¥ï¼Œä»¥ä¾¿ä¸‹æ¬¡é‡è£…æ—¶æŸ¥è¯¢ã€‚</p><hr><h2 id="æ›´æ¢è½¯ä»¶æº"><a href="#æ›´æ¢è½¯ä»¶æº" class="headerlink" title="æ›´æ¢è½¯ä»¶æº"></a>æ›´æ¢è½¯ä»¶æº</h2><ul><li><p>ç¼–è¾‘æº  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo gedit /etc/apt/sources.list</span><br></pre></td></tr></table></figure><p>  å°†åŸå†…å®¹æ›´æ¢ä¸ºï¼š  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">deb https://linux.xidian.edu.cn/mirrors/ubuntu/ xenial main restricted universe multiverse</span><br><span class="line">deb https://linux.xidian.edu.cn/mirrors/ xenial-security main restricted universe multiverse</span><br><span class="line">deb https://linux.xidian.edu.cn/mirrors/ubuntu/ xenial-updates main restricted universe multiverse</span><br><span class="line">deb https://linux.xidian.edu.cn/mirrors/ubuntu/ xenial-proposed main restricted universe multiverse</span><br><span class="line">deb https://linux.xidian.edu.cn/mirrors/ubuntu/ xenial-backports main restricted universe multiverse</span><br><span class="line">deb-src https://linux.xidian.edu.cn/mirrors/ubuntu/ xenial main restricted universe multiverse</span><br><span class="line">deb-src https://linux.xidian.edu.cn/mirrors/ xenial-security main restricted universe multiverse</span><br><span class="line">deb-src https://linux.xidian.edu.cn/mirrors/ xenial-updates main restricted universe multiverse</span><br><span class="line">deb-src https://linux.xidian.edu.cn/mirrors/ xenial-proposed main restricted universe multiverse</span><br><span class="line">deb-src https://linux.xidian.edu.cn/mirrors/ xenial-backports main restricted universe multiverse</span><br></pre></td></tr></table></figure><p>  è¿™é‡Œè¦æ„Ÿè°¢<a href="https://linux.xidian.edu.cn/" target="_blank" rel="noopener">è¥¿ç”µå¼€æºç¤¾åŒº</a>çš„æ— ç§å¥‰çŒ®ï¼Œè®©æˆ‘ä»¬åœ¨æ ¡å†…èƒ½å¤Ÿäº«å—é€Ÿåº¦å¿«ä¸”å…æµçš„è½¯ä»¶æºã€‚</p></li><li><p>æ›´æ–°æº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt update</span><br></pre></td></tr></table></figure></li></ul><hr><h2 id="ç¿»å¢™"><a href="#ç¿»å¢™" class="headerlink" title="ç¿»å¢™"></a>ç¿»å¢™</h2><blockquote><p>ä¸ç¿»å¢™ï¼Œæ¯‹å®æ­»ã€‚</p></blockquote><ul><li><p>å®‰è£…miredo</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt install miredo</span><br></pre></td></tr></table></figure></li><li><p>æµ‹è¯•æ˜¯å¦æœ‰ipv6è¿æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ping6 ipv6.baidu.com</span><br></pre></td></tr></table></figure><p>  ä½†æ¯æ¬¡å¼€æœºéƒ½éœ€è¦é‡æ–°å¯åŠ¨miredoï¼Œéå¸¸éº»çƒ¦ï¼Œæ‰€ä»¥åœ¨<code>/etc/local.rc</code>æ–‡ä»¶ä¸­æ·»åŠ <code>/etc/init.d/miredo start</code>ä½¿miredoå¼€æœºè‡ªå¯ï¼Œæ³¨æ„è¦æ·»åŠ åœ¨<code>exit 0</code>ä¹‹å‰ã€‚</p></li><li><p>å®‰è£…ss</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo add-apt-repository ppa:hzwhuang/ss-qt5</span><br><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get install shadowsocks-qt5</span><br></pre></td></tr></table></figure></li><li><p>é…ç½®chrome<br>åœ¨ssé…ç½®å®Œæ¯•åï¼Œä»¥ä»£ç†æ¨¡å¼æ‰“å¼€chromeï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ google-chrome --proxy-server=socks5://127.0.0.1:1080</span><br></pre></td></tr></table></figure><p>  ç™»å½•googleå¸å·ï¼ŒåŒæ­¥æ’ä»¶ä¸ä¹¦ç­¾ï¼Œå¹¶å¯¼å…¥proxyé…ç½®ã€‚</p></li></ul><hr><h2 id="å®‰è£…rEFInd"><a href="#å®‰è£…rEFInd" class="headerlink" title="å®‰è£…rEFInd"></a>å®‰è£…rEFInd</h2><p>åŒç³»ç»Ÿç”¨grubå¼•å¯¼å¯ä»¥è¯´æ˜¯éå¸¸ä¸‘ï¼Œç´«ä¸æ‹‰å½çš„èƒŒæ™¯ï¼Œæ— æ³•æ›´æ”¹çš„ç•Œé¢ã€‚äºæ˜¯é€‰æ‹©<a href="http://www.rodsbooks.com/refind/installing.html" target="_blank" rel="noopener">rEFInd</a>ä½œä¸ºåŒç³»ç»Ÿçš„å¼•å¯¼ã€‚  </p><ul><li><p>å®‰è£…:<br>æ‰§è¡Œè„šæœ¬ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./refind-install</span><br></pre></td></tr></table></figure><p>  æˆ–è€…ä½¿ç”¨aptå®‰è£…ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-add-repository ppa:rodsmith/refind</span><br><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get install refind</span><br></pre></td></tr></table></figure><p>  å®‰è£…åè·¯å¾„ä¸ºï¼š<code>/boot/efi/EFI/refind</code></p></li><li><p>å®‰è£…ä¸»é¢˜<br><code>/boot/efi/EFI/refind</code>ç›®å½•ä¸‹æ–°å»ºthemesæ–‡ä»¶å¤¹ï¼Œå¹¶å°†rEFInd-minimalæ–‡ä»¶å¤¹å¤åˆ¶è¿›å»ã€‚<br>å°†ä»£ç <code>include themes/rEFInd-minimal/theme.conf</code>æ·»åŠ åˆ°<code>refind.conf</code>æ–‡ä»¶æœ«å°¾ã€‚<br>æ›´æ”¹ä¸‹é¢å‡ ä¸ªé€‰é¡¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">timeout 2             <span class="comment">#è¶…æ—¶</span></span><br><span class="line">resolution 1920 1080  <span class="comment">#åˆ†è¾¨ç‡</span></span><br><span class="line">max_tags 3            <span class="comment">#æœ€å¤§å›¾æ ‡ä¸ªæ•°</span></span><br></pre></td></tr></table></figure></li><li><p>è·³è¿‡grubå¼•å¯¼<br>å°†æ–‡ä»¶<code>/etc/default/grub</code>ä¸­çš„<code>#GRUB_HIDDEN_TIMEOUT=0</code>æ³¨é‡Šå»æ‰ï¼Œå°±ä¼šè·³è¿‡grubå¼•å¯¼ï¼Œç›´æ¥è¿›å…¥ç³»ç»Ÿã€‚</p></li></ul><hr><h2 id="è§£å†³ubuntu-windowsæ—¶é—´ä¸ä¸€è‡´çš„é—®é¢˜"><a href="#è§£å†³ubuntu-windowsæ—¶é—´ä¸ä¸€è‡´çš„é—®é¢˜" class="headerlink" title="è§£å†³ubuntu/windowsæ—¶é—´ä¸ä¸€è‡´çš„é—®é¢˜"></a>è§£å†³ubuntu/windowsæ—¶é—´ä¸ä¸€è‡´çš„é—®é¢˜</h2><ul><li>ä¸€è¡ŒæŒ‡ä»¤æå®š<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ timedatectl <span class="built_in">set</span>-local-rtc 1 --adjust-system-clock</span><br></pre></td></tr></table></figure></li></ul><hr><h2 id="å®‰è£…unityä¸»é¢˜"><a href="#å®‰è£…unityä¸»é¢˜" class="headerlink" title="å®‰è£…unityä¸»é¢˜"></a>å®‰è£…unityä¸»é¢˜</h2><p>unityæœ‰è®¸å¤šç±»macä¸»é¢˜ä¸æ‰å¹³åŒ–å›¾æ ‡ï¼Œè¿™é‡Œé€‰æ‹©Flatabulousä¸»é¢˜ä¸ultra-flatå›¾æ ‡ã€‚</p><ul><li><p>unity-tweak-tool<br>é¦–å…ˆå®‰è£…unity-tweak-toolï¼Œç®¡ç†ä¸»é¢˜ä¸å›¾æ ‡ï¼Œå¹¶è¿›è¡Œä¸€äº›unityçš„è®¾ç½®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt install unity-tweak-tool</span><br></pre></td></tr></table></figure></li><li><p>Flatabulousä¸»é¢˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo add-apt-repository ppa:noobslab/themes</span><br><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get install flatabulous-theme</span><br></pre></td></tr></table></figure></li><li><p>ultra-flatå›¾æ ‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo add-apt-repository ppa:noobslab/icons</span><br><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get install ultra-flat-icons</span><br></pre></td></tr></table></figure><p>  æ•ˆæœå¦‚ä¸‹ï¼š<br><img src="/img/xiaoguo.png" alt>  </p></li></ul><hr><h2 id="å¸¸ç”¨è½¯ä»¶å®‰è£…"><a href="#å¸¸ç”¨è½¯ä»¶å®‰è£…" class="headerlink" title="å¸¸ç”¨è½¯ä»¶å®‰è£…"></a>å¸¸ç”¨è½¯ä»¶å®‰è£…</h2><blockquote><p>linuxä¸‹è‡ªç„¶æ˜¯ç”¨æ¥å­¦ä¹ ä¸å†™ä»£ç çš„ï¼Œä¸‹é¢è¿™å‡ ä¸ªå¸¸ç”¨è½¯ä»¶ä¹Ÿæ˜¯å¿…è£…çš„ã€‚</p></blockquote><ul><li><p>sublime text</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…GPG key</span></span><br><span class="line">$ wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -</span><br><span class="line"><span class="comment">#ç¡®ä¿aptå·¥ä½œåœ¨httpsæºçš„æ¨¡å¼</span></span><br><span class="line">$ sudo apt-get install apt-transport-https</span><br><span class="line"><span class="comment">#ä½¿ç”¨stableæ–¹å¼å®‰è£…</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"deb https://download.sublimetext.com/ apt/stable/"</span> | sudo tee</span><br><span class="line">$ /etc/apt/sources.list.d/sublime-text.list</span><br><span class="line"><span class="comment">#æ›´æ–°æºå¹¶å®‰è£…</span></span><br><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get install sublime-text</span><br></pre></td></tr></table></figure></li><li><p>spyder</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ apt install spyder</span><br></pre></td></tr></table></figure></li><li><p>mysql</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç¬¬ä¸€æ¡æŒ‡ä»¤å®‰è£…è¿‡ç¨‹ä¸­éœ€è¦è®¾å®šrootå¯†ç </span></span><br><span class="line">$ sudo apt install mysql-server</span><br><span class="line">$ sudo apt install mysql-client</span><br><span class="line">$ sudo apt install libmysqlclient-dev</span><br><span class="line"><span class="comment">#å¯è§†åŒ–å·¥å…·</span></span><br><span class="line">$ sudo apt install mysql-workbench</span><br></pre></td></tr></table></figure></li><li><p>wps<br>unbuntuè‡ªå¸¦çš„libreä¸MS officeä¹‹é—´æœ‰è®¸å¤šå…¼å®¹æ€§é—®é¢˜ï¼Œæ‰€ä»¥å¸è½½libreï¼Œå®‰è£…wpsã€‚<br>å¸è½½libreï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get remove libreoffice-common</span><br></pre></td></tr></table></figure><p>  å®‰è£…å®Œwpsåä¼šæœ‰å­—ä½“ç¼ºå¤±é—®é¢˜ï¼Œä¸‹è½½<a href="https://pan.baidu.com/s/1eS6xIzo" target="_blank" rel="noopener">å­—ä½“æ–‡ä»¶</a>ï¼Œå°†ç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°<code>/usr/share/fonts</code>ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo cp mtextra.ttf  symbol.ttf  WEBDINGS.TTF  wingding.ttf  WINGDNG2.ttf  WINGDNG3.ttf  /usr/share/fonts</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ubuntuæˆ‘é‡è£…äº†ä¸çŸ¥é“æœ‰å¤šå°‘éï¼Œæ¯æ¬¡é‡è£…æ—¶éƒ½è¦é‡å¤è¿›è¡Œä¸€äº›æ“ä½œï¼Œè¿™æ¬¡å¹²è„†å°†è¿™äº›å¸¸ç”¨æ“ä½œè®°å½•ä¸‹æ¥ï¼Œä»¥ä¾¿ä¸‹æ¬¡é‡è£…æ—¶æŸ¥è¯¢ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;æ›´æ¢è½¯ä»¶æº&quot;&gt;&lt;a href=&quot;#æ›´æ¢è½¯ä»¶æº&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ¢è½¯ä»¶æº&quot;&gt;&lt;/
      
    
    </summary>
    
      <category term="è®°å½•" scheme="http://yoursite.com/categories/%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>seafileéƒ¨ç½²è®°å½•</title>
    <link href="http://yoursite.com/2017/11/04/2017-11-03-seafile/"/>
    <id>http://yoursite.com/2017/11/04/2017-11-03-seafile/</id>
    <published>2017-11-03T17:23:35.000Z</published>
    <updated>2020-05-10T07:04:54.901Z</updated>
    
    <content type="html"><![CDATA[<p>è¿‘æ—¥åœ¨ç½‘ä¸Šçœ‹åˆ°vpså¯ä»¥éƒ¨ç½²ç§æœ‰äº‘å­˜å‚¨ï¼Œæ­£å¥½æ‰‹å¤´ä¸Šçš„vpsé™¤äº†SSæ­æ¢¯å­æ²¡æœ‰åˆ«çš„ç”¨é€”ï¼Œé‚åœ¨ç½‘ä¸Šå¯»æ‰¾äº‘å­˜å‚¨æ­å»ºæ•™ç¨‹ã€‚æœ€åå†³å®šä½¿ç”¨<a href="&quot;https://www.xiaoz.me/archives/8480&quot;">xiaoz</a>çš„ä¸€é”®æ­å»ºè„šæœ¬ã€‚  </p><h3 id="ç¯å¢ƒè¦æ±‚"><a href="#ç¯å¢ƒè¦æ±‚" class="headerlink" title="ç¯å¢ƒè¦æ±‚"></a>ç¯å¢ƒè¦æ±‚</h3><ul><li>CenOS 7 64ä½  </li><li>Python &gt;= 2.7</li><li>SqLite 3  </li></ul><hr><h3 id="å¼€å§‹å®‰è£…"><a href="#å¼€å§‹å®‰è£…" class="headerlink" title="å¼€å§‹å®‰è£…"></a>å¼€å§‹å®‰è£…</h3><p>è¾“å…¥ä»¥ä¸‹å‘½ä»¤ä»¥è¿›è¡Œå®‰è£…  </p><pre><code class="bash">$ yum -y install wget  $ wget https://raw.githubusercontent.com/helloxz/seafile/<span class="variable">$master</span>/install_seafile.sh  $ chmod +x install_seafile.sh &amp;&amp; ./install_seafile.sh</code></pre><blockquote><p>å…¶ä¸­æœ€åä¸€æ¡å‘½ä»¤å¯ä»¥ç”¨äºå¸è½½ã€‚</p></blockquote><p>å®‰è£…è¿‡ç¨‹è·Ÿç€è„šæœ¬èµ°å°±å¯ä»¥ï¼Œæ³¨æ„å¡«å†™<em>serverâ€™s ip or domain</em>æ—¶ä¸è¦çå¡«ï¼Œå¡«è‡ªå·±vpsçš„å…¬ç½‘ipå³å¯ã€‚<br>å®‰è£…å®Œæˆåä½¿ç”¨<code>http://å…¬ç½‘ip:8000</code>è¿›è¡Œè®¿é—®ã€‚</p><hr><h3 id="ç»´æŠ¤ç›¸å…³"><a href="#ç»´æŠ¤ç›¸å…³" class="headerlink" title="ç»´æŠ¤ç›¸å…³"></a>ç»´æŠ¤ç›¸å…³</h3><p>å®˜æ–¹å¸®åŠ©æ–‡æ¡£ï¼š<a href="https://manual-cn.seafile.com/" target="_blank" rel="noopener">https://manual-cn.seafile.com/</a><br>å®¢æˆ·ç«¯ä¸‹è½½ï¼š<a href="https://www.seafile.com/download/" target="_blank" rel="noopener">https://www.seafile.com/download/</a>  </p><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç»´æŠ¤ï¼š</p><pre><code class="bash"><span class="comment">#å®‰è£…ç›®å½•  </span>/home/MyCloud  <span class="comment">#å¯åŠ¨æœåŠ¡  </span>/home/MyCloud/seafile-server/seafile.sh start  /home/MyCloud/seafile-server/seahub.sh start  <span class="comment">#åœæ­¢æœåŠ¡  </span>/home/MyCloud/seafile-server/seafile.sh stop  /home/MyCloud/seafile-server/seahub.sh stop  <span class="comment">#é‡ç½®ç®¡ç†å‘˜è´¦å·   </span>/home/MyCloud/seafile-server/reset-admin.sh</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;è¿‘æ—¥åœ¨ç½‘ä¸Šçœ‹åˆ°vpså¯ä»¥éƒ¨ç½²ç§æœ‰äº‘å­˜å‚¨ï¼Œæ­£å¥½æ‰‹å¤´ä¸Šçš„vpsé™¤äº†SSæ­æ¢¯å­æ²¡æœ‰åˆ«çš„ç”¨é€”ï¼Œé‚åœ¨ç½‘ä¸Šå¯»æ‰¾äº‘å­˜å‚¨æ­å»ºæ•™ç¨‹ã€‚æœ€åå†³å®šä½¿ç”¨&lt;a href=&quot;&amp;quot;https://www.xiaoz.me/archives/8480&amp;quot;&quot;&gt;xiaoz&lt;/a&gt;çš„ä¸€é”®æ­å»ºè„šæœ¬ã€‚
      
    
    </summary>
    
      <category term="ç¬”è®°" scheme="http://yoursite.com/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="è¿ç»´" scheme="http://yoursite.com/tags/%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://yoursite.com/2017/11/03/hello-world/"/>
    <id>http://yoursite.com/2017/11/03/hello-world/</id>
    <published>2017-11-03T12:00:00.000Z</published>
    <updated>2020-05-10T07:03:31.104Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¼€å‘æ„Ÿè¨€"><a href="#å¼€å‘æ„Ÿè¨€" class="headerlink" title="å¼€å‘æ„Ÿè¨€"></a>å¼€å‘æ„Ÿè¨€</h3><p>ç»ˆäºåœ¨æ‹–å»¶äº†è¿™ä¹ˆä¹…ä¹‹åï¼Œç”¨äº†ä¸¤ä¸ªæ™šä¸Šå’Œä¸€ä¸ªä¸‹åˆæŠŠè¿™ä¸ªåšå®¢æ­å»ºèµ·æ¥ã€‚  </p><p>å…¶å®ä¹‹å‰å¹¶æ²¡æœ‰å†™åšå®¢çš„ä¹ æƒ¯ï¼Œä½†ç»å¸¸æœ‰ä¸€äº›äº‹æƒ…ï¼Œè¿˜æ˜¯å¸Œæœ›è®°å½•ä¸‹æ¥ã€‚æœ‰æ—¶æœ‰äº›æƒ³æ³•è½¬ç¬å³é€ï¼Œä½†å´æ²¡æœ‰åŠæ—¶æŠ“ä½ï¼Œè¿‡å‡ æ—¥å°±å¿˜å¾—å·®ä¸å¤šäº†ï¼›æœ‰äº›è„šæœ¬ã€ä»£ç æˆ–è€…æ–¹æ³•ï¼Œä¸è®°å½•ä¸‹æ¥ï¼Œç­‰å†æ¬¡é‡åˆ°åˆè¦æ±‚åŠ©äºç™¾åº¦ï¼Œå®åœ¨æ˜¯éº»çƒ¦ï¼›ä¸€æœ¬ä¹¦çœ‹æ¯•ï¼Œæ— è®ºæ˜¯å°è¯´è¿˜æ˜¯æŠ€æœ¯ä¹¦ç±ï¼Œæ€»æœ‰äº›æ”¶è·ï¼Œä¹Ÿèƒ½å†™ä¸Šä¸€ä¸¤ç¯‡æ–‡ç« ã€‚  </p><p>æœ¬åšå®¢æ‰˜ç®¡äºgithubï¼Œå…¶å®åŸºæœ¬ä¸ä¼šæœ‰ä»€ä¹ˆäººæ¥è®¿é—®ï¼ˆ<em>å› ä¸ºæˆ‘githubå°±æ²¡æ€ä¹ˆç”¨è¿‡</em>ï¼‰ï¼Œä¸»è¦å°±æ˜¯è®°å½•ç»™è‡ªå·±çœ‹ï¼Œç›¸å½“äºä¸€ä¸ªäº‘ç¬”è®°äº†ã€‚<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">hexo</a>çš„ä¸»é¢˜è¿˜æ˜¯å¾ˆç»™åŠ›çš„ï¼Œéå¸¸ç¾è§‚ï¼Œè‡ªå®šä¹‰ç¨‹åº¦é«˜ï¼Œå¤šå°‘ä¹Ÿèƒ½æ¥è§¦ä¸€äº›å‰ç«¯æŠ€æœ¯ã€‚æ­£æ–‡ä½¿ç”¨<a href="http://wowubuntu.com/markdown/" target="_blank" rel="noopener">markdown</a>ç¼–å†™ï¼ŒçœåŠ›åˆæœ‰è¶£ï¼Œä½•ä¹è€Œä¸ä¸ºã€‚</p><p>æ€»ä¹‹ï¼Œç¬¬ä¸€ç¯‡åšå®¢æµ‹è¯•çš„æˆåˆ†å±…å¤šï¼Œå°±è¿™æ ·å§ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;å¼€å‘æ„Ÿè¨€&quot;&gt;&lt;a href=&quot;#å¼€å‘æ„Ÿè¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼€å‘æ„Ÿè¨€&quot;&gt;&lt;/a&gt;å¼€å‘æ„Ÿè¨€&lt;/h3&gt;&lt;p&gt;ç»ˆäºåœ¨æ‹–å»¶äº†è¿™ä¹ˆä¹…ä¹‹åï¼Œç”¨äº†ä¸¤ä¸ªæ™šä¸Šå’Œä¸€ä¸ªä¸‹åˆæŠŠè¿™ä¸ªåšå®¢æ­å»ºèµ·æ¥ã€‚  &lt;/p&gt;
&lt;p&gt;å…¶å®ä¹‹å‰å¹¶æ²¡æœ‰å†™åšå®¢çš„ä¹ æƒ¯ï¼Œä½†ç»å¸¸æœ‰ä¸€
      
    
    </summary>
    
      <category term="é—²èŠ" scheme="http://yoursite.com/categories/%E9%97%B2%E8%81%8A/"/>
    
    
      <category term="æƒ³æ³•" scheme="http://yoursite.com/tags/%E6%83%B3%E6%B3%95/"/>
    
  </entry>
  
</feed>
